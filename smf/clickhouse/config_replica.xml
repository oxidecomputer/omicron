<clickhouse>
    <!-- TODO: old settings, double check they are still what we want -->
    <logger>
        <level>trace</level>
        <console>true</console>
        <log>DATASTORE/clickhouse-server.log</log>
        <errorlog>DATASTORE/clickhouse-server.errlog</errorlog>
        <size>1000M</size>
        <count>3</count>
    </logger>
    <!-- Was oximeter_cluster node 1 (or 2, 3 etc)-->
    <display_name>REPLICA_DISPLAY_NAME</display_name>
    <!-- To allow all use :: -->
    <listen_host>LISTEN_ADDR</listen_host>
    <!-- Default is 8123 -->
    <http_port>LISTEN_PORT</http_port>
    <!-- TODO: Should this be dynamic as well? -->
    <tcp_port>9000</tcp_port>
 <!--   <mysql_port>9004</mysql_port> ???-->

    <!-- To trial locally use ./ -->
    <path>DATASTORE</path>

    <mlock_executable>true</mlock_executable>

    <!-- TODO: For now we will only be using a default user -->
    <users>
        <default>
            <password/>

            <networks>
                <ip>::/0</ip>
            </networks>

            <profile>default</profile>
            <quota>default</quota>
            <access_management>1</access_management>
        </default>
    </users>

    <profiles>
        <default/>
    </profiles>

    <quotas>
        <default/>
    </quotas>
<!-- End of old settings -->

    <!-- Port for communication between replicas. Used for data exchange.
         It provides low-level data access between servers.
         This port should not be accessible from untrusted networks.
         See also 'interserver_http_credentials'.
         Data transferred over connections to this port should not go through untrusted networks.
         See also 'interserver_https_port'.

         TODO: Should this port be dynamic as well?
      -->
    <interserver_http_port>9009</interserver_http_port>

    <!-- replication settings -->
    <macros>
        <shard>01</shard>
        <!-- Replica number (e.g. 01, 02 etc) -->
        <replica>REPLICA_NUMBER</replica>
        <cluster>oximeter_cluster</cluster>
    </macros>

    <remote_servers replace="true">
        <oximeter_cluster>
            <!-- TODO: secret handling TBD -->
            <secret>mysecretphrase</secret>
            <shard>
                <internal_replication>true</internal_replication>
                <replica>
                    <host>REPLICA_HOST_01</host>
                    <!-- TODO: Make replica ports dynamic? -->               
                    <port>9000</port>
                </replica>
                <replica>
                    <host>REPLICA_HOST_02</host>
                    <port>9000</port>
                </replica>
            </shard>
        </oximeter_cluster>
    </remote_servers>
    <zookeeper>
        <node>
            <host>KEEPER_HOST_01</host>
            <!-- TODO: Make keeper ports dynamic? -->
            <port>9181</port>
        </node>
        <node>
            <host>KEEPER_HOST_02</host>
            <port>9181</port>
        </node>
        <node>
            <host>KEEPER_HOST_03</host>
            <port>9181</port>
        </node>
    </zookeeper>

    <!-- The distributed_ddl settings will no longer be necessary in v23.X -->
    <distributed_ddl>
        <!-- Path in ZooKeeper to queue with DDL queries -->
        <path>/clickhouse/task_queue/ddl</path>

        <!-- Settings from this profile will be used to execute DDL queries -->
        <profile>default</profile>

        <!-- Controls how much ON CLUSTER queries can be run simultaneously. 
        <pool_size>1</pool_size> -->

        <!--
             Cleanup settings (active tasks will not be removed)
        -->

        <!-- Controls task TTL (default 1 week) -->
        <task_max_lifetime>604800</task_max_lifetime>

        <!-- Controls how often cleanup should be performed (in seconds) -->
        <cleanup_delay_period>60</cleanup_delay_period>

        <!-- Controls how many tasks could be in the queue -->
        <max_tasks_in_queue>1000</max_tasks_in_queue>
    </distributed_ddl>
</clickhouse>