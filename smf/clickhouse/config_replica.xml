<clickhouse>
    <logger replace="true">
        <level>trace</level>
        <console>true</console>
        <log>DATASTORE/clickhouse-server.log</log>
        <errorlog>DATASTORE/clickhouse-server.errlog</errorlog>
        <size>1000M</size>
        <count>3</count>
    </logger>
    <!-- Was oximeter_cluster node 1 (or 2, 3 etc)-->
    <display_name>REPLICA_DISPLAY_NAME</display_name>
    <!-- To allow all use :: -->
    <listen_host>LISTEN_ADDR</listen_host> 
    <!-- Default is 8123 -->
    <http_port replace="true">LISTEN_PORT</http_port>
    <!-- TODO: Should this be dynamic as well? -->
    <tcp_port replace="true">9000</tcp_port>

    <path replace="true">DATASTORE</path>
    <tmp_path replace="true">DATASTORE/tmp/</tmp_path>
    <user_files_path replace="true">DATASTORE/user_files/</user_files_path>

    <user_directories>
        <local_directory>
            <!-- Path to folder where users created by SQL commands are stored. -->
            <path replace="true">DATASTORE/access/</path>
        </local_directory>
    </user_directories>

    <format_schema_path replace="true">DATASTORE/format_schemas/</format_schema_path>

    <!-- replication settings -->
    <macros>
        <shard>01</shard>
        <!-- Replica number (e.g. 01, 02 etc) -->
        <replica>REPLICA_NUMBER</replica>
        <cluster>oximeter_cluster</cluster>
    </macros>

    <remote_servers replace="true">
        <oximeter_cluster>
            <!-- TODO: secret handling TBD -->
            <secret>mysecretphrase</secret>
            <shard>
                <internal_replication>true</internal_replication>
                <replica>
                    <host>REPLICA_HOST_01</host>
                    <!-- TODO: Make replica ports dynamic? -->               
                    <port>9000</port>
                </replica>
                <replica>
                    <host>REPLICA_HOST_02</host>
                    <port>9000</port>
                </replica>
            </shard>
        </oximeter_cluster>
    </remote_servers>
    <zookeeper>
        <node>
            <host>KEEPER_HOST_01</host>
            <!-- TODO: Make keeper ports dynamic? -->
            <port>9181</port>
        </node>
        <node>
            <host>KEEPER_HOST_02</host>
            <port>9181</port>
        </node>
        <node>
            <host>KEEPER_HOST_03</host>
            <port>9181</port>
        </node>
    </zookeeper>

    <distributed_ddl>
        <!-- Cleanup settings (active tasks will not be removed) -->

        <!-- Controls task TTL (default 1 week) -->
        <task_max_lifetime>604800</task_max_lifetime>

        <!-- Controls how often cleanup should be performed (in seconds) -->
        <cleanup_delay_period>60</cleanup_delay_period>

        <!-- Controls how many tasks could be in the queue -->
        <max_tasks_in_queue>1000</max_tasks_in_queue>
    </distributed_ddl>
</clickhouse>
