# RSS (Rack Setup Service) "stand-in" configuration.
#
# This file conforms to the schema for "RackInitializeRequest" in the Bootstrap
# Agent API.  See the `RackInitializeRequest` type in bootstrap-agent or its
# OpenAPI spec (in openapi/bootstrap-agent.json in the root of this workspace).

# The /56 subnet for the rack.
# Also implies the /48 AZ subnet.
#              |............|    <- This /48 is the AZ Subnet
#              |...............| <- This /56 is the Rack Subnet
rack_subnet = "fd00:1122:3344:0100::"

# Only include "our own sled" in the bootstrap network
bootstrap_discovery.type = "only_ours"

# The number of sleds required to unlock the rack secret.
#
# For values less than 2, no rack secret will be generated.
rack_secret_threshold = 1

ntp_servers = [ "ntp.eng.oxide.computer" ]
dns_servers = [ "1.1.1.1", "9.9.9.9" ]

# Delegated external DNS zone name
external_dns_zone_name = "oxide.test"

# Initial TLS certificates for the external API
#
# For the structure of these certificates, see `Certificate` in the Nexus
# internal API.  In practice, it can be unwieldy to put them here.  You can also
# specify a certificate by including the certificate chain and private key in
# PEM-format files called "initial-tls-cert.pem" and "initial-tls-key.pem",
# respectively, in the same place as this configuration file.
external_certificates = []

# The IP ranges configured as part of the services IP Pool.
# e.g., Nexus will be configured to use an address from this
# pool as its external IP.
[[internal_services_ip_pool_ranges]]
first = "192.168.1.20"
last = "192.168.1.22"

# Configuration for the initial Silo, user, and password.
[recovery_silo]
silo_name = "recovery"
user_name = "recovery"
# The following is a hash for the password "oxide".  This is (obviously) only
# intended for transient deployments in development with no sensitive data or
# resources.  You can change this value to any other supported hash.  The only
# thing that needs to be changed with this hash are the instructions given to
# individuals running this program who then want to log in as this user.  For
# more on what's supported, see the API docs for this type and the specific
# constraints in the omicron-passwords crate.
user_password_hash = "$argon2id$v=19$m=98304,t=13,p=1$RUlWc0ZxaHo0WFdrN0N6ZQ$S8p52j85GPvMhR/ek3GL0el/oProgTwWpHJZ8lsQQoY"

# TODO - this configuration is subject to change going forward. Ultimately these parameters
# should be provided to the control plane via wicket, but we need to put these parameters
# somewhere in the meantime so that the Nexus API will be reachable upon Rack startup.

# Configuration to bring up boundary services and make nexus reachable from the outside
[rack_network_config]
gateway_ip = "192.168.1.199"
infra_ip_first = "192.168.1.30"
infra_ip_last = "192.168.1.50"
switch = "switch0"
uplink_port = "qsfp0"
uplink_port_speed = "40G"
uplink_port_fec="none"
uplink_ip = "192.168.1.32"
