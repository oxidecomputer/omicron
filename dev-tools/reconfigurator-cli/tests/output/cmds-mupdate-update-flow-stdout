using provided RNG seed: reconfigurator-cli-test
> # Load an example system.

> load-example --nsleds 3 --ndisks-per-sled 1
loaded example system with:
- collection: f45ba181-4b56-42cc-a762-874d90184a43
- blueprint: dbcbd3d6-41ff-48ae-ac0b-1becc9b2fd21


> # Create a TUF repository from a fake manifest. We're going to use this
> # repository to test out the minimum release generation flow.
> tuf-assemble ../../update-common/manifests/fake.toml
INFO assembling repository in <ASSEMBLING_REPOSITORY_IN_REDACTED>
INFO artifacts assembled and archived to `repo-1.0.0.zip`, component: OmicronRepoAssembler
created repo-1.0.0.zip for system version 1.0.0

> set target-release repo-1.0.0.zip
INFO extracting uploaded archive to <EXTRACTING_UPLOADED_ARCHIVE_TO_REDACTED>
INFO created directory to store extracted artifacts, path: <CREATED_DIRECTORY_TO_STORE_EXTRACTED_ARTIFACTS_PATH_REDACTED>
INFO added artifact, name: fake-gimlet-sp, kind: gimlet_sp, version: 1.0.0, hash: 68465b8e3f808f475510b525cfd62086d37ddd57688bd854184fdafb2b2198a4, length: 732
INFO added artifact, name: fake-rot, kind: gimlet_rot_image_a, version: 1.0.0, hash: d11e65f934bf0de51df2e5b484f61ee72072417b43ac87f33e958008428e7b02, length: 783
INFO added artifact, name: fake-rot, kind: gimlet_rot_image_b, version: 1.0.0, hash: d11e65f934bf0de51df2e5b484f61ee72072417b43ac87f33e958008428e7b02, length: 783
INFO added artifact, name: fake-rot-bootloader, kind: gimlet_rot_bootloader, version: 1.0.0, hash: 5b0f601b1fbb8674db9c751a02f8b14f8e6d4e8470f4f7b686fecb2c49ec11f9, length: 797
INFO added artifact, name: fake-host, kind: gimlet_host_phase_1, version: 1.0.0, hash: b99d5273ba1418bebb19d74b701d716896409566d41de76ada71bded4c9b166b, length: 524288
INFO added artifact, name: fake-host, kind: cosmo_host_phase_1, version: 1.0.0, hash: 9525f567106549a3fc32df870a74803d77e51dcc44190b218e227a2c5d444f58, length: 524288
INFO added artifact, name: fake-host, kind: host_phase_2, version: 1.0.0, hash: d944ae205b61ccf4322448f7d0311a819c53d9844769de066c5307c1682abb47, length: 1048576
INFO added artifact, name: fake-trampoline, kind: gimlet_trampoline_phase_1, version: 1.0.0, hash: bcb27520ee5a56e19f6df9662c66d69ac681fbd873a97547be5f6a5ae3d250c4, length: 524288
INFO added artifact, name: fake-trampoline, kind: cosmo_trampoline_phase_1, version: 1.0.0, hash: e235b8afb58ee69d966853bd5efe7c7e904da84b9035a332b3e691dc1d5cdbd0, length: 524288
INFO added artifact, name: fake-trampoline, kind: trampoline_phase_2, version: 1.0.0, hash: a5dfcc4bc69b791f1c509df499e9e72cce844cb2b53a56d8bb357b264bdf13b6, length: 1048576
INFO added artifact, name: clickhouse, kind: zone, version: 1.0.0, hash: 52b1eb4daff6f9140491d547b11248392920230db3db0eef5f5fa5333fe9e659, length: 1686
INFO added artifact, name: clickhouse_keeper, kind: zone, version: 1.0.0, hash: cda702919449d86663be97295043aeca0ead69ae5db3bbdb20053972254a27a3, length: 1690
INFO added artifact, name: clickhouse_server, kind: zone, version: 1.0.0, hash: 5f9ae6a9821bbe8ff0bf60feddf8b167902fe5f3e2c98bd21edd1ec9d969a001, length: 1690
INFO added artifact, name: cockroachdb, kind: zone, version: 1.0.0, hash: f3a1a3c0b3469367b005ee78665d982059d5e14e93a479412426bf941c4ed291, length: 1689
INFO added artifact, name: crucible-zone, kind: zone, version: 1.0.0, hash: 6f17cf65fb5a5bec5542dd07c03cd0acc01e59130f02c532c8d848ecae810047, length: 1690
INFO added artifact, name: crucible-pantry-zone, kind: zone, version: 1.0.0, hash: 21f0ada306859c23917361f2e0b9235806c32607ec689c7e8cf16bb898bc5a02, length: 1695
INFO added artifact, name: external-dns, kind: zone, version: 1.0.0, hash: ccca13ed19b8731f9adaf0d6203b02ea3b9ede4fa426b9fac0a07ce95440046d, length: 1689
INFO added artifact, name: internal-dns, kind: zone, version: 1.0.0, hash: ffbf1373f7ee08dddd74c53ed2a94e7c4c572a982d3a9bc94000c6956b700c6a, length: 1689
INFO added artifact, name: ntp, kind: zone, version: 1.0.0, hash: 67593d686ed04a1709f93972b71f4ebc148a9362120f65d239943e814a9a7439, length: 1681
INFO added artifact, name: nexus, kind: zone, version: 1.0.0, hash: 0e32b4a3e5d3668bb1d6a16fb06b74dc60b973fa479dcee0aae3adbb52bf1388, length: 1682
INFO added artifact, name: oximeter, kind: zone, version: 1.0.0, hash: 048d8fe8cdef5b175aad714d0f148aa80ce36c9114ac15ce9d02ed3d37877a77, length: 1682
INFO added artifact, name: fake-psc-sp, kind: psc_sp, version: 1.0.0, hash: 89245fe2ac7e6a2ac8dfa4e7d6891a6e6df95e4141395c07c64026778f6d76d7, length: 721
INFO added artifact, name: fake-psc-rot, kind: psc_rot_image_a, version: 1.0.0, hash: 5d8ea834dd6d42d386f1eb8a2c5f6e99b697c9958bb4ab8edf63e56003e25d8d, length: 775
INFO added artifact, name: fake-psc-rot, kind: psc_rot_image_b, version: 1.0.0, hash: 5d8ea834dd6d42d386f1eb8a2c5f6e99b697c9958bb4ab8edf63e56003e25d8d, length: 775
INFO added artifact, name: fake-psc-rot-bootloader, kind: psc_rot_bootloader, version: 1.0.0, hash: 18c9c774bfe4bb086e869509dcccacee8476fd87670692b765aee216f2c7f003, length: 805
INFO added artifact, name: fake-switch-sp, kind: switch_sp, version: 1.0.0, hash: bf1bc1da5059f76182c3007c3049941f8898abede2f3765b106c6e7f7c42d44c, length: 740
INFO added artifact, name: fake-switch-rot, kind: switch_rot_image_a, version: 1.0.0, hash: 32307d6d75c9707e8499ba4a4d379f99c0358237b6e190ff6a8024b470f62342, length: 774
INFO added artifact, name: fake-switch-rot, kind: switch_rot_image_b, version: 1.0.0, hash: 32307d6d75c9707e8499ba4a4d379f99c0358237b6e190ff6a8024b470f62342, length: 774
INFO added artifact, name: fake-switch-rot-bootloader, kind: switch_rot_bootloader, version: 1.0.0, hash: 70836d170abd5621f95bb4225987b27b3d3dd6168e73cd60e44309bdfeb94e98, length: 804
INFO added artifact, name: installinator_document, kind: installinator_document, version: 1.0.0, hash: a6a636b5d57813578766b3f1c2559abf9af5d8c86187538167937c476beeefa3, length: 367
set target release based on repo-1.0.0.zip


> # Update the install dataset on this sled to the target release.
> # (This populates the zone manifest, used for no-op conversions from
> # install dataset to artifact down the road.)
> sled-update-install-dataset serial0 --to-target-release
sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6: install dataset updated: to target release (system version 1.0.0)


> # Set one of sled 0's zone's image sources to a specific artifact, and
> # also set MGS and host phase 2 updates on the sled. Both should be
> # reset as part of this process.
> blueprint-edit latest set-zone-image 0c71b3b2-6ceb-4e8f-b020-b08675e83038 artifact 1.2.3 e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
blueprint 8da82a8e-bf97-4fbd-8ddd-9f6462732cf1 created from latest blueprint (dbcbd3d6-41ff-48ae-ac0b-1becc9b2fd21): set sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 zone 0c71b3b2-6ceb-4e8f-b020-b08675e83038 image source to artifact: version 1.2.3
warn: no validation is done on the requested image source

> blueprint-edit latest set-sp-update serial0 e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 1.1.0 sp 1.0.0 1.0.1
blueprint 58d5e830-0884-47d8-a7cd-b2b3751adeb4 created from latest blueprint (8da82a8e-bf97-4fbd-8ddd-9f6462732cf1): configured update for serial serial0
warn: no validation is done on the requested artifact hash or version

> blueprint-edit latest set-host-phase2 serial0 A artifact 1.0.0 3a9607047b03ccaab6d222249d890e93ca51b94ad631c7ca38be74cba60802ff
blueprint af934083-59b5-4bf6-8966-6fb5292c29e1 created from latest blueprint (58d5e830-0884-47d8-a7cd-b2b3751adeb4): set sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 host phase 2 slot A source to artifact: version 1.0.0
warn: no validation is done on the requested source

> blueprint-edit latest set-host-phase2 serial0 B artifact 1.0.0 044d45ad681b44e89c10e056cabdedf19fd8b1e54bc95e6622bcdd23f16bc8f2
blueprint df06bb57-ad42-4431-9206-abff322896c7 created from latest blueprint (af934083-59b5-4bf6-8966-6fb5292c29e1): set sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 host phase 2 slot B source to artifact: version 1.0.0
warn: no validation is done on the requested source


> # Simulate a mupdate on sled 0 by setting the mupdate override field to a
> # new UUID (generated using uuidgen).
> sled-set serial0 mupdate-override 6123eac1-ec5b-42ba-b73f-9845105a9971
set sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 mupdate override: unset -> 6123eac1-ec5b-42ba-b73f-9845105a9971


> # On sled 1, simulate an error obtaining the mupdate override.
> sled-set serial1 mupdate-override --with-error
set sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c mupdate override: unset -> error


> # Also set SP and host phase 2 updates on this sled. They will be cleared
> # because of the error (which reflects the reality that Sled Agent is not
> # going to proceed with updates until the situation is resolved).
> blueprint-edit latest set-sp-update serial1 e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 newest sp newer older
blueprint 7f976e0d-d2a5-4eeb-9e82-c82bc2824aba created from latest blueprint (df06bb57-ad42-4431-9206-abff322896c7): configured update for serial serial1
warn: no validation is done on the requested artifact hash or version

> blueprint-edit latest set-host-phase2 serial1 A artifact 1.0.0 3a9607047b03ccaab6d222249d890e93ca51b94ad631c7ca38be74cba60802ff
blueprint 9034c710-3e57-45f3-99e5-4316145e87ac created from latest blueprint (7f976e0d-d2a5-4eeb-9e82-c82bc2824aba): set sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c host phase 2 slot A source to artifact: version 1.0.0
warn: no validation is done on the requested source

> blueprint-edit latest set-host-phase2 serial1 B artifact 1.0.0 044d45ad681b44e89c10e056cabdedf19fd8b1e54bc95e6622bcdd23f16bc8f2
blueprint d60afc57-f15d-476c-bd0f-b1071e2bb976 created from latest blueprint (9034c710-3e57-45f3-99e5-4316145e87ac): set sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c host phase 2 slot B source to artifact: version 1.0.0
warn: no validation is done on the requested source


> # Simulate a mupdate on sled 2 as well.
> sled-set serial2 mupdate-override 203fa72c-85c1-466a-8ed3-338ee029530d
set sled d81c6a84-79b8-4958-ae41-ea46c9b19763 mupdate override: unset -> 203fa72c-85c1-466a-8ed3-338ee029530d


> # Generate a new inventory and plan against that.
> inventory-generate
generated inventory collection eb0796d5-ab8a-4f7b-a884-b4aeacb8ab51 from configured sleds

> inventory-show latest
collection: eb0796d5-ab8a-4f7b-a884-b4aeacb8ab51
collector:  example
started:    <REDACTED_TIMESTAMP>
done:       <REDACTED_TIMESTAMP>
errors:     0

SLED AGENTS

sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c (role = Gimlet, serial serial1)
    found at:    <REDACTED_TIMESTAMP> from fake sled agent
    address:     [fd00:1122:3344:102::1]:12345
    usable hw threads:   10
    CPU family:          amd_milan
    usable memory (GiB): 0
    reservoir (GiB):     0
    physical disks:
      U2: DiskIdentity { vendor: "fake-vendor", model: "fake-model", serial: "serial-72c59873-31ff-4e36-8d76-ff834009349a" } in 0
    zpools
      72c59873-31ff-4e36-8d76-ff834009349a: total size: 100 GiB
    datasets:
      oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_internal_dns_99e2f30b-3174-40bf-a78a-90da8abba8ca - id: 09b9cc9b-3426-470b-a7bc-538f82dede03, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_crucible_bd354eef-d8a6-4165-9124-283fb5e46d77 - id: 2ad1875a-92ac-472f-8c26-593309f0e4da, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_ntp_62620961-fc4a-481e-968b-f5acbac0dc63 - id: 2db6b7c1-0f46-4ced-a3ad-48872793360e, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_clickhouse_353b3b65-20f7-48c3-88f7-495bd5d31545 - id: 318fae85-abcb-4259-b1b6-ac96d193f7b7, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/internal_dns - id: 3560dd69-3b23-4c69-807d-d673104cfc68, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/clickhouse - id: 3b66453b-7148-4c1b-84a9-499e43290ab4, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone - id: 4829f422-aa31-41a8-ab73-95684ff1ef48, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_nexus_466a9f29-62bf-4e63-924a-b9efdb86afec - id: 775f9207-c42d-4af2-9186-27ffef67735e, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/external_dns - id: 841d5648-05f0-47b0-b446-92f6b60fe9a6, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_72c59873-31ff-4e36-8d76-ff834009349a/crucible - id: 8c4fa711-1d5d-4e93-85f0-d17bff47b063, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/debug - id: 93957ca0-9ed1-4e7b-8c34-2ce07a69541c, compression: gzip-9
        available: 1 GiB, used: 0 B
        reservation: None, quota: Some(ByteCount(107374182400))
      oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_external_dns_6c3ae381-04f7-41ea-b0ac-74db387dbc3a - id: b46de15d-33e7-4cd0-aa7c-e7be2a61e71b, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_crucible_pantry_ad6a3a03-8d0f-4504-99a4-cbf73d69b973 - id: c31623de-c19b-4615-9f1d-5e1daa5d3bda, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None

LEDGERED SLED CONFIG
    generation: 2
    remove_mupdate_override: None
    desired host phase 2 slot a: keep current contents
    desired host phase 2 slot b: keep current contents
    DISKS: 1
        ID                                       ZPOOL_ID                                 VENDOR          MODEL          SERIAL                                      
        f26df0e3-46bb-4c85-8146-efcab46179da     72c59873-31ff-4e36-8d76-ff834009349a     fake-vendor     fake-model     serial-72c59873-31ff-4e36-8d76-ff834009349a 
    DATASETS: 13
        ID                                       NAME                                                                                                             COMPRESSION     QUOTA       RESERVATION 
        09b9cc9b-3426-470b-a7bc-538f82dede03     oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_internal_dns_99e2f30b-3174-40bf-a78a-90da8abba8ca        off             none        none        
        2ad1875a-92ac-472f-8c26-593309f0e4da     oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_crucible_bd354eef-d8a6-4165-9124-283fb5e46d77            off             none        none        
        2db6b7c1-0f46-4ced-a3ad-48872793360e     oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_ntp_62620961-fc4a-481e-968b-f5acbac0dc63                 off             none        none        
        318fae85-abcb-4259-b1b6-ac96d193f7b7     oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_clickhouse_353b3b65-20f7-48c3-88f7-495bd5d31545          off             none        none        
        3560dd69-3b23-4c69-807d-d673104cfc68     oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/internal_dns                                                      off             none        none        
        3b66453b-7148-4c1b-84a9-499e43290ab4     oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/clickhouse                                                        off             none        none        
        4829f422-aa31-41a8-ab73-95684ff1ef48     oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone                                                              off             none        none        
        775f9207-c42d-4af2-9186-27ffef67735e     oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_nexus_466a9f29-62bf-4e63-924a-b9efdb86afec               off             none        none        
        841d5648-05f0-47b0-b446-92f6b60fe9a6     oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/external_dns                                                      off             none        none        
        8c4fa711-1d5d-4e93-85f0-d17bff47b063     oxp_72c59873-31ff-4e36-8d76-ff834009349a/crucible                                                                off             none        none        
        93957ca0-9ed1-4e7b-8c34-2ce07a69541c     oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/debug                                                             gzip-9          100 GiB     none        
        b46de15d-33e7-4cd0-aa7c-e7be2a61e71b     oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_external_dns_6c3ae381-04f7-41ea-b0ac-74db387dbc3a        off             none        none        
        c31623de-c19b-4615-9f1d-5e1daa5d3bda     oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_crucible_pantry_ad6a3a03-8d0f-4504-99a4-cbf73d69b973     off             none        none        
    ZONES: 7
        ID                                       KIND                IMAGE_SOURCE    
        353b3b65-20f7-48c3-88f7-495bd5d31545     clickhouse          install-dataset 
        466a9f29-62bf-4e63-924a-b9efdb86afec     nexus               install-dataset 
        62620961-fc4a-481e-968b-f5acbac0dc63     internal_ntp        install-dataset 
        6c3ae381-04f7-41ea-b0ac-74db387dbc3a     external_dns        install-dataset 
        99e2f30b-3174-40bf-a78a-90da8abba8ca     internal_dns        install-dataset 
        ad6a3a03-8d0f-4504-99a4-cbf73d69b973     crucible_pantry     install-dataset 
        bd354eef-d8a6-4165-9124-283fb5e46d77     crucible            install-dataset 
    zone image resolver status:
        zone manifest:
            path on boot disk: /fake/path/install/zones.json
            boot disk inventory:
                manifest generated by installinator (mupdate ID: 00000000-0000-0000-0000-000000000000)
                no artifacts in install dataset (this should only be seen in simulated systems)
            no non-boot disks
        mupdate override:
            path on boot disk: /fake/path/install/mupdate_override.json
            error obtaining override on boot disk: reconfigurator-cli simulated mupdate-override error
            no non-boot disks
    boot disk slot: A
    slot A details:
        artifact: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a (1000 bytes)
        image name: fake from debug_assume_success()
        phase 2 hash: 0000000000000000000000000000000000000000000000000000000000000000
    slot B details:
        artifact: 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b (1000 bytes)
        image name: fake from debug_assume_success()
        phase 2 hash: 0101010101010101010101010101010101010101010101010101010101010101
    last reconciled config: matches ledgered config
        error reading mupdate override, so sled agent didn't attempt to clear it
        no orphaned datasets
        all disks reconciled successfully
        all datasets reconciled successfully
        all zones reconciled successfully
    reconciler task status: idle (finished at <REDACTED_TIMESTAMP> after running for <REDACTED_DURATION>s)

sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 (role = Gimlet, serial serial0)
    found at:    <REDACTED_TIMESTAMP> from fake sled agent
    address:     [fd00:1122:3344:101::1]:12345
    usable hw threads:   10
    CPU family:          amd_milan
    usable memory (GiB): 0
    reservoir (GiB):     0
    physical disks:
      U2: DiskIdentity { vendor: "fake-vendor", model: "fake-model", serial: "serial-c6d33b64-fb96-4129-bab1-7878a06a5f9b" } in 0
    zpools
      c6d33b64-fb96-4129-bab1-7878a06a5f9b: total size: 100 GiB
    datasets:
      oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_crucible_pantry_ba4994a8-23f9-4b1a-a84f-a08d74591389 - id: 1bca7f71-5e42-4749-91ec-fa40793a3a9a, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/debug - id: 248c6c10-1ac6-45de-bb55-ede36ca56bbd, compression: gzip-9
        available: 1 GiB, used: 0 B
        reservation: None, quota: Some(ByteCount(107374182400))
      oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_external_dns_803bfb63-c246-41db-b0da-d3b87ddfc63d - id: 3ac089c9-9dec-465b-863a-188e80d71fb4, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crucible - id: 43931274-7fe8-4077-825d-dff2bc8efa58, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone - id: 4617d206-4330-4dfa-b9f3-f63a3db834f9, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/internal_dns - id: 4f60b534-eaa3-40a1-b60f-bfdf147af478, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_internal_dns_427ec88f-f467-42fa-9bbb-66a91a36103c - id: 686c19cf-a0d7-45f6-866f-c564612b2664, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_nexus_0c71b3b2-6ceb-4e8f-b020-b08675e83038 - id: 793ac181-1b01-403c-850d-7f5c54bda6c9, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/external_dns - id: a4c3032e-21fa-4d4a-b040-a7e3c572cf3c, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_crucible_5199c033-4cf9-4ab6-8ae7-566bd7606363 - id: ad41be71-6c15-4428-b510-20ceacde4fa6, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_ntp_6444f8a5-6465-4f0b-a549-1993c113569c - id: cdf3684f-a6cf-4449-b9ec-e696b2c663e2, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None

LEDGERED SLED CONFIG
    generation: 2
    remove_mupdate_override: None
    desired host phase 2 slot a: keep current contents
    desired host phase 2 slot b: keep current contents
    DISKS: 1
        ID                                       ZPOOL_ID                                 VENDOR          MODEL          SERIAL                                      
        3f399219-7701-414c-9f07-8e97f688765c     c6d33b64-fb96-4129-bab1-7878a06a5f9b     fake-vendor     fake-model     serial-c6d33b64-fb96-4129-bab1-7878a06a5f9b 
    DATASETS: 11
        ID                                       NAME                                                                                                             COMPRESSION     QUOTA       RESERVATION 
        1bca7f71-5e42-4749-91ec-fa40793a3a9a     oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_crucible_pantry_ba4994a8-23f9-4b1a-a84f-a08d74591389     off             none        none        
        248c6c10-1ac6-45de-bb55-ede36ca56bbd     oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/debug                                                             gzip-9          100 GiB     none        
        3ac089c9-9dec-465b-863a-188e80d71fb4     oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_external_dns_803bfb63-c246-41db-b0da-d3b87ddfc63d        off             none        none        
        43931274-7fe8-4077-825d-dff2bc8efa58     oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crucible                                                                off             none        none        
        4617d206-4330-4dfa-b9f3-f63a3db834f9     oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone                                                              off             none        none        
        4f60b534-eaa3-40a1-b60f-bfdf147af478     oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/internal_dns                                                      off             none        none        
        686c19cf-a0d7-45f6-866f-c564612b2664     oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_internal_dns_427ec88f-f467-42fa-9bbb-66a91a36103c        off             none        none        
        793ac181-1b01-403c-850d-7f5c54bda6c9     oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_nexus_0c71b3b2-6ceb-4e8f-b020-b08675e83038               off             none        none        
        a4c3032e-21fa-4d4a-b040-a7e3c572cf3c     oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/external_dns                                                      off             none        none        
        ad41be71-6c15-4428-b510-20ceacde4fa6     oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_crucible_5199c033-4cf9-4ab6-8ae7-566bd7606363            off             none        none        
        cdf3684f-a6cf-4449-b9ec-e696b2c663e2     oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_ntp_6444f8a5-6465-4f0b-a549-1993c113569c                 off             none        none        
    ZONES: 6
        ID                                       KIND                IMAGE_SOURCE    
        0c71b3b2-6ceb-4e8f-b020-b08675e83038     nexus               install-dataset 
        427ec88f-f467-42fa-9bbb-66a91a36103c     internal_dns        install-dataset 
        5199c033-4cf9-4ab6-8ae7-566bd7606363     crucible            install-dataset 
        6444f8a5-6465-4f0b-a549-1993c113569c     internal_ntp        install-dataset 
        803bfb63-c246-41db-b0da-d3b87ddfc63d     external_dns        install-dataset 
        ba4994a8-23f9-4b1a-a84f-a08d74591389     crucible_pantry     install-dataset 
    zone image resolver status:
        zone manifest:
            path on boot disk: /fake/path/install/zones.json
            boot disk inventory:
                manifest generated by sled-agent
                artifacts in install dataset:
                  - clickhouse.tar.gz (expected 1686 bytes with hash 52b1eb4daff6f9140491d547b11248392920230db3db0eef5f5fa5333fe9e659): ok
                  - clickhouse_keeper.tar.gz (expected 1690 bytes with hash cda702919449d86663be97295043aeca0ead69ae5db3bbdb20053972254a27a3): ok
                  - clickhouse_server.tar.gz (expected 1690 bytes with hash 5f9ae6a9821bbe8ff0bf60feddf8b167902fe5f3e2c98bd21edd1ec9d969a001): ok
                  - cockroachdb.tar.gz (expected 1689 bytes with hash f3a1a3c0b3469367b005ee78665d982059d5e14e93a479412426bf941c4ed291): ok
                  - crucible.tar.gz (expected 1690 bytes with hash 6f17cf65fb5a5bec5542dd07c03cd0acc01e59130f02c532c8d848ecae810047): ok
                  - crucible_pantry.tar.gz (expected 1695 bytes with hash 21f0ada306859c23917361f2e0b9235806c32607ec689c7e8cf16bb898bc5a02): ok
                  - external_dns.tar.gz (expected 1689 bytes with hash ccca13ed19b8731f9adaf0d6203b02ea3b9ede4fa426b9fac0a07ce95440046d): ok
                  - internal_dns.tar.gz (expected 1689 bytes with hash ffbf1373f7ee08dddd74c53ed2a94e7c4c572a982d3a9bc94000c6956b700c6a): ok
                  - nexus.tar.gz (expected 1682 bytes with hash 0e32b4a3e5d3668bb1d6a16fb06b74dc60b973fa479dcee0aae3adbb52bf1388): ok
                  - ntp.tar.gz (expected 1681 bytes with hash 67593d686ed04a1709f93972b71f4ebc148a9362120f65d239943e814a9a7439): ok
                  - oximeter.tar.gz (expected 1682 bytes with hash 048d8fe8cdef5b175aad714d0f148aa80ce36c9114ac15ce9d02ed3d37877a77): ok
            no non-boot disks
        mupdate override:
            path on boot disk: /fake/path/install/mupdate_override.json
            override on boot disk: 6123eac1-ec5b-42ba-b73f-9845105a9971
            no non-boot disks
    boot disk slot: A
    slot A details:
        artifact: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a (1000 bytes)
        image name: fake from debug_assume_success()
        phase 2 hash: 0000000000000000000000000000000000000000000000000000000000000000
    slot B details:
        artifact: 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b (1000 bytes)
        image name: fake from debug_assume_success()
        phase 2 hash: 0101010101010101010101010101010101010101010101010101010101010101
    last reconciled config: matches ledgered config
        mupdate override present, but sled agent was not instructed to clear it
        no orphaned datasets
        all disks reconciled successfully
        all datasets reconciled successfully
        all zones reconciled successfully
    reconciler task status: idle (finished at <REDACTED_TIMESTAMP> after running for <REDACTED_DURATION>s)

sled d81c6a84-79b8-4958-ae41-ea46c9b19763 (role = Gimlet, serial serial2)
    found at:    <REDACTED_TIMESTAMP> from fake sled agent
    address:     [fd00:1122:3344:103::1]:12345
    usable hw threads:   10
    CPU family:          amd_milan
    usable memory (GiB): 0
    reservoir (GiB):     0
    physical disks:
      U2: DiskIdentity { vendor: "fake-vendor", model: "fake-model", serial: "serial-4930954e-9ac7-4453-b63f-5ab97c389a99" } in 0
    zpools
      4930954e-9ac7-4453-b63f-5ab97c389a99: total size: 100 GiB
    datasets:
      oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crucible - id: 090bd88d-0a43-4040-a832-b13ae721f74f, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_f55647d4-5500-4ad3-893a-df45bd50d622 - id: 1cb0a47a-59ac-4892-8e92-cf87b4290f96, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_internal_dns_ea5b4030-b52f-44b2-8d70-45f15f987d01 - id: 21fd4f3a-ec31-469b-87b1-087c343a2422, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/internal_dns - id: 252ac39f-b9e2-4697-8c07-3a833115d704, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_ntp_f10a4fb9-759f-4a65-b25e-5794ad2d07d8 - id: 41071985-1dfd-4ce5-8bc2-897161a8bce4, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone - id: 45cd9687-20be-4247-b62a-dfdacf324929, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/external_dns - id: 4da74a5b-6911-4cca-b624-b90c65530117, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/debug - id: 7a6a2058-ea78-49de-9730-cce5e28b4cfb, compression: gzip-9
        available: 1 GiB, used: 0 B
        reservation: None, quota: Some(ByteCount(107374182400))
      oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_pantry_75b220ba-a0f4-4872-8202-dc7c87f062d0 - id: b1deff4b-51df-4a37-9043-afbd7c70a1cb, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_external_dns_f6ec9c67-946a-4da3-98d5-581f72ce8bf0 - id: c65a9c1c-36dc-4ddb-8aac-ec3be8dbb209, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None
      oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_nexus_3eeb8d49-eb1a-43f8-bb64-c2338421c2c6 - id: e009d8b8-4695-4322-b53f-f03f2744aef7, compression: off
        available: 1 GiB, used: 0 B
        reservation: None, quota: None

LEDGERED SLED CONFIG
    generation: 2
    remove_mupdate_override: None
    desired host phase 2 slot a: keep current contents
    desired host phase 2 slot b: keep current contents
    DISKS: 1
        ID                                       ZPOOL_ID                                 VENDOR          MODEL          SERIAL                                      
        08724339-3d5b-432c-b7f3-55efdcf9f098     4930954e-9ac7-4453-b63f-5ab97c389a99     fake-vendor     fake-model     serial-4930954e-9ac7-4453-b63f-5ab97c389a99 
    DATASETS: 11
        ID                                       NAME                                                                                                             COMPRESSION     QUOTA       RESERVATION 
        090bd88d-0a43-4040-a832-b13ae721f74f     oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crucible                                                                off             none        none        
        1cb0a47a-59ac-4892-8e92-cf87b4290f96     oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_f55647d4-5500-4ad3-893a-df45bd50d622            off             none        none        
        21fd4f3a-ec31-469b-87b1-087c343a2422     oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_internal_dns_ea5b4030-b52f-44b2-8d70-45f15f987d01        off             none        none        
        252ac39f-b9e2-4697-8c07-3a833115d704     oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/internal_dns                                                      off             none        none        
        41071985-1dfd-4ce5-8bc2-897161a8bce4     oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_ntp_f10a4fb9-759f-4a65-b25e-5794ad2d07d8                 off             none        none        
        45cd9687-20be-4247-b62a-dfdacf324929     oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone                                                              off             none        none        
        4da74a5b-6911-4cca-b624-b90c65530117     oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/external_dns                                                      off             none        none        
        7a6a2058-ea78-49de-9730-cce5e28b4cfb     oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/debug                                                             gzip-9          100 GiB     none        
        b1deff4b-51df-4a37-9043-afbd7c70a1cb     oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_pantry_75b220ba-a0f4-4872-8202-dc7c87f062d0     off             none        none        
        c65a9c1c-36dc-4ddb-8aac-ec3be8dbb209     oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_external_dns_f6ec9c67-946a-4da3-98d5-581f72ce8bf0        off             none        none        
        e009d8b8-4695-4322-b53f-f03f2744aef7     oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_nexus_3eeb8d49-eb1a-43f8-bb64-c2338421c2c6               off             none        none        
    ZONES: 6
        ID                                       KIND                IMAGE_SOURCE    
        3eeb8d49-eb1a-43f8-bb64-c2338421c2c6     nexus               install-dataset 
        75b220ba-a0f4-4872-8202-dc7c87f062d0     crucible_pantry     install-dataset 
        ea5b4030-b52f-44b2-8d70-45f15f987d01     internal_dns        install-dataset 
        f10a4fb9-759f-4a65-b25e-5794ad2d07d8     internal_ntp        install-dataset 
        f55647d4-5500-4ad3-893a-df45bd50d622     crucible            install-dataset 
        f6ec9c67-946a-4da3-98d5-581f72ce8bf0     external_dns        install-dataset 
    zone image resolver status:
        zone manifest:
            path on boot disk: /fake/path/install/zones.json
            boot disk inventory:
                manifest generated by installinator (mupdate ID: 00000000-0000-0000-0000-000000000000)
                no artifacts in install dataset (this should only be seen in simulated systems)
            no non-boot disks
        mupdate override:
            path on boot disk: /fake/path/install/mupdate_override.json
            override on boot disk: 203fa72c-85c1-466a-8ed3-338ee029530d
            no non-boot disks
    boot disk slot: A
    slot A details:
        artifact: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a (1000 bytes)
        image name: fake from debug_assume_success()
        phase 2 hash: 0000000000000000000000000000000000000000000000000000000000000000
    slot B details:
        artifact: 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b (1000 bytes)
        image name: fake from debug_assume_success()
        phase 2 hash: 0101010101010101010101010101010101010101010101010101010101010101
    last reconciled config: matches ledgered config
        mupdate override present, but sled agent was not instructed to clear it
        no orphaned datasets
        all disks reconciled successfully
        all datasets reconciled successfully
        all zones reconciled successfully
    reconciler task status: idle (finished at <REDACTED_TIMESTAMP> after running for <REDACTED_DURATION>s)

KEEPER MEMBERSHIP
    no membership retrieved


COCKROACH STATUS
    no cockroach status retrieved


NTP STATUS
    No NTP zones reported timesync information

INTERNAL DNS STATUS
    Zone 427ec88f-f467-42fa-9bbb-66a91a36103c: Internal DNS generation @ 1
    Zone 99e2f30b-3174-40bf-a78a-90da8abba8ca: Internal DNS generation @ 1
    Zone ea5b4030-b52f-44b2-8d70-45f15f987d01: Internal DNS generation @ 1


> blueprint-plan latest latest
ERRO error getting mupdate override info for sled, not altering blueprint override, but cleared pending host phase 2 updates if any, phase: do_plan_mupdate_override, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, message: reconfigurator-cli simulated mupdate-override error, bp_override: None, prev_host_phase_2: 
  - host phase 2 slot A: updated from artifact (version version 1.0.0, hash 3a9607047b03ccaab6d222249d890e93ca51b94ad631c7ca38be74cba60802ff) to preserving current contents
  - host phase 2 slot B: updated from artifact (version version 1.0.0, hash 044d45ad681b44e89c10e056cabdedf19fd8b1e54bc95e6622bcdd23f16bc8f2) to preserving current contents

INFO previous MGS update cleared because there was an error obtaining mupdate override info, phase: do_plan_mupdate_override, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, artifact_version: newest, artifact_hash: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855, expected_inactive_version: Version(ArtifactVersion("older")), expected_active_version: newer, component: sp, sp_slot: 1, sp_type: Sled, serial_number: serial1, part_number: model1
INFO blueprint mupdate override updated to match inventory, phase: do_plan_mupdate_override, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, new_bp_override: 6123eac1-ec5b-42ba-b73f-9845105a9971, prev_bp_override: None, zones: 
  - zone 0c71b3b2-6ceb-4e8f-b020-b08675e83038 (Nexus) updated from artifact: version 1.2.3 to install dataset
  - zone 427ec88f-f467-42fa-9bbb-66a91a36103c (InternalDns) left unchanged, image source: install dataset
  - zone 5199c033-4cf9-4ab6-8ae7-566bd7606363 (Crucible) left unchanged, image source: install dataset
  - zone 6444f8a5-6465-4f0b-a549-1993c113569c (InternalNtp) left unchanged, image source: install dataset
  - zone 803bfb63-c246-41db-b0da-d3b87ddfc63d (ExternalDns) left unchanged, image source: install dataset
  - zone ba4994a8-23f9-4b1a-a84f-a08d74591389 (CruciblePantry) left unchanged, image source: install dataset
, host_phase_2: 
  - host phase 2 slot A: updated from artifact (version version 1.0.0, hash 3a9607047b03ccaab6d222249d890e93ca51b94ad631c7ca38be74cba60802ff) to preserving current contents
  - host phase 2 slot B: updated from artifact (version version 1.0.0, hash 044d45ad681b44e89c10e056cabdedf19fd8b1e54bc95e6622bcdd23f16bc8f2) to preserving current contents

INFO previous MGS update cleared as part of updating blueprint mupdate override to match inventory, phase: do_plan_mupdate_override, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, artifact_version: 1.1.0, artifact_hash: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855, expected_inactive_version: Version(ArtifactVersion("1.0.1")), expected_active_version: 1.0.0, component: sp, sp_slot: 0, sp_type: Sled, serial_number: serial0, part_number: model0
INFO blueprint mupdate override updated to match inventory, phase: do_plan_mupdate_override, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, new_bp_override: 203fa72c-85c1-466a-8ed3-338ee029530d, prev_bp_override: None, zones: 
  - zone 3eeb8d49-eb1a-43f8-bb64-c2338421c2c6 (Nexus) left unchanged, image source: install dataset
  - zone 75b220ba-a0f4-4872-8202-dc7c87f062d0 (CruciblePantry) left unchanged, image source: install dataset
  - zone ea5b4030-b52f-44b2-8d70-45f15f987d01 (InternalDns) left unchanged, image source: install dataset
  - zone f10a4fb9-759f-4a65-b25e-5794ad2d07d8 (InternalNtp) left unchanged, image source: install dataset
  - zone f55647d4-5500-4ad3-893a-df45bd50d622 (Crucible) left unchanged, image source: install dataset
  - zone f6ec9c67-946a-4da3-98d5-581f72ce8bf0 (ExternalDns) left unchanged, image source: install dataset
, host_phase_2: 
  - host phase 2 slot A: current contents (unchanged)
  - host phase 2 slot B: current contents (unchanged)

INFO no previous MGS update found as part of updating blueprint mupdate override to match inventory, phase: do_plan_mupdate_override, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763
INFO updating target release minimum generation based on new set-override actions, phase: do_plan_mupdate_override, current_generation: 1, new_generation: 3
WARN skipped noop image source check on sled, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, reason: error retrieving mupdate override information: reconfigurator-cli simulated mupdate-override error
INFO skipped noop image source check on sled, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, reason: remove_mupdate_override is set in the blueprint (6123eac1-ec5b-42ba-b73f-9845105a9971)
INFO skipped noop image source check on sled, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, reason: remove_mupdate_override is set in the blueprint (203fa72c-85c1-466a-8ed3-338ee029530d)
generated blueprint a5a8f242-ffa5-473c-8efd-2acf2dc0b736 based on parent blueprint d60afc57-f15d-476c-bd0f-b1071e2bb976
blueprint source: planner with report:
planning report for blueprint a5a8f242-ffa5-473c-8efd-2acf2dc0b736:
* zone adds waiting on blockers
* zone adds and updates are blocked:
  - current target release generation (2) is lower than minimum required by blueprint (3)
  - sleds have remove mupdate override set in blueprint: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, d81c6a84-79b8-4958-ae41-ea46c9b19763
  - sleds have mupdate override errors: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c
  - sleds have deployment units with image sources not set to Artifact:
    - sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c: 7 zones
    - sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6: 6 zones
    - sled d81c6a84-79b8-4958-ae41-ea46c9b19763: 6 zones

* zone updates waiting on zone add blockers




> # Diff the blueprints. This diff should show:
> #
> # * for sled 0:
> #   * "+ will remove mupdate override"
> #   * for zone 0c71b3b2-6ceb-4e8f-b020-b08675e83038, a change from artifact to install-dataset
> #   * the pending MGS update cleared
> #   * host phase 2 contents set to current contents
> # * for sled 1, no change, because the mupdate override field had an error
> # * for sled 2, "+ will remove mupdate override"
> # * the target release's minimum generation bumped from 1 to 3
> #   (the 3 is because generation 2 is repo-1.0.0.zip)
> blueprint-diff latest
from: blueprint d60afc57-f15d-476c-bd0f-b1071e2bb976
to:   blueprint a5a8f242-ffa5-473c-8efd-2acf2dc0b736

 MODIFIED SLEDS:

  sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c (active, config generation 4 -> 5):

    host phase 2 contents:
    --------------------------------
    slot   boot image source        
    --------------------------------
*   A      - artifact: version 1.0.0
     └─    + current contents       
*   B      - artifact: version 1.0.0
     └─    + current contents       


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-72c59873-31ff-4e36-8d76-ff834009349a   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crucible                                                              8c4fa711-1d5d-4e93-85f0-d17bff47b063   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/clickhouse                                                      3b66453b-7148-4c1b-84a9-499e43290ab4   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/external_dns                                                    841d5648-05f0-47b0-b446-92f6b60fe9a6   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/internal_dns                                                    3560dd69-3b23-4c69-807d-d673104cfc68   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone                                                            4829f422-aa31-41a8-ab73-95684ff1ef48   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_clickhouse_353b3b65-20f7-48c3-88f7-495bd5d31545        318fae85-abcb-4259-b1b6-ac96d193f7b7   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_crucible_bd354eef-d8a6-4165-9124-283fb5e46d77          2ad1875a-92ac-472f-8c26-593309f0e4da   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_crucible_pantry_ad6a3a03-8d0f-4504-99a4-cbf73d69b973   c31623de-c19b-4615-9f1d-5e1daa5d3bda   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_external_dns_6c3ae381-04f7-41ea-b0ac-74db387dbc3a      b46de15d-33e7-4cd0-aa7c-e7be2a61e71b   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_internal_dns_99e2f30b-3174-40bf-a78a-90da8abba8ca      09b9cc9b-3426-470b-a7bc-538f82dede03   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_nexus_466a9f29-62bf-4e63-924a-b9efdb86afec             775f9207-c42d-4af2-9186-27ffef67735e   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_ntp_62620961-fc4a-481e-968b-f5acbac0dc63               2db6b7c1-0f46-4ced-a3ad-48872793360e   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/debug                                                           93957ca0-9ed1-4e7b-8c34-2ce07a69541c   in service    100 GiB   none          gzip-9     


    omicron zones:
    ---------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source      disposition   underlay IP           
    ---------------------------------------------------------------------------------------------------------------
    clickhouse        353b3b65-20f7-48c3-88f7-495bd5d31545   install dataset   in service    fd00:1122:3344:102::23
    crucible          bd354eef-d8a6-4165-9124-283fb5e46d77   install dataset   in service    fd00:1122:3344:102::26
    crucible_pantry   ad6a3a03-8d0f-4504-99a4-cbf73d69b973   install dataset   in service    fd00:1122:3344:102::25
    external_dns      6c3ae381-04f7-41ea-b0ac-74db387dbc3a   install dataset   in service    fd00:1122:3344:102::24
    internal_dns      99e2f30b-3174-40bf-a78a-90da8abba8ca   install dataset   in service    fd00:1122:3344:1::1   
    internal_ntp      62620961-fc4a-481e-968b-f5acbac0dc63   install dataset   in service    fd00:1122:3344:102::21
    nexus             466a9f29-62bf-4e63-924a-b9efdb86afec   install dataset   in service    fd00:1122:3344:102::22


  sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 (active, config generation 5 -> 6):
+   will remove mupdate override:   (none) -> 6123eac1-ec5b-42ba-b73f-9845105a9971

    host phase 2 contents:
    --------------------------------
    slot   boot image source        
    --------------------------------
*   A      - artifact: version 1.0.0
     └─    + current contents       
*   B      - artifact: version 1.0.0
     └─    + current contents       


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-c6d33b64-fb96-4129-bab1-7878a06a5f9b   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crucible                                                              43931274-7fe8-4077-825d-dff2bc8efa58   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/external_dns                                                    a4c3032e-21fa-4d4a-b040-a7e3c572cf3c   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/internal_dns                                                    4f60b534-eaa3-40a1-b60f-bfdf147af478   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone                                                            4617d206-4330-4dfa-b9f3-f63a3db834f9   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_crucible_5199c033-4cf9-4ab6-8ae7-566bd7606363          ad41be71-6c15-4428-b510-20ceacde4fa6   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_crucible_pantry_ba4994a8-23f9-4b1a-a84f-a08d74591389   1bca7f71-5e42-4749-91ec-fa40793a3a9a   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_external_dns_803bfb63-c246-41db-b0da-d3b87ddfc63d      3ac089c9-9dec-465b-863a-188e80d71fb4   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_internal_dns_427ec88f-f467-42fa-9bbb-66a91a36103c      686c19cf-a0d7-45f6-866f-c564612b2664   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_nexus_0c71b3b2-6ceb-4e8f-b020-b08675e83038             793ac181-1b01-403c-850d-7f5c54bda6c9   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_ntp_6444f8a5-6465-4f0b-a549-1993c113569c               cdf3684f-a6cf-4449-b9ec-e696b2c663e2   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/debug                                                           248c6c10-1ac6-45de-bb55-ede36ca56bbd   in service    100 GiB   none          gzip-9     


    omicron zones:
    -------------------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source                disposition   underlay IP           
    -------------------------------------------------------------------------------------------------------------------------
    crucible          5199c033-4cf9-4ab6-8ae7-566bd7606363   install dataset             in service    fd00:1122:3344:101::25
    crucible_pantry   ba4994a8-23f9-4b1a-a84f-a08d74591389   install dataset             in service    fd00:1122:3344:101::24
    external_dns      803bfb63-c246-41db-b0da-d3b87ddfc63d   install dataset             in service    fd00:1122:3344:101::23
    internal_dns      427ec88f-f467-42fa-9bbb-66a91a36103c   install dataset             in service    fd00:1122:3344:2::1   
    internal_ntp      6444f8a5-6465-4f0b-a549-1993c113569c   install dataset             in service    fd00:1122:3344:101::21
*   nexus             0c71b3b2-6ceb-4e8f-b020-b08675e83038   - artifact: version 1.2.3   in service    fd00:1122:3344:101::22
     └─                                                      + install dataset                                               


  sled d81c6a84-79b8-4958-ae41-ea46c9b19763 (active, config generation 2 -> 3):
+   will remove mupdate override:   (none) -> 203fa72c-85c1-466a-8ed3-338ee029530d

    host phase 2 contents:
    ------------------------
    slot   boot image source
    ------------------------
    A      current contents 
    B      current contents 


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-4930954e-9ac7-4453-b63f-5ab97c389a99   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crucible                                                              090bd88d-0a43-4040-a832-b13ae721f74f   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/external_dns                                                    4da74a5b-6911-4cca-b624-b90c65530117   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/internal_dns                                                    252ac39f-b9e2-4697-8c07-3a833115d704   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone                                                            45cd9687-20be-4247-b62a-dfdacf324929   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_f55647d4-5500-4ad3-893a-df45bd50d622          1cb0a47a-59ac-4892-8e92-cf87b4290f96   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_pantry_75b220ba-a0f4-4872-8202-dc7c87f062d0   b1deff4b-51df-4a37-9043-afbd7c70a1cb   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_external_dns_f6ec9c67-946a-4da3-98d5-581f72ce8bf0      c65a9c1c-36dc-4ddb-8aac-ec3be8dbb209   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_internal_dns_ea5b4030-b52f-44b2-8d70-45f15f987d01      21fd4f3a-ec31-469b-87b1-087c343a2422   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_nexus_3eeb8d49-eb1a-43f8-bb64-c2338421c2c6             e009d8b8-4695-4322-b53f-f03f2744aef7   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_ntp_f10a4fb9-759f-4a65-b25e-5794ad2d07d8               41071985-1dfd-4ce5-8bc2-897161a8bce4   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/debug                                                           7a6a2058-ea78-49de-9730-cce5e28b4cfb   in service    100 GiB   none          gzip-9     


    omicron zones:
    ---------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source      disposition   underlay IP           
    ---------------------------------------------------------------------------------------------------------------
    crucible          f55647d4-5500-4ad3-893a-df45bd50d622   install dataset   in service    fd00:1122:3344:103::25
    crucible_pantry   75b220ba-a0f4-4872-8202-dc7c87f062d0   install dataset   in service    fd00:1122:3344:103::24
    external_dns      f6ec9c67-946a-4da3-98d5-581f72ce8bf0   install dataset   in service    fd00:1122:3344:103::23
    internal_dns      ea5b4030-b52f-44b2-8d70-45f15f987d01   install dataset   in service    fd00:1122:3344:3::1   
    internal_ntp      f10a4fb9-759f-4a65-b25e-5794ad2d07d8   install dataset   in service    fd00:1122:3344:103::21
    nexus             3eeb8d49-eb1a-43f8-bb64-c2338421c2c6   install dataset   in service    fd00:1122:3344:103::22


 COCKROACHDB SETTINGS:
    state fingerprint:::::::::::::::::   (none) (unchanged)
    cluster.preserve_downgrade_option:   (do not modify) (unchanged)

 METADATA:
    internal DNS version:::   1 (unchanged)
    external DNS version:::   1 (unchanged)
*   target release min gen:   1 -> 3
    nexus gen::::::::::::::   1 (unchanged)

 OXIMETER SETTINGS:
    generation:   1 (unchanged)
    read from::   SingleNode (unchanged)

 PENDING MGS UPDATES:

    Pending MGS-managed updates (all baseboards):
    --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    sp_type   slot   part_number   serial_number   artifact_hash                                                      artifact_version   details                                                                                                                                          
    --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-   sled      0      model0        serial0         e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855   1.1.0              Sp(PendingMgsUpdateSpDetails { expected_active_version: ArtifactVersion("1.0.0"), expected_inactive_version: Version(ArtifactVersion("1.0.1")) })
-   sled      1      model1        serial1         e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855   newest             Sp(PendingMgsUpdateSpDetails { expected_active_version: ArtifactVersion("newer"), expected_inactive_version: Version(ArtifactVersion("older")) })


internal DNS:
  DNS zone: "control-plane.oxide.internal" (unchanged)
    unchanged names: 39 (records: 53)

external DNS:
  DNS zone: "oxide.example" (unchanged)
    unchanged names: 5 (records: 9)




> # Hide sled 0 from inventory temporarily -- this does two things:
> # 1. Tests that mupdate/update state transitions don't happen when
> #    the sled isn't present in inventory.
> # 2. We don't want sled 0 to participate in the next few operations
> #    below.
> sled-set serial0 inventory-hidden
set sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 inventory visibility: visible -> hidden


> # Set the target release to a new repo, causing a generation number bump
> # to 3.
> set target-release repo-1.0.0.zip
INFO extracting uploaded archive to <EXTRACTING_UPLOADED_ARCHIVE_TO_REDACTED>
INFO created directory to store extracted artifacts, path: <CREATED_DIRECTORY_TO_STORE_EXTRACTED_ARTIFACTS_PATH_REDACTED>
INFO added artifact, name: fake-gimlet-sp, kind: gimlet_sp, version: 1.0.0, hash: 68465b8e3f808f475510b525cfd62086d37ddd57688bd854184fdafb2b2198a4, length: 732
INFO added artifact, name: fake-rot, kind: gimlet_rot_image_a, version: 1.0.0, hash: d11e65f934bf0de51df2e5b484f61ee72072417b43ac87f33e958008428e7b02, length: 783
INFO added artifact, name: fake-rot, kind: gimlet_rot_image_b, version: 1.0.0, hash: d11e65f934bf0de51df2e5b484f61ee72072417b43ac87f33e958008428e7b02, length: 783
INFO added artifact, name: fake-rot-bootloader, kind: gimlet_rot_bootloader, version: 1.0.0, hash: 5b0f601b1fbb8674db9c751a02f8b14f8e6d4e8470f4f7b686fecb2c49ec11f9, length: 797
INFO added artifact, name: fake-host, kind: gimlet_host_phase_1, version: 1.0.0, hash: b99d5273ba1418bebb19d74b701d716896409566d41de76ada71bded4c9b166b, length: 524288
INFO added artifact, name: fake-host, kind: cosmo_host_phase_1, version: 1.0.0, hash: 9525f567106549a3fc32df870a74803d77e51dcc44190b218e227a2c5d444f58, length: 524288
INFO added artifact, name: fake-host, kind: host_phase_2, version: 1.0.0, hash: d944ae205b61ccf4322448f7d0311a819c53d9844769de066c5307c1682abb47, length: 1048576
INFO added artifact, name: fake-trampoline, kind: gimlet_trampoline_phase_1, version: 1.0.0, hash: bcb27520ee5a56e19f6df9662c66d69ac681fbd873a97547be5f6a5ae3d250c4, length: 524288
INFO added artifact, name: fake-trampoline, kind: cosmo_trampoline_phase_1, version: 1.0.0, hash: e235b8afb58ee69d966853bd5efe7c7e904da84b9035a332b3e691dc1d5cdbd0, length: 524288
INFO added artifact, name: fake-trampoline, kind: trampoline_phase_2, version: 1.0.0, hash: a5dfcc4bc69b791f1c509df499e9e72cce844cb2b53a56d8bb357b264bdf13b6, length: 1048576
INFO added artifact, name: clickhouse, kind: zone, version: 1.0.0, hash: 52b1eb4daff6f9140491d547b11248392920230db3db0eef5f5fa5333fe9e659, length: 1686
INFO added artifact, name: clickhouse_keeper, kind: zone, version: 1.0.0, hash: cda702919449d86663be97295043aeca0ead69ae5db3bbdb20053972254a27a3, length: 1690
INFO added artifact, name: clickhouse_server, kind: zone, version: 1.0.0, hash: 5f9ae6a9821bbe8ff0bf60feddf8b167902fe5f3e2c98bd21edd1ec9d969a001, length: 1690
INFO added artifact, name: cockroachdb, kind: zone, version: 1.0.0, hash: f3a1a3c0b3469367b005ee78665d982059d5e14e93a479412426bf941c4ed291, length: 1689
INFO added artifact, name: crucible-zone, kind: zone, version: 1.0.0, hash: 6f17cf65fb5a5bec5542dd07c03cd0acc01e59130f02c532c8d848ecae810047, length: 1690
INFO added artifact, name: crucible-pantry-zone, kind: zone, version: 1.0.0, hash: 21f0ada306859c23917361f2e0b9235806c32607ec689c7e8cf16bb898bc5a02, length: 1695
INFO added artifact, name: external-dns, kind: zone, version: 1.0.0, hash: ccca13ed19b8731f9adaf0d6203b02ea3b9ede4fa426b9fac0a07ce95440046d, length: 1689
INFO added artifact, name: internal-dns, kind: zone, version: 1.0.0, hash: ffbf1373f7ee08dddd74c53ed2a94e7c4c572a982d3a9bc94000c6956b700c6a, length: 1689
INFO added artifact, name: ntp, kind: zone, version: 1.0.0, hash: 67593d686ed04a1709f93972b71f4ebc148a9362120f65d239943e814a9a7439, length: 1681
INFO added artifact, name: nexus, kind: zone, version: 1.0.0, hash: 0e32b4a3e5d3668bb1d6a16fb06b74dc60b973fa479dcee0aae3adbb52bf1388, length: 1682
INFO added artifact, name: oximeter, kind: zone, version: 1.0.0, hash: 048d8fe8cdef5b175aad714d0f148aa80ce36c9114ac15ce9d02ed3d37877a77, length: 1682
INFO added artifact, name: fake-psc-sp, kind: psc_sp, version: 1.0.0, hash: 89245fe2ac7e6a2ac8dfa4e7d6891a6e6df95e4141395c07c64026778f6d76d7, length: 721
INFO added artifact, name: fake-psc-rot, kind: psc_rot_image_a, version: 1.0.0, hash: 5d8ea834dd6d42d386f1eb8a2c5f6e99b697c9958bb4ab8edf63e56003e25d8d, length: 775
INFO added artifact, name: fake-psc-rot, kind: psc_rot_image_b, version: 1.0.0, hash: 5d8ea834dd6d42d386f1eb8a2c5f6e99b697c9958bb4ab8edf63e56003e25d8d, length: 775
INFO added artifact, name: fake-psc-rot-bootloader, kind: psc_rot_bootloader, version: 1.0.0, hash: 18c9c774bfe4bb086e869509dcccacee8476fd87670692b765aee216f2c7f003, length: 805
INFO added artifact, name: fake-switch-sp, kind: switch_sp, version: 1.0.0, hash: bf1bc1da5059f76182c3007c3049941f8898abede2f3765b106c6e7f7c42d44c, length: 740
INFO added artifact, name: fake-switch-rot, kind: switch_rot_image_a, version: 1.0.0, hash: 32307d6d75c9707e8499ba4a4d379f99c0358237b6e190ff6a8024b470f62342, length: 774
INFO added artifact, name: fake-switch-rot, kind: switch_rot_image_b, version: 1.0.0, hash: 32307d6d75c9707e8499ba4a4d379f99c0358237b6e190ff6a8024b470f62342, length: 774
INFO added artifact, name: fake-switch-rot-bootloader, kind: switch_rot_bootloader, version: 1.0.0, hash: 70836d170abd5621f95bb4225987b27b3d3dd6168e73cd60e44309bdfeb94e98, length: 804
INFO added artifact, name: installinator_document, kind: installinator_document, version: 1.0.0, hash: a6a636b5d57813578766b3f1c2559abf9af5d8c86187538167937c476beeefa3, length: 367
set target release based on repo-1.0.0.zip


> # Invoke the planner -- should not proceed with adding or updating zones
> # because sled 0 has a remove-mupdate-override set in the blueprint.
> inventory-generate
generated inventory collection 61f451b3-2121-4ed6-91c7-a550054f6c21 from configured sleds

> blueprint-plan latest latest
WARN skipping zones eligible for cleanup check (sled not present in latest inventory collection), sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6
ERRO error getting mupdate override info for sled, not altering blueprint override, but cleared pending host phase 2 updates if any, phase: do_plan_mupdate_override, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, message: reconfigurator-cli simulated mupdate-override error, bp_override: None, prev_host_phase_2: 
  - host phase 2 slot A: current contents (unchanged)
  - host phase 2 slot B: current contents (unchanged)

INFO no previous MGS update found, so no action taken as part of updating blueprint because there was an error obtaining mupdate override info, phase: do_plan_mupdate_override, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c
WARN no inventory found for in-service sled, phase: do_plan_mupdate_override, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6
WARN skipped noop image source check on sled, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, reason: error retrieving mupdate override information: reconfigurator-cli simulated mupdate-override error
INFO skipped noop image source check on sled, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, reason: sled not found in inventory
INFO skipped noop image source check on sled, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, reason: remove_mupdate_override is set in the blueprint (203fa72c-85c1-466a-8ed3-338ee029530d)
generated blueprint 626487fa-7139-45ec-8416-902271fc730b based on parent blueprint a5a8f242-ffa5-473c-8efd-2acf2dc0b736
blueprint source: planner with report:
planning report for blueprint 626487fa-7139-45ec-8416-902271fc730b:
* zone adds waiting on blockers
* zone adds and updates are blocked:
  - sleds have remove mupdate override set in blueprint: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, d81c6a84-79b8-4958-ae41-ea46c9b19763
  - sleds have mupdate override errors: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c
  - sleds have deployment units with image sources not set to Artifact:
    - sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c: 7 zones
    - sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6: 6 zones
    - sled d81c6a84-79b8-4958-ae41-ea46c9b19763: 6 zones

* zone updates waiting on zone add blockers



> blueprint-diff latest
from: blueprint a5a8f242-ffa5-473c-8efd-2acf2dc0b736
to:   blueprint 626487fa-7139-45ec-8416-902271fc730b

 COCKROACHDB SETTINGS:
    state fingerprint:::::::::::::::::   (none) (unchanged)
    cluster.preserve_downgrade_option:   (do not modify) (unchanged)

 METADATA:
    internal DNS version:::   1 (unchanged)
    external DNS version:::   1 (unchanged)
    target release min gen:   3 (unchanged)
    nexus gen::::::::::::::   1 (unchanged)

 OXIMETER SETTINGS:
    generation:   1 (unchanged)
    read from::   SingleNode (unchanged)


internal DNS:
  DNS zone: "control-plane.oxide.internal" (unchanged)
    unchanged names: 38 (records: 51)

external DNS:
  DNS zone: "oxide.example" (unchanged)
    unchanged names: 5 (records: 9)




> # Now simulate the new config being applied to sled 0, which would
> # cause the mupdate override to be removed.
> sled-set serial0 mupdate-override unset
set sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 mupdate override: 6123eac1-ec5b-42ba-b73f-9845105a9971 -> unset

> sled-set serial0 inventory-visible
set sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 inventory visibility: hidden -> visible


> # But simulate a second mupdate on sled 2. This should invalidate the existing
> # mupdate override on sled 2 and cause another target release minimum
> # generation bump.
> tuf-assemble ../../update-common/manifests/fake-non-semver.toml --allow-non-semver
INFO assembling repository in <ASSEMBLING_REPOSITORY_IN_REDACTED>
INFO artifacts assembled and archived to `repo-2.0.0.zip`, component: OmicronRepoAssembler
created repo-2.0.0.zip for system version 2.0.0

> sled-update-install-dataset serial2 --from-repo repo-2.0.0.zip
INFO extracting uploaded archive to <EXTRACTING_UPLOADED_ARCHIVE_TO_REDACTED>
INFO created directory to store extracted artifacts, path: <CREATED_DIRECTORY_TO_STORE_EXTRACTED_ARTIFACTS_PATH_REDACTED>
INFO added artifact, name: fake-gimlet-sp, kind: gimlet_sp, version: 2.0.0, hash: ac329e461b20cfdeaeb225456226b1dc3042e7254d238cc2ccf2903b18a69991, length: 731
INFO added artifact, name: fake-gimlet-rot, kind: gimlet_rot_image_a, version: 2.0.0, hash: 3ab29e804bcbf382370f9f071b2f0ed71e5bb6af8b01474fcc2a414caccfc9be, length: 782
INFO added artifact, name: fake-gimlet-rot, kind: gimlet_rot_image_b, version: 2.0.0, hash: 3ab29e804bcbf382370f9f071b2f0ed71e5bb6af8b01474fcc2a414caccfc9be, length: 782
INFO added artifact, name: fake-gimlet-rot-bootloader, kind: gimlet_rot_bootloader, version: 2.0.0, hash: 8f89bf8bc5f3271650ad72a26fc0d116c910161ca143731473a2b20fb82653cc, length: 800
INFO added artifact, name: fake-host, kind: gimlet_host_phase_1, version: 2.0.0, hash: 1eba0d79ea9d34558fb3f923a06614bd740649eeb0ca6e5086529dc60cd6f729, length: 524288
INFO added artifact, name: fake-host, kind: cosmo_host_phase_1, version: 2.0.0, hash: acde77f1a4ee5cf719841b21bb04fd652ddf61387bdbc95a67cc1006009ad611, length: 524288
INFO added artifact, name: fake-host, kind: host_phase_2, version: 2.0.0, hash: 9ff631b5b7229604ab7c5aae2ee4a34a64772736b332540d38077b3aea6952df, length: 1048576
INFO added artifact, name: fake-trampoline, kind: gimlet_trampoline_phase_1, version: non-semver, hash: 4c854917481a7bcb7b7c1e63833296b3ac1f8687aae5b950ece75a08cf27f35f, length: 524288
INFO added artifact, name: fake-trampoline, kind: cosmo_trampoline_phase_1, version: non-semver, hash: 6b4ace7210d67fa3a63b14e007d99fbcad1b4e27e78025c8e467c2341f67c2ba, length: 524288
INFO added artifact, name: fake-trampoline, kind: trampoline_phase_2, version: non-semver, hash: d7cdc8e1bfd15a830cfdc67868a7c05828090aefc42c8af44aa1104900d09fe5, length: 1048576
INFO added artifact, name: clickhouse, kind: zone, version: 2.0.0, hash: bb2d1ff02d11f72bc9049ae57f27536207519a1859d29f8d7a90ab3b44d56b08, length: 1687
INFO added artifact, name: clickhouse_keeper, kind: zone, version: 2.0.0, hash: 1eb9f24be68f13c274aa0ac9b863cec520dbfe762620c328431728d75bfd2198, length: 1691
INFO added artifact, name: clickhouse_server, kind: zone, version: 2.0.0, hash: 50fe271948672a9af1ba5f96c9d87ff2736fa72d78dfef598a79fa0cc8a00474, length: 1691
INFO added artifact, name: cockroachdb, kind: zone, version: 2.0.0, hash: ebc82bf181db864b78cb7e3ddedf7ab1dd8fe7b377b02846f3c27cf0387bb387, length: 1690
INFO added artifact, name: crucible-zone, kind: zone, version: 2.0.0, hash: 866f6a7c2e51c056fb722b5113e80181cc9cd8b712a0d3dbf1edc4ce29e5229e, length: 1691
INFO added artifact, name: crucible-pantry-zone, kind: zone, version: 2.0.0, hash: 3ff26dad96faa8f67251f5de40458b4f809d536bfe8572134da0e42c2fa12674, length: 1696
INFO added artifact, name: external-dns, kind: zone, version: 2.0.0, hash: f282c45771429f7bebf71f0cc668521066db57c6bb07fcfccdfb44825d3d930f, length: 1690
INFO added artifact, name: internal-dns, kind: zone, version: 2.0.0, hash: de30657a72b066b8ef1f56351a0a5d4d7000da0a62c4be9b2e949a107ca8a389, length: 1690
INFO added artifact, name: ntp, kind: zone, version: 2.0.0, hash: d76e26198daed69cdae04490d7477f8c842e0dbe37d463eac0d0a8d3fb803095, length: 1682
INFO added artifact, name: nexus, kind: zone, version: 2.0.0, hash: e9b7035f41848a987a798c15ac424cc91dd662b1af0920d58d8aa1ebad7467b6, length: 1683
INFO added artifact, name: oximeter, kind: zone, version: 2.0.0, hash: 9f4bc56a15d5fd943fdac94309994b8fd73aa2be1ec61faf44bfcf2356c9dc23, length: 1683
INFO added artifact, name: fake-psc-sp, kind: psc_sp, version: 2.0.0, hash: fe18e9b745f899f71dc9a718311d97c33f79eb579de09990b0cd2032574d9430, length: 729
INFO added artifact, name: fake-psc-rot, kind: psc_rot_image_a, version: 2.0.0, hash: be3fa620485936ebd70160b79d74f8f5709d9388c1add9b7e0fa7d283943e6a8, length: 776
INFO added artifact, name: fake-psc-rot, kind: psc_rot_image_b, version: 2.0.0, hash: be3fa620485936ebd70160b79d74f8f5709d9388c1add9b7e0fa7d283943e6a8, length: 776
INFO added artifact, name: fake-psc-rot-bootloader, kind: psc_rot_bootloader, version: 2.0.0, hash: ca4d5642e1be0acb535ca63804eec2f19e783c33e3a3ebffa843916accaafeb9, length: 799
INFO added artifact, name: fake-switch-sp, kind: switch_sp, version: 2.0.0, hash: f6c2b7e7b2fc19b17d3d604dbc16da1adcd6966db80fbbd2127f4a7fe123e71b, length: 746
INFO added artifact, name: fake-switch-rot, kind: switch_rot_image_a, version: 2.0.0, hash: ad32d98232043a39d076b5b90b506fad406767e0ce1298507e1733bc4e576740, length: 791
INFO added artifact, name: fake-switch-rot, kind: switch_rot_image_b, version: 2.0.0, hash: ad32d98232043a39d076b5b90b506fad406767e0ce1298507e1733bc4e576740, length: 791
INFO added artifact, name: fake-switch-rot-bootloader, kind: switch_rot_bootloader, version: non-semver-2, hash: ceae102fa428d81aa6c5d9e1c742fb9ca1091ce5b2797ed0bb14615cf678d342, length: 811
INFO added artifact, name: installinator_document, kind: installinator_document, version: 2.0.0, hash: 13bb3382a02d1f908137cfa356f1434995de15539341a6d8f52a8f2614c52d6c, length: 367
sled d81c6a84-79b8-4958-ae41-ea46c9b19763: install dataset updated: from repo at repo-2.0.0.zip (system version 2.0.0)

> sled-set serial2 mupdate-override 1c0ce176-6dc8-4a90-adea-d4a8000751da
set sled d81c6a84-79b8-4958-ae41-ea46c9b19763 mupdate override: 203fa72c-85c1-466a-8ed3-338ee029530d -> 1c0ce176-6dc8-4a90-adea-d4a8000751da


> # Generate a new inventory and plan against that.
> inventory-generate
generated inventory collection b1bda47d-2c19-4fba-96e3-d9df28db7436 from configured sleds

> blueprint-plan latest latest
ERRO error getting mupdate override info for sled, not altering blueprint override, but cleared pending host phase 2 updates if any, phase: do_plan_mupdate_override, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, message: reconfigurator-cli simulated mupdate-override error, bp_override: None, prev_host_phase_2: 
  - host phase 2 slot A: current contents (unchanged)
  - host phase 2 slot B: current contents (unchanged)

INFO no previous MGS update found, so no action taken as part of updating blueprint because there was an error obtaining mupdate override info, phase: do_plan_mupdate_override, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c
INFO inventory override no longer exists, blueprint override cleared, phase: do_plan_mupdate_override, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, prev_bp_override: 6123eac1-ec5b-42ba-b73f-9845105a9971
INFO blueprint mupdate override updated to match inventory, phase: do_plan_mupdate_override, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, new_bp_override: 1c0ce176-6dc8-4a90-adea-d4a8000751da, prev_bp_override: Some(203fa72c-85c1-466a-8ed3-338ee029530d (mupdate_override)), zones: 
  - zone 3eeb8d49-eb1a-43f8-bb64-c2338421c2c6 (Nexus) left unchanged, image source: install dataset
  - zone 75b220ba-a0f4-4872-8202-dc7c87f062d0 (CruciblePantry) left unchanged, image source: install dataset
  - zone ea5b4030-b52f-44b2-8d70-45f15f987d01 (InternalDns) left unchanged, image source: install dataset
  - zone f10a4fb9-759f-4a65-b25e-5794ad2d07d8 (InternalNtp) left unchanged, image source: install dataset
  - zone f55647d4-5500-4ad3-893a-df45bd50d622 (Crucible) left unchanged, image source: install dataset
  - zone f6ec9c67-946a-4da3-98d5-581f72ce8bf0 (ExternalDns) left unchanged, image source: install dataset
, host_phase_2: 
  - host phase 2 slot A: current contents (unchanged)
  - host phase 2 slot B: current contents (unchanged)

INFO no previous MGS update found as part of updating blueprint mupdate override to match inventory, phase: do_plan_mupdate_override, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763
INFO updating target release minimum generation based on new set-override actions, phase: do_plan_mupdate_override, current_generation: 3, new_generation: 4
WARN skipped noop image source check on sled, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, reason: error retrieving mupdate override information: reconfigurator-cli simulated mupdate-override error
INFO performed noop zone image source checks on sled, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, num_total: 6, num_already_artifact: 0, num_eligible: 6, num_ineligible: 0
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, slot: b, expected_hash: 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
INFO skipped noop image source check on sled, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, reason: remove_mupdate_override is set in the blueprint (1c0ce176-6dc8-4a90-adea-d4a8000751da)
generated blueprint c1a0d242-9160-40f4-96ae-61f8f40a0b1b based on parent blueprint 626487fa-7139-45ec-8416-902271fc730b
blueprint source: planner with report:
planning report for blueprint c1a0d242-9160-40f4-96ae-61f8f40a0b1b:
* noop converting 6/6 install-dataset zones to artifact store on sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6
* zone adds waiting on blockers
* zone adds and updates are blocked:
  - current target release generation (3) is lower than minimum required by blueprint (4)
  - sleds have remove mupdate override set in blueprint: d81c6a84-79b8-4958-ae41-ea46c9b19763
  - sleds have mupdate override errors: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c
  - sleds have deployment units with image sources not set to Artifact:
    - sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c: 7 zones
    - sled d81c6a84-79b8-4958-ae41-ea46c9b19763: 6 zones

* zone updates waiting on zone add blockers




> # Diff the blueprints. This diff should show:
> # * on sled 0:
> #   * the "remove mupdate override" line going away
> #   * no-op image source switches from install dataset to artifact
> # * on sled 1, no changes
> # * on sled 2, a _change_ in the will-remove-mupdate-override field
> # * another bump to the target release minimum generation, this time to 4.
> blueprint-diff latest
from: blueprint 626487fa-7139-45ec-8416-902271fc730b
to:   blueprint c1a0d242-9160-40f4-96ae-61f8f40a0b1b

 MODIFIED SLEDS:

  sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 (active, config generation 6 -> 7):
-   will remove mupdate override:   6123eac1-ec5b-42ba-b73f-9845105a9971 -> (none)

    host phase 2 contents:
    ------------------------
    slot   boot image source
    ------------------------
    A      current contents 
    B      current contents 


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-c6d33b64-fb96-4129-bab1-7878a06a5f9b   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crucible                                                              43931274-7fe8-4077-825d-dff2bc8efa58   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/external_dns                                                    a4c3032e-21fa-4d4a-b040-a7e3c572cf3c   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/internal_dns                                                    4f60b534-eaa3-40a1-b60f-bfdf147af478   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone                                                            4617d206-4330-4dfa-b9f3-f63a3db834f9   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_crucible_5199c033-4cf9-4ab6-8ae7-566bd7606363          ad41be71-6c15-4428-b510-20ceacde4fa6   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_crucible_pantry_ba4994a8-23f9-4b1a-a84f-a08d74591389   1bca7f71-5e42-4749-91ec-fa40793a3a9a   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_external_dns_803bfb63-c246-41db-b0da-d3b87ddfc63d      3ac089c9-9dec-465b-863a-188e80d71fb4   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_internal_dns_427ec88f-f467-42fa-9bbb-66a91a36103c      686c19cf-a0d7-45f6-866f-c564612b2664   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_nexus_0c71b3b2-6ceb-4e8f-b020-b08675e83038             793ac181-1b01-403c-850d-7f5c54bda6c9   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_ntp_6444f8a5-6465-4f0b-a549-1993c113569c               cdf3684f-a6cf-4449-b9ec-e696b2c663e2   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/debug                                                           248c6c10-1ac6-45de-bb55-ede36ca56bbd   in service    100 GiB   none          gzip-9     


    omicron zones:
    -------------------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source                disposition   underlay IP           
    -------------------------------------------------------------------------------------------------------------------------
*   crucible          5199c033-4cf9-4ab6-8ae7-566bd7606363   - install dataset           in service    fd00:1122:3344:101::25
     └─                                                      + artifact: version 1.0.0                                       
*   crucible_pantry   ba4994a8-23f9-4b1a-a84f-a08d74591389   - install dataset           in service    fd00:1122:3344:101::24
     └─                                                      + artifact: version 1.0.0                                       
*   external_dns      803bfb63-c246-41db-b0da-d3b87ddfc63d   - install dataset           in service    fd00:1122:3344:101::23
     └─                                                      + artifact: version 1.0.0                                       
*   internal_dns      427ec88f-f467-42fa-9bbb-66a91a36103c   - install dataset           in service    fd00:1122:3344:2::1   
     └─                                                      + artifact: version 1.0.0                                       
*   internal_ntp      6444f8a5-6465-4f0b-a549-1993c113569c   - install dataset           in service    fd00:1122:3344:101::21
     └─                                                      + artifact: version 1.0.0                                       
*   nexus             0c71b3b2-6ceb-4e8f-b020-b08675e83038   - install dataset           in service    fd00:1122:3344:101::22
     └─                                                      + artifact: version 1.0.0                                       


  sled d81c6a84-79b8-4958-ae41-ea46c9b19763 (active, config generation 3 -> 4):
*   will remove mupdate override:   203fa72c-85c1-466a-8ed3-338ee029530d -> 1c0ce176-6dc8-4a90-adea-d4a8000751da

    host phase 2 contents:
    ------------------------
    slot   boot image source
    ------------------------
    A      current contents 
    B      current contents 


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-4930954e-9ac7-4453-b63f-5ab97c389a99   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crucible                                                              090bd88d-0a43-4040-a832-b13ae721f74f   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/external_dns                                                    4da74a5b-6911-4cca-b624-b90c65530117   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/internal_dns                                                    252ac39f-b9e2-4697-8c07-3a833115d704   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone                                                            45cd9687-20be-4247-b62a-dfdacf324929   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_f55647d4-5500-4ad3-893a-df45bd50d622          1cb0a47a-59ac-4892-8e92-cf87b4290f96   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_pantry_75b220ba-a0f4-4872-8202-dc7c87f062d0   b1deff4b-51df-4a37-9043-afbd7c70a1cb   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_external_dns_f6ec9c67-946a-4da3-98d5-581f72ce8bf0      c65a9c1c-36dc-4ddb-8aac-ec3be8dbb209   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_internal_dns_ea5b4030-b52f-44b2-8d70-45f15f987d01      21fd4f3a-ec31-469b-87b1-087c343a2422   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_nexus_3eeb8d49-eb1a-43f8-bb64-c2338421c2c6             e009d8b8-4695-4322-b53f-f03f2744aef7   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_ntp_f10a4fb9-759f-4a65-b25e-5794ad2d07d8               41071985-1dfd-4ce5-8bc2-897161a8bce4   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/debug                                                           7a6a2058-ea78-49de-9730-cce5e28b4cfb   in service    100 GiB   none          gzip-9     


    omicron zones:
    ---------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source      disposition   underlay IP           
    ---------------------------------------------------------------------------------------------------------------
    crucible          f55647d4-5500-4ad3-893a-df45bd50d622   install dataset   in service    fd00:1122:3344:103::25
    crucible_pantry   75b220ba-a0f4-4872-8202-dc7c87f062d0   install dataset   in service    fd00:1122:3344:103::24
    external_dns      f6ec9c67-946a-4da3-98d5-581f72ce8bf0   install dataset   in service    fd00:1122:3344:103::23
    internal_dns      ea5b4030-b52f-44b2-8d70-45f15f987d01   install dataset   in service    fd00:1122:3344:3::1   
    internal_ntp      f10a4fb9-759f-4a65-b25e-5794ad2d07d8   install dataset   in service    fd00:1122:3344:103::21
    nexus             3eeb8d49-eb1a-43f8-bb64-c2338421c2c6   install dataset   in service    fd00:1122:3344:103::22


 COCKROACHDB SETTINGS:
    state fingerprint:::::::::::::::::   (none) (unchanged)
    cluster.preserve_downgrade_option:   (do not modify) (unchanged)

 METADATA:
    internal DNS version:::   1 (unchanged)
    external DNS version:::   1 (unchanged)
*   target release min gen:   3 -> 4
    nexus gen::::::::::::::   1 (unchanged)

 OXIMETER SETTINGS:
    generation:   1 (unchanged)
    read from::   SingleNode (unchanged)


internal DNS:
  DNS zone: "control-plane.oxide.internal" (unchanged)
    unchanged names: 39 (records: 53)

external DNS:
  DNS zone: "oxide.example" (unchanged)
    unchanged names: 5 (records: 9)




> # Clear the mupdate override on sled 2, signifying that the config has been
> # applied.
> sled-set serial2 mupdate-override unset
set sled d81c6a84-79b8-4958-ae41-ea46c9b19763 mupdate override: 1c0ce176-6dc8-4a90-adea-d4a8000751da -> unset


> # Run the planner again. This will cause sled 2's blueprint
> # remove_mupdate_override to be unset. But no further planning steps will
> # happen because the target release generation is not new enough.
> inventory-generate
generated inventory collection a71f7a73-35a6-45e8-acbe-f1c5925eed69 from configured sleds

> blueprint-plan latest latest
ERRO error getting mupdate override info for sled, not altering blueprint override, but cleared pending host phase 2 updates if any, phase: do_plan_mupdate_override, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, message: reconfigurator-cli simulated mupdate-override error, bp_override: None, prev_host_phase_2: 
  - host phase 2 slot A: current contents (unchanged)
  - host phase 2 slot B: current contents (unchanged)

INFO no previous MGS update found, so no action taken as part of updating blueprint because there was an error obtaining mupdate override info, phase: do_plan_mupdate_override, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c
INFO inventory override no longer exists, blueprint override cleared, phase: do_plan_mupdate_override, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, prev_bp_override: 1c0ce176-6dc8-4a90-adea-d4a8000751da
WARN skipped noop image source check on sled, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, reason: error retrieving mupdate override information: reconfigurator-cli simulated mupdate-override error
INFO performed noop zone image source checks on sled, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, num_total: 6, num_already_artifact: 6, num_eligible: 0, num_ineligible: 0
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, slot: b, expected_hash: 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
INFO performed noop zone image source checks on sled, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, num_total: 6, num_already_artifact: 0, num_eligible: 0, num_ineligible: 6
INFO install dataset artifact hash not found in TUF repo, ignoring for noop checks, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, zone_id: 3eeb8d49-eb1a-43f8-bb64-c2338421c2c6, kind: nexus, file_name: nexus.tar.gz, expected_hash: e9b7035f41848a987a798c15ac424cc91dd662b1af0920d58d8aa1ebad7467b6
INFO install dataset artifact hash not found in TUF repo, ignoring for noop checks, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, zone_id: 75b220ba-a0f4-4872-8202-dc7c87f062d0, kind: crucible_pantry, file_name: crucible_pantry.tar.gz, expected_hash: 3ff26dad96faa8f67251f5de40458b4f809d536bfe8572134da0e42c2fa12674
INFO install dataset artifact hash not found in TUF repo, ignoring for noop checks, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, zone_id: ea5b4030-b52f-44b2-8d70-45f15f987d01, kind: internal_dns, file_name: internal_dns.tar.gz, expected_hash: de30657a72b066b8ef1f56351a0a5d4d7000da0a62c4be9b2e949a107ca8a389
INFO install dataset artifact hash not found in TUF repo, ignoring for noop checks, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, zone_id: f10a4fb9-759f-4a65-b25e-5794ad2d07d8, kind: internal_ntp, file_name: ntp.tar.gz, expected_hash: d76e26198daed69cdae04490d7477f8c842e0dbe37d463eac0d0a8d3fb803095
INFO install dataset artifact hash not found in TUF repo, ignoring for noop checks, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, zone_id: f55647d4-5500-4ad3-893a-df45bd50d622, kind: crucible, file_name: crucible.tar.gz, expected_hash: 866f6a7c2e51c056fb722b5113e80181cc9cd8b712a0d3dbf1edc4ce29e5229e
INFO install dataset artifact hash not found in TUF repo, ignoring for noop checks, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, zone_id: f6ec9c67-946a-4da3-98d5-581f72ce8bf0, kind: external_dns, file_name: external_dns.tar.gz, expected_hash: f282c45771429f7bebf71f0cc668521066db57c6bb07fcfccdfb44825d3d930f
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, slot: b, expected_hash: 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
generated blueprint afb09faf-a586-4483-9289-04d4f1d8ba23 based on parent blueprint c1a0d242-9160-40f4-96ae-61f8f40a0b1b
blueprint source: planner with report:
planning report for blueprint afb09faf-a586-4483-9289-04d4f1d8ba23:
* skipping noop zone image source check on sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6: all 6 zones are already from artifacts
* zone adds waiting on blockers
* zone adds and updates are blocked:
  - current target release generation (3) is lower than minimum required by blueprint (4)
  - sleds have mupdate override errors: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c
  - sleds have deployment units with image sources not set to Artifact:
    - sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c: 7 zones
    - sled d81c6a84-79b8-4958-ae41-ea46c9b19763: 6 zones

* zone updates waiting on zone add blockers



> blueprint-show latest
blueprint  afb09faf-a586-4483-9289-04d4f1d8ba23
parent:    c1a0d242-9160-40f4-96ae-61f8f40a0b1b

  sled: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c (active, config generation 5)

    host phase 2 contents:
    ------------------------
    slot   boot image source
    ------------------------
    A      current contents 
    B      current contents 


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-72c59873-31ff-4e36-8d76-ff834009349a   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crucible                                                              8c4fa711-1d5d-4e93-85f0-d17bff47b063   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/clickhouse                                                      3b66453b-7148-4c1b-84a9-499e43290ab4   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/external_dns                                                    841d5648-05f0-47b0-b446-92f6b60fe9a6   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/internal_dns                                                    3560dd69-3b23-4c69-807d-d673104cfc68   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone                                                            4829f422-aa31-41a8-ab73-95684ff1ef48   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_clickhouse_353b3b65-20f7-48c3-88f7-495bd5d31545        318fae85-abcb-4259-b1b6-ac96d193f7b7   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_crucible_bd354eef-d8a6-4165-9124-283fb5e46d77          2ad1875a-92ac-472f-8c26-593309f0e4da   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_crucible_pantry_ad6a3a03-8d0f-4504-99a4-cbf73d69b973   c31623de-c19b-4615-9f1d-5e1daa5d3bda   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_external_dns_6c3ae381-04f7-41ea-b0ac-74db387dbc3a      b46de15d-33e7-4cd0-aa7c-e7be2a61e71b   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_internal_dns_99e2f30b-3174-40bf-a78a-90da8abba8ca      09b9cc9b-3426-470b-a7bc-538f82dede03   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_nexus_466a9f29-62bf-4e63-924a-b9efdb86afec             775f9207-c42d-4af2-9186-27ffef67735e   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_ntp_62620961-fc4a-481e-968b-f5acbac0dc63               2db6b7c1-0f46-4ced-a3ad-48872793360e   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/debug                                                           93957ca0-9ed1-4e7b-8c34-2ce07a69541c   in service    100 GiB   none          gzip-9     


    omicron zones:
    ---------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source      disposition   underlay IP           
    ---------------------------------------------------------------------------------------------------------------
    clickhouse        353b3b65-20f7-48c3-88f7-495bd5d31545   install dataset   in service    fd00:1122:3344:102::23
    crucible          bd354eef-d8a6-4165-9124-283fb5e46d77   install dataset   in service    fd00:1122:3344:102::26
    crucible_pantry   ad6a3a03-8d0f-4504-99a4-cbf73d69b973   install dataset   in service    fd00:1122:3344:102::25
    external_dns      6c3ae381-04f7-41ea-b0ac-74db387dbc3a   install dataset   in service    fd00:1122:3344:102::24
    internal_dns      99e2f30b-3174-40bf-a78a-90da8abba8ca   install dataset   in service    fd00:1122:3344:1::1   
    internal_ntp      62620961-fc4a-481e-968b-f5acbac0dc63   install dataset   in service    fd00:1122:3344:102::21
    nexus             466a9f29-62bf-4e63-924a-b9efdb86afec   install dataset   in service    fd00:1122:3344:102::22



  sled: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 (active, config generation 7)

    host phase 2 contents:
    ------------------------
    slot   boot image source
    ------------------------
    A      current contents 
    B      current contents 


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-c6d33b64-fb96-4129-bab1-7878a06a5f9b   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crucible                                                              43931274-7fe8-4077-825d-dff2bc8efa58   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/external_dns                                                    a4c3032e-21fa-4d4a-b040-a7e3c572cf3c   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/internal_dns                                                    4f60b534-eaa3-40a1-b60f-bfdf147af478   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone                                                            4617d206-4330-4dfa-b9f3-f63a3db834f9   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_crucible_5199c033-4cf9-4ab6-8ae7-566bd7606363          ad41be71-6c15-4428-b510-20ceacde4fa6   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_crucible_pantry_ba4994a8-23f9-4b1a-a84f-a08d74591389   1bca7f71-5e42-4749-91ec-fa40793a3a9a   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_external_dns_803bfb63-c246-41db-b0da-d3b87ddfc63d      3ac089c9-9dec-465b-863a-188e80d71fb4   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_internal_dns_427ec88f-f467-42fa-9bbb-66a91a36103c      686c19cf-a0d7-45f6-866f-c564612b2664   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_nexus_0c71b3b2-6ceb-4e8f-b020-b08675e83038             793ac181-1b01-403c-850d-7f5c54bda6c9   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_ntp_6444f8a5-6465-4f0b-a549-1993c113569c               cdf3684f-a6cf-4449-b9ec-e696b2c663e2   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/debug                                                           248c6c10-1ac6-45de-bb55-ede36ca56bbd   in service    100 GiB   none          gzip-9     


    omicron zones:
    -----------------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source              disposition   underlay IP           
    -----------------------------------------------------------------------------------------------------------------------
    crucible          5199c033-4cf9-4ab6-8ae7-566bd7606363   artifact: version 1.0.0   in service    fd00:1122:3344:101::25
    crucible_pantry   ba4994a8-23f9-4b1a-a84f-a08d74591389   artifact: version 1.0.0   in service    fd00:1122:3344:101::24
    external_dns      803bfb63-c246-41db-b0da-d3b87ddfc63d   artifact: version 1.0.0   in service    fd00:1122:3344:101::23
    internal_dns      427ec88f-f467-42fa-9bbb-66a91a36103c   artifact: version 1.0.0   in service    fd00:1122:3344:2::1   
    internal_ntp      6444f8a5-6465-4f0b-a549-1993c113569c   artifact: version 1.0.0   in service    fd00:1122:3344:101::21
    nexus             0c71b3b2-6ceb-4e8f-b020-b08675e83038   artifact: version 1.0.0   in service    fd00:1122:3344:101::22



  sled: d81c6a84-79b8-4958-ae41-ea46c9b19763 (active, config generation 5)

    host phase 2 contents:
    ------------------------
    slot   boot image source
    ------------------------
    A      current contents 
    B      current contents 


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-4930954e-9ac7-4453-b63f-5ab97c389a99   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crucible                                                              090bd88d-0a43-4040-a832-b13ae721f74f   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/external_dns                                                    4da74a5b-6911-4cca-b624-b90c65530117   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/internal_dns                                                    252ac39f-b9e2-4697-8c07-3a833115d704   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone                                                            45cd9687-20be-4247-b62a-dfdacf324929   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_f55647d4-5500-4ad3-893a-df45bd50d622          1cb0a47a-59ac-4892-8e92-cf87b4290f96   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_pantry_75b220ba-a0f4-4872-8202-dc7c87f062d0   b1deff4b-51df-4a37-9043-afbd7c70a1cb   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_external_dns_f6ec9c67-946a-4da3-98d5-581f72ce8bf0      c65a9c1c-36dc-4ddb-8aac-ec3be8dbb209   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_internal_dns_ea5b4030-b52f-44b2-8d70-45f15f987d01      21fd4f3a-ec31-469b-87b1-087c343a2422   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_nexus_3eeb8d49-eb1a-43f8-bb64-c2338421c2c6             e009d8b8-4695-4322-b53f-f03f2744aef7   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_ntp_f10a4fb9-759f-4a65-b25e-5794ad2d07d8               41071985-1dfd-4ce5-8bc2-897161a8bce4   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/debug                                                           7a6a2058-ea78-49de-9730-cce5e28b4cfb   in service    100 GiB   none          gzip-9     


    omicron zones:
    ---------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source      disposition   underlay IP           
    ---------------------------------------------------------------------------------------------------------------
    crucible          f55647d4-5500-4ad3-893a-df45bd50d622   install dataset   in service    fd00:1122:3344:103::25
    crucible_pantry   75b220ba-a0f4-4872-8202-dc7c87f062d0   install dataset   in service    fd00:1122:3344:103::24
    external_dns      f6ec9c67-946a-4da3-98d5-581f72ce8bf0   install dataset   in service    fd00:1122:3344:103::23
    internal_dns      ea5b4030-b52f-44b2-8d70-45f15f987d01   install dataset   in service    fd00:1122:3344:3::1   
    internal_ntp      f10a4fb9-759f-4a65-b25e-5794ad2d07d8   install dataset   in service    fd00:1122:3344:103::21
    nexus             3eeb8d49-eb1a-43f8-bb64-c2338421c2c6   install dataset   in service    fd00:1122:3344:103::22


 COCKROACHDB SETTINGS:
    state fingerprint:::::::::::::::::   (none)
    cluster.preserve_downgrade_option:   (do not modify)

 OXIMETER SETTINGS:
    generation:   1
    read from::   SingleNode

 METADATA:
    created by:::::::::::::   reconfigurator-sim
    created at:::::::::::::   <REDACTED_TIMESTAMP>
    comment::::::::::::::::   (none)
    internal DNS version:::   1
    external DNS version:::   1
    target release min gen:   4
    nexus gen::::::::::::::   1

 PENDING MGS-MANAGED UPDATES: 0

blueprint source: planner with report:
planning report for blueprint afb09faf-a586-4483-9289-04d4f1d8ba23:
* skipping noop zone image source check on sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6: all 6 zones are already from artifacts
* zone adds waiting on blockers
* zone adds and updates are blocked:
  - current target release generation (3) is lower than minimum required by blueprint (4)
  - sleds have mupdate override errors: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c
  - sleds have deployment units with image sources not set to Artifact:
    - sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c: 7 zones
    - sled d81c6a84-79b8-4958-ae41-ea46c9b19763: 6 zones

* zone updates waiting on zone add blockers




> blueprint-diff latest
from: blueprint c1a0d242-9160-40f4-96ae-61f8f40a0b1b
to:   blueprint afb09faf-a586-4483-9289-04d4f1d8ba23

 MODIFIED SLEDS:

  sled d81c6a84-79b8-4958-ae41-ea46c9b19763 (active, config generation 4 -> 5):
-   will remove mupdate override:   1c0ce176-6dc8-4a90-adea-d4a8000751da -> (none)

    host phase 2 contents:
    ------------------------
    slot   boot image source
    ------------------------
    A      current contents 
    B      current contents 


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-4930954e-9ac7-4453-b63f-5ab97c389a99   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crucible                                                              090bd88d-0a43-4040-a832-b13ae721f74f   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/external_dns                                                    4da74a5b-6911-4cca-b624-b90c65530117   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/internal_dns                                                    252ac39f-b9e2-4697-8c07-3a833115d704   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone                                                            45cd9687-20be-4247-b62a-dfdacf324929   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_f55647d4-5500-4ad3-893a-df45bd50d622          1cb0a47a-59ac-4892-8e92-cf87b4290f96   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_pantry_75b220ba-a0f4-4872-8202-dc7c87f062d0   b1deff4b-51df-4a37-9043-afbd7c70a1cb   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_external_dns_f6ec9c67-946a-4da3-98d5-581f72ce8bf0      c65a9c1c-36dc-4ddb-8aac-ec3be8dbb209   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_internal_dns_ea5b4030-b52f-44b2-8d70-45f15f987d01      21fd4f3a-ec31-469b-87b1-087c343a2422   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_nexus_3eeb8d49-eb1a-43f8-bb64-c2338421c2c6             e009d8b8-4695-4322-b53f-f03f2744aef7   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_ntp_f10a4fb9-759f-4a65-b25e-5794ad2d07d8               41071985-1dfd-4ce5-8bc2-897161a8bce4   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/debug                                                           7a6a2058-ea78-49de-9730-cce5e28b4cfb   in service    100 GiB   none          gzip-9     


    omicron zones:
    ---------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source      disposition   underlay IP           
    ---------------------------------------------------------------------------------------------------------------
    crucible          f55647d4-5500-4ad3-893a-df45bd50d622   install dataset   in service    fd00:1122:3344:103::25
    crucible_pantry   75b220ba-a0f4-4872-8202-dc7c87f062d0   install dataset   in service    fd00:1122:3344:103::24
    external_dns      f6ec9c67-946a-4da3-98d5-581f72ce8bf0   install dataset   in service    fd00:1122:3344:103::23
    internal_dns      ea5b4030-b52f-44b2-8d70-45f15f987d01   install dataset   in service    fd00:1122:3344:3::1   
    internal_ntp      f10a4fb9-759f-4a65-b25e-5794ad2d07d8   install dataset   in service    fd00:1122:3344:103::21
    nexus             3eeb8d49-eb1a-43f8-bb64-c2338421c2c6   install dataset   in service    fd00:1122:3344:103::22


 COCKROACHDB SETTINGS:
    state fingerprint:::::::::::::::::   (none) (unchanged)
    cluster.preserve_downgrade_option:   (do not modify) (unchanged)

 METADATA:
    internal DNS version:::   1 (unchanged)
    external DNS version:::   1 (unchanged)
    target release min gen:   4 (unchanged)
    nexus gen::::::::::::::   1 (unchanged)

 OXIMETER SETTINGS:
    generation:   1 (unchanged)
    read from::   SingleNode (unchanged)


internal DNS:
  DNS zone: "control-plane.oxide.internal" (unchanged)
    unchanged names: 39 (records: 53)

external DNS:
  DNS zone: "oxide.example" (unchanged)
    unchanged names: 5 (records: 9)




> # Now set the target release -- at this point, we're still waiting on the
> # sled with the mupdate override error to be cleared.
> set target-release repo-2.0.0.zip
INFO extracting uploaded archive to <EXTRACTING_UPLOADED_ARCHIVE_TO_REDACTED>
INFO created directory to store extracted artifacts, path: <CREATED_DIRECTORY_TO_STORE_EXTRACTED_ARTIFACTS_PATH_REDACTED>
INFO added artifact, name: fake-gimlet-sp, kind: gimlet_sp, version: 2.0.0, hash: ac329e461b20cfdeaeb225456226b1dc3042e7254d238cc2ccf2903b18a69991, length: 731
INFO added artifact, name: fake-gimlet-rot, kind: gimlet_rot_image_a, version: 2.0.0, hash: 3ab29e804bcbf382370f9f071b2f0ed71e5bb6af8b01474fcc2a414caccfc9be, length: 782
INFO added artifact, name: fake-gimlet-rot, kind: gimlet_rot_image_b, version: 2.0.0, hash: 3ab29e804bcbf382370f9f071b2f0ed71e5bb6af8b01474fcc2a414caccfc9be, length: 782
INFO added artifact, name: fake-gimlet-rot-bootloader, kind: gimlet_rot_bootloader, version: 2.0.0, hash: 8f89bf8bc5f3271650ad72a26fc0d116c910161ca143731473a2b20fb82653cc, length: 800
INFO added artifact, name: fake-host, kind: gimlet_host_phase_1, version: 2.0.0, hash: 1eba0d79ea9d34558fb3f923a06614bd740649eeb0ca6e5086529dc60cd6f729, length: 524288
INFO added artifact, name: fake-host, kind: cosmo_host_phase_1, version: 2.0.0, hash: acde77f1a4ee5cf719841b21bb04fd652ddf61387bdbc95a67cc1006009ad611, length: 524288
INFO added artifact, name: fake-host, kind: host_phase_2, version: 2.0.0, hash: 9ff631b5b7229604ab7c5aae2ee4a34a64772736b332540d38077b3aea6952df, length: 1048576
INFO added artifact, name: fake-trampoline, kind: gimlet_trampoline_phase_1, version: non-semver, hash: 4c854917481a7bcb7b7c1e63833296b3ac1f8687aae5b950ece75a08cf27f35f, length: 524288
INFO added artifact, name: fake-trampoline, kind: cosmo_trampoline_phase_1, version: non-semver, hash: 6b4ace7210d67fa3a63b14e007d99fbcad1b4e27e78025c8e467c2341f67c2ba, length: 524288
INFO added artifact, name: fake-trampoline, kind: trampoline_phase_2, version: non-semver, hash: d7cdc8e1bfd15a830cfdc67868a7c05828090aefc42c8af44aa1104900d09fe5, length: 1048576
INFO added artifact, name: clickhouse, kind: zone, version: 2.0.0, hash: bb2d1ff02d11f72bc9049ae57f27536207519a1859d29f8d7a90ab3b44d56b08, length: 1687
INFO added artifact, name: clickhouse_keeper, kind: zone, version: 2.0.0, hash: 1eb9f24be68f13c274aa0ac9b863cec520dbfe762620c328431728d75bfd2198, length: 1691
INFO added artifact, name: clickhouse_server, kind: zone, version: 2.0.0, hash: 50fe271948672a9af1ba5f96c9d87ff2736fa72d78dfef598a79fa0cc8a00474, length: 1691
INFO added artifact, name: cockroachdb, kind: zone, version: 2.0.0, hash: ebc82bf181db864b78cb7e3ddedf7ab1dd8fe7b377b02846f3c27cf0387bb387, length: 1690
INFO added artifact, name: crucible-zone, kind: zone, version: 2.0.0, hash: 866f6a7c2e51c056fb722b5113e80181cc9cd8b712a0d3dbf1edc4ce29e5229e, length: 1691
INFO added artifact, name: crucible-pantry-zone, kind: zone, version: 2.0.0, hash: 3ff26dad96faa8f67251f5de40458b4f809d536bfe8572134da0e42c2fa12674, length: 1696
INFO added artifact, name: external-dns, kind: zone, version: 2.0.0, hash: f282c45771429f7bebf71f0cc668521066db57c6bb07fcfccdfb44825d3d930f, length: 1690
INFO added artifact, name: internal-dns, kind: zone, version: 2.0.0, hash: de30657a72b066b8ef1f56351a0a5d4d7000da0a62c4be9b2e949a107ca8a389, length: 1690
INFO added artifact, name: ntp, kind: zone, version: 2.0.0, hash: d76e26198daed69cdae04490d7477f8c842e0dbe37d463eac0d0a8d3fb803095, length: 1682
INFO added artifact, name: nexus, kind: zone, version: 2.0.0, hash: e9b7035f41848a987a798c15ac424cc91dd662b1af0920d58d8aa1ebad7467b6, length: 1683
INFO added artifact, name: oximeter, kind: zone, version: 2.0.0, hash: 9f4bc56a15d5fd943fdac94309994b8fd73aa2be1ec61faf44bfcf2356c9dc23, length: 1683
INFO added artifact, name: fake-psc-sp, kind: psc_sp, version: 2.0.0, hash: fe18e9b745f899f71dc9a718311d97c33f79eb579de09990b0cd2032574d9430, length: 729
INFO added artifact, name: fake-psc-rot, kind: psc_rot_image_a, version: 2.0.0, hash: be3fa620485936ebd70160b79d74f8f5709d9388c1add9b7e0fa7d283943e6a8, length: 776
INFO added artifact, name: fake-psc-rot, kind: psc_rot_image_b, version: 2.0.0, hash: be3fa620485936ebd70160b79d74f8f5709d9388c1add9b7e0fa7d283943e6a8, length: 776
INFO added artifact, name: fake-psc-rot-bootloader, kind: psc_rot_bootloader, version: 2.0.0, hash: ca4d5642e1be0acb535ca63804eec2f19e783c33e3a3ebffa843916accaafeb9, length: 799
INFO added artifact, name: fake-switch-sp, kind: switch_sp, version: 2.0.0, hash: f6c2b7e7b2fc19b17d3d604dbc16da1adcd6966db80fbbd2127f4a7fe123e71b, length: 746
INFO added artifact, name: fake-switch-rot, kind: switch_rot_image_a, version: 2.0.0, hash: ad32d98232043a39d076b5b90b506fad406767e0ce1298507e1733bc4e576740, length: 791
INFO added artifact, name: fake-switch-rot, kind: switch_rot_image_b, version: 2.0.0, hash: ad32d98232043a39d076b5b90b506fad406767e0ce1298507e1733bc4e576740, length: 791
INFO added artifact, name: fake-switch-rot-bootloader, kind: switch_rot_bootloader, version: non-semver-2, hash: ceae102fa428d81aa6c5d9e1c742fb9ca1091ce5b2797ed0bb14615cf678d342, length: 811
INFO added artifact, name: installinator_document, kind: installinator_document, version: 2.0.0, hash: 13bb3382a02d1f908137cfa356f1434995de15539341a6d8f52a8f2614c52d6c, length: 367
set target release based on repo-2.0.0.zip

> blueprint-plan latest latest
ERRO error getting mupdate override info for sled, not altering blueprint override, but cleared pending host phase 2 updates if any, phase: do_plan_mupdate_override, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, message: reconfigurator-cli simulated mupdate-override error, bp_override: None, prev_host_phase_2: 
  - host phase 2 slot A: current contents (unchanged)
  - host phase 2 slot B: current contents (unchanged)

INFO no previous MGS update found, so no action taken as part of updating blueprint because there was an error obtaining mupdate override info, phase: do_plan_mupdate_override, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c
WARN skipped noop image source check on sled, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, reason: error retrieving mupdate override information: reconfigurator-cli simulated mupdate-override error
INFO performed noop zone image source checks on sled, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, num_total: 6, num_already_artifact: 6, num_eligible: 0, num_ineligible: 0
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, slot: b, expected_hash: 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
INFO performed noop zone image source checks on sled, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, num_total: 6, num_already_artifact: 0, num_eligible: 6, num_ineligible: 0
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, slot: b, expected_hash: 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
generated blueprint ce365dff-2cdb-4f35-a186-b15e20e1e700 based on parent blueprint afb09faf-a586-4483-9289-04d4f1d8ba23
blueprint source: planner with report:
planning report for blueprint ce365dff-2cdb-4f35-a186-b15e20e1e700:
* skipping noop zone image source check on sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6: all 6 zones are already from artifacts
* noop converting 6/6 install-dataset zones to artifact store on sled d81c6a84-79b8-4958-ae41-ea46c9b19763
* zone adds waiting on blockers
* zone adds and updates are blocked:
  - sleds have mupdate override errors: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c
  - sleds have deployment units with image sources not set to Artifact:
    - sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c: 7 zones

* zone updates waiting on zone add blockers



> blueprint-show latest
blueprint  ce365dff-2cdb-4f35-a186-b15e20e1e700
parent:    afb09faf-a586-4483-9289-04d4f1d8ba23

  sled: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c (active, config generation 5)

    host phase 2 contents:
    ------------------------
    slot   boot image source
    ------------------------
    A      current contents 
    B      current contents 


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-72c59873-31ff-4e36-8d76-ff834009349a   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crucible                                                              8c4fa711-1d5d-4e93-85f0-d17bff47b063   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/clickhouse                                                      3b66453b-7148-4c1b-84a9-499e43290ab4   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/external_dns                                                    841d5648-05f0-47b0-b446-92f6b60fe9a6   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/internal_dns                                                    3560dd69-3b23-4c69-807d-d673104cfc68   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone                                                            4829f422-aa31-41a8-ab73-95684ff1ef48   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_clickhouse_353b3b65-20f7-48c3-88f7-495bd5d31545        318fae85-abcb-4259-b1b6-ac96d193f7b7   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_crucible_bd354eef-d8a6-4165-9124-283fb5e46d77          2ad1875a-92ac-472f-8c26-593309f0e4da   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_crucible_pantry_ad6a3a03-8d0f-4504-99a4-cbf73d69b973   c31623de-c19b-4615-9f1d-5e1daa5d3bda   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_external_dns_6c3ae381-04f7-41ea-b0ac-74db387dbc3a      b46de15d-33e7-4cd0-aa7c-e7be2a61e71b   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_internal_dns_99e2f30b-3174-40bf-a78a-90da8abba8ca      09b9cc9b-3426-470b-a7bc-538f82dede03   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_nexus_466a9f29-62bf-4e63-924a-b9efdb86afec             775f9207-c42d-4af2-9186-27ffef67735e   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_ntp_62620961-fc4a-481e-968b-f5acbac0dc63               2db6b7c1-0f46-4ced-a3ad-48872793360e   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/debug                                                           93957ca0-9ed1-4e7b-8c34-2ce07a69541c   in service    100 GiB   none          gzip-9     


    omicron zones:
    ---------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source      disposition   underlay IP           
    ---------------------------------------------------------------------------------------------------------------
    clickhouse        353b3b65-20f7-48c3-88f7-495bd5d31545   install dataset   in service    fd00:1122:3344:102::23
    crucible          bd354eef-d8a6-4165-9124-283fb5e46d77   install dataset   in service    fd00:1122:3344:102::26
    crucible_pantry   ad6a3a03-8d0f-4504-99a4-cbf73d69b973   install dataset   in service    fd00:1122:3344:102::25
    external_dns      6c3ae381-04f7-41ea-b0ac-74db387dbc3a   install dataset   in service    fd00:1122:3344:102::24
    internal_dns      99e2f30b-3174-40bf-a78a-90da8abba8ca   install dataset   in service    fd00:1122:3344:1::1   
    internal_ntp      62620961-fc4a-481e-968b-f5acbac0dc63   install dataset   in service    fd00:1122:3344:102::21
    nexus             466a9f29-62bf-4e63-924a-b9efdb86afec   install dataset   in service    fd00:1122:3344:102::22



  sled: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 (active, config generation 7)

    host phase 2 contents:
    ------------------------
    slot   boot image source
    ------------------------
    A      current contents 
    B      current contents 


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-c6d33b64-fb96-4129-bab1-7878a06a5f9b   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crucible                                                              43931274-7fe8-4077-825d-dff2bc8efa58   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/external_dns                                                    a4c3032e-21fa-4d4a-b040-a7e3c572cf3c   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/internal_dns                                                    4f60b534-eaa3-40a1-b60f-bfdf147af478   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone                                                            4617d206-4330-4dfa-b9f3-f63a3db834f9   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_crucible_5199c033-4cf9-4ab6-8ae7-566bd7606363          ad41be71-6c15-4428-b510-20ceacde4fa6   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_crucible_pantry_ba4994a8-23f9-4b1a-a84f-a08d74591389   1bca7f71-5e42-4749-91ec-fa40793a3a9a   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_external_dns_803bfb63-c246-41db-b0da-d3b87ddfc63d      3ac089c9-9dec-465b-863a-188e80d71fb4   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_internal_dns_427ec88f-f467-42fa-9bbb-66a91a36103c      686c19cf-a0d7-45f6-866f-c564612b2664   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_nexus_0c71b3b2-6ceb-4e8f-b020-b08675e83038             793ac181-1b01-403c-850d-7f5c54bda6c9   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_ntp_6444f8a5-6465-4f0b-a549-1993c113569c               cdf3684f-a6cf-4449-b9ec-e696b2c663e2   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/debug                                                           248c6c10-1ac6-45de-bb55-ede36ca56bbd   in service    100 GiB   none          gzip-9     


    omicron zones:
    -----------------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source              disposition   underlay IP           
    -----------------------------------------------------------------------------------------------------------------------
    crucible          5199c033-4cf9-4ab6-8ae7-566bd7606363   artifact: version 1.0.0   in service    fd00:1122:3344:101::25
    crucible_pantry   ba4994a8-23f9-4b1a-a84f-a08d74591389   artifact: version 1.0.0   in service    fd00:1122:3344:101::24
    external_dns      803bfb63-c246-41db-b0da-d3b87ddfc63d   artifact: version 1.0.0   in service    fd00:1122:3344:101::23
    internal_dns      427ec88f-f467-42fa-9bbb-66a91a36103c   artifact: version 1.0.0   in service    fd00:1122:3344:2::1   
    internal_ntp      6444f8a5-6465-4f0b-a549-1993c113569c   artifact: version 1.0.0   in service    fd00:1122:3344:101::21
    nexus             0c71b3b2-6ceb-4e8f-b020-b08675e83038   artifact: version 1.0.0   in service    fd00:1122:3344:101::22



  sled: d81c6a84-79b8-4958-ae41-ea46c9b19763 (active, config generation 6)

    host phase 2 contents:
    ------------------------
    slot   boot image source
    ------------------------
    A      current contents 
    B      current contents 


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-4930954e-9ac7-4453-b63f-5ab97c389a99   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crucible                                                              090bd88d-0a43-4040-a832-b13ae721f74f   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/external_dns                                                    4da74a5b-6911-4cca-b624-b90c65530117   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/internal_dns                                                    252ac39f-b9e2-4697-8c07-3a833115d704   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone                                                            45cd9687-20be-4247-b62a-dfdacf324929   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_f55647d4-5500-4ad3-893a-df45bd50d622          1cb0a47a-59ac-4892-8e92-cf87b4290f96   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_pantry_75b220ba-a0f4-4872-8202-dc7c87f062d0   b1deff4b-51df-4a37-9043-afbd7c70a1cb   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_external_dns_f6ec9c67-946a-4da3-98d5-581f72ce8bf0      c65a9c1c-36dc-4ddb-8aac-ec3be8dbb209   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_internal_dns_ea5b4030-b52f-44b2-8d70-45f15f987d01      21fd4f3a-ec31-469b-87b1-087c343a2422   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_nexus_3eeb8d49-eb1a-43f8-bb64-c2338421c2c6             e009d8b8-4695-4322-b53f-f03f2744aef7   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_ntp_f10a4fb9-759f-4a65-b25e-5794ad2d07d8               41071985-1dfd-4ce5-8bc2-897161a8bce4   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/debug                                                           7a6a2058-ea78-49de-9730-cce5e28b4cfb   in service    100 GiB   none          gzip-9     


    omicron zones:
    -----------------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source              disposition   underlay IP           
    -----------------------------------------------------------------------------------------------------------------------
    crucible          f55647d4-5500-4ad3-893a-df45bd50d622   artifact: version 2.0.0   in service    fd00:1122:3344:103::25
    crucible_pantry   75b220ba-a0f4-4872-8202-dc7c87f062d0   artifact: version 2.0.0   in service    fd00:1122:3344:103::24
    external_dns      f6ec9c67-946a-4da3-98d5-581f72ce8bf0   artifact: version 2.0.0   in service    fd00:1122:3344:103::23
    internal_dns      ea5b4030-b52f-44b2-8d70-45f15f987d01   artifact: version 2.0.0   in service    fd00:1122:3344:3::1   
    internal_ntp      f10a4fb9-759f-4a65-b25e-5794ad2d07d8   artifact: version 2.0.0   in service    fd00:1122:3344:103::21
    nexus             3eeb8d49-eb1a-43f8-bb64-c2338421c2c6   artifact: version 2.0.0   in service    fd00:1122:3344:103::22


 COCKROACHDB SETTINGS:
    state fingerprint:::::::::::::::::   (none)
    cluster.preserve_downgrade_option:   (do not modify)

 OXIMETER SETTINGS:
    generation:   1
    read from::   SingleNode

 METADATA:
    created by:::::::::::::   reconfigurator-sim
    created at:::::::::::::   <REDACTED_TIMESTAMP>
    comment::::::::::::::::   sled d81c6a84-79b8-4958-ae41-ea46c9b19763: performed 6 noop zone image source updates
    internal DNS version:::   1
    external DNS version:::   1
    target release min gen:   4
    nexus gen::::::::::::::   1

 PENDING MGS-MANAGED UPDATES: 0

blueprint source: planner with report:
planning report for blueprint ce365dff-2cdb-4f35-a186-b15e20e1e700:
* skipping noop zone image source check on sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6: all 6 zones are already from artifacts
* noop converting 6/6 install-dataset zones to artifact store on sled d81c6a84-79b8-4958-ae41-ea46c9b19763
* zone adds waiting on blockers
* zone adds and updates are blocked:
  - sleds have mupdate override errors: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c
  - sleds have deployment units with image sources not set to Artifact:
    - sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c: 7 zones

* zone updates waiting on zone add blockers




> blueprint-diff latest
from: blueprint afb09faf-a586-4483-9289-04d4f1d8ba23
to:   blueprint ce365dff-2cdb-4f35-a186-b15e20e1e700

 MODIFIED SLEDS:

  sled d81c6a84-79b8-4958-ae41-ea46c9b19763 (active, config generation 5 -> 6):

    host phase 2 contents:
    ------------------------
    slot   boot image source
    ------------------------
    A      current contents 
    B      current contents 


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-4930954e-9ac7-4453-b63f-5ab97c389a99   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crucible                                                              090bd88d-0a43-4040-a832-b13ae721f74f   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/external_dns                                                    4da74a5b-6911-4cca-b624-b90c65530117   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/internal_dns                                                    252ac39f-b9e2-4697-8c07-3a833115d704   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone                                                            45cd9687-20be-4247-b62a-dfdacf324929   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_f55647d4-5500-4ad3-893a-df45bd50d622          1cb0a47a-59ac-4892-8e92-cf87b4290f96   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_pantry_75b220ba-a0f4-4872-8202-dc7c87f062d0   b1deff4b-51df-4a37-9043-afbd7c70a1cb   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_external_dns_f6ec9c67-946a-4da3-98d5-581f72ce8bf0      c65a9c1c-36dc-4ddb-8aac-ec3be8dbb209   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_internal_dns_ea5b4030-b52f-44b2-8d70-45f15f987d01      21fd4f3a-ec31-469b-87b1-087c343a2422   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_nexus_3eeb8d49-eb1a-43f8-bb64-c2338421c2c6             e009d8b8-4695-4322-b53f-f03f2744aef7   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_ntp_f10a4fb9-759f-4a65-b25e-5794ad2d07d8               41071985-1dfd-4ce5-8bc2-897161a8bce4   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/debug                                                           7a6a2058-ea78-49de-9730-cce5e28b4cfb   in service    100 GiB   none          gzip-9     


    omicron zones:
    -------------------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source                disposition   underlay IP           
    -------------------------------------------------------------------------------------------------------------------------
*   crucible          f55647d4-5500-4ad3-893a-df45bd50d622   - install dataset           in service    fd00:1122:3344:103::25
     └─                                                      + artifact: version 2.0.0                                       
*   crucible_pantry   75b220ba-a0f4-4872-8202-dc7c87f062d0   - install dataset           in service    fd00:1122:3344:103::24
     └─                                                      + artifact: version 2.0.0                                       
*   external_dns      f6ec9c67-946a-4da3-98d5-581f72ce8bf0   - install dataset           in service    fd00:1122:3344:103::23
     └─                                                      + artifact: version 2.0.0                                       
*   internal_dns      ea5b4030-b52f-44b2-8d70-45f15f987d01   - install dataset           in service    fd00:1122:3344:3::1   
     └─                                                      + artifact: version 2.0.0                                       
*   internal_ntp      f10a4fb9-759f-4a65-b25e-5794ad2d07d8   - install dataset           in service    fd00:1122:3344:103::21
     └─                                                      + artifact: version 2.0.0                                       
*   nexus             3eeb8d49-eb1a-43f8-bb64-c2338421c2c6   - install dataset           in service    fd00:1122:3344:103::22
     └─                                                      + artifact: version 2.0.0                                       


 COCKROACHDB SETTINGS:
    state fingerprint:::::::::::::::::   (none) (unchanged)
    cluster.preserve_downgrade_option:   (do not modify) (unchanged)

 METADATA:
    internal DNS version:::   1 (unchanged)
    external DNS version:::   1 (unchanged)
    target release min gen:   4 (unchanged)
    nexus gen::::::::::::::   1 (unchanged)

 OXIMETER SETTINGS:
    generation:   1 (unchanged)
    read from::   SingleNode (unchanged)


internal DNS:
  DNS zone: "control-plane.oxide.internal" (unchanged)
    unchanged names: 39 (records: 53)

external DNS:
  DNS zone: "oxide.example" (unchanged)
    unchanged names: 5 (records: 9)




> # Now clear the mupdate override error. At this point, we're *still* blocked
> # on serial1's install dataset not being known (so cannot be noop converted).
> sled-set serial1 mupdate-override unset
set sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c mupdate override: error -> unset

> inventory-generate
generated inventory collection 0b5efbb3-0b1b-4bbf-b7d8-a2d6fca074c6 from configured sleds

> blueprint-plan latest latest
INFO performed noop zone image source checks on sled, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, num_total: 7, num_already_artifact: 0, num_eligible: 0, num_ineligible: 7
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, slot: b, expected_hash: 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
INFO performed noop zone image source checks on sled, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, num_total: 6, num_already_artifact: 6, num_eligible: 0, num_ineligible: 0
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, slot: b, expected_hash: 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
INFO performed noop zone image source checks on sled, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, num_total: 6, num_already_artifact: 6, num_eligible: 0, num_ineligible: 0
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, slot: b, expected_hash: 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
generated blueprint 8f2d1f39-7c88-4701-aa43-56bf281b28c1 based on parent blueprint ce365dff-2cdb-4f35-a186-b15e20e1e700
blueprint source: planner with report:
planning report for blueprint 8f2d1f39-7c88-4701-aa43-56bf281b28c1:
* skipping noop zone image source check on sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6: all 6 zones are already from artifacts
* skipping noop zone image source check on sled d81c6a84-79b8-4958-ae41-ea46c9b19763: all 6 zones are already from artifacts
* zone adds waiting on blockers
* zone adds and updates are blocked:
  - sleds have deployment units with image sources not set to Artifact:
    - sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c: 7 zones

* zone updates waiting on zone add blockers



> blueprint-diff latest
from: blueprint ce365dff-2cdb-4f35-a186-b15e20e1e700
to:   blueprint 8f2d1f39-7c88-4701-aa43-56bf281b28c1

 COCKROACHDB SETTINGS:
    state fingerprint:::::::::::::::::   (none) (unchanged)
    cluster.preserve_downgrade_option:   (do not modify) (unchanged)

 METADATA:
    internal DNS version:::   1 (unchanged)
    external DNS version:::   1 (unchanged)
    target release min gen:   4 (unchanged)
    nexus gen::::::::::::::   1 (unchanged)

 OXIMETER SETTINGS:
    generation:   1 (unchanged)
    read from::   SingleNode (unchanged)


internal DNS:
  DNS zone: "control-plane.oxide.internal" (unchanged)
    unchanged names: 39 (records: 53)

external DNS:
  DNS zone: "oxide.example" (unchanged)
    unchanged names: 5 (records: 9)




> # Update serial1's install dataset. Finally the planner is unblocked. (Note that
> # we do noop conversions of serial1 to Artifact and the unblocking of further
> # steps within the same blueprint. In other words, the code that considers
> # whether add/update are blocked takes into account noop conversions.)
> sled-update-install-dataset serial1 --to-target-release
sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c: install dataset updated: to target release (system version 2.0.0)

> inventory-generate
generated inventory collection 78f72e8d-46a9-40a9-8618-602f54454d80 from configured sleds


> # This will attempt to update the RoT bootloader on the first sled.
> blueprint-plan latest latest
INFO performed noop zone image source checks on sled, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, num_total: 7, num_already_artifact: 0, num_eligible: 7, num_ineligible: 0
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, slot: b, expected_hash: 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
INFO performed noop zone image source checks on sled, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, num_total: 6, num_already_artifact: 6, num_eligible: 0, num_ineligible: 0
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, slot: b, expected_hash: 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
INFO performed noop zone image source checks on sled, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, num_total: 6, num_already_artifact: 6, num_eligible: 0, num_ineligible: 0
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, slot: b, expected_hash: 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
INFO configuring MGS-driven update, artifact_version: 2.0.0, artifact_hash: 8f89bf8bc5f3271650ad72a26fc0d116c910161ca143731473a2b20fb82653cc, expected_stage0_next_version: NoValidVersion, expected_stage0_version: 0.0.1, component: rot_bootloader, sp_slot: 0, sp_type: Sled, serial_number: serial0, part_number: model0
INFO reached maximum number of pending MGS-driven updates, max: 1
generated blueprint 12d602a6-5ab4-487a-b94e-eb30cdf30300 based on parent blueprint 8f2d1f39-7c88-4701-aa43-56bf281b28c1
blueprint source: planner with report:
planning report for blueprint 12d602a6-5ab4-487a-b94e-eb30cdf30300:
* skipping noop zone image source check on sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6: all 6 zones are already from artifacts
* skipping noop zone image source check on sled d81c6a84-79b8-4958-ae41-ea46c9b19763: all 6 zones are already from artifacts
* noop converting 7/7 install-dataset zones to artifact store on sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c
* 1 pending MGS update:
  * model0:serial0: RotBootloader(PendingMgsUpdateRotBootloaderDetails { expected_stage0_version: ArtifactVersion("0.0.1"), expected_stage0_next_version: NoValidVersion })
* zone updates waiting on pending MGS updates (RoT / SP / Host OS / etc.)



> blueprint-show latest
blueprint  12d602a6-5ab4-487a-b94e-eb30cdf30300
parent:    8f2d1f39-7c88-4701-aa43-56bf281b28c1

  sled: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c (active, config generation 6)

    host phase 2 contents:
    ------------------------
    slot   boot image source
    ------------------------
    A      current contents 
    B      current contents 


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-72c59873-31ff-4e36-8d76-ff834009349a   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crucible                                                              8c4fa711-1d5d-4e93-85f0-d17bff47b063   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/clickhouse                                                      3b66453b-7148-4c1b-84a9-499e43290ab4   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/external_dns                                                    841d5648-05f0-47b0-b446-92f6b60fe9a6   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/internal_dns                                                    3560dd69-3b23-4c69-807d-d673104cfc68   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone                                                            4829f422-aa31-41a8-ab73-95684ff1ef48   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_clickhouse_353b3b65-20f7-48c3-88f7-495bd5d31545        318fae85-abcb-4259-b1b6-ac96d193f7b7   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_crucible_bd354eef-d8a6-4165-9124-283fb5e46d77          2ad1875a-92ac-472f-8c26-593309f0e4da   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_crucible_pantry_ad6a3a03-8d0f-4504-99a4-cbf73d69b973   c31623de-c19b-4615-9f1d-5e1daa5d3bda   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_external_dns_6c3ae381-04f7-41ea-b0ac-74db387dbc3a      b46de15d-33e7-4cd0-aa7c-e7be2a61e71b   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_internal_dns_99e2f30b-3174-40bf-a78a-90da8abba8ca      09b9cc9b-3426-470b-a7bc-538f82dede03   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_nexus_466a9f29-62bf-4e63-924a-b9efdb86afec             775f9207-c42d-4af2-9186-27ffef67735e   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_ntp_62620961-fc4a-481e-968b-f5acbac0dc63               2db6b7c1-0f46-4ced-a3ad-48872793360e   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/debug                                                           93957ca0-9ed1-4e7b-8c34-2ce07a69541c   in service    100 GiB   none          gzip-9     


    omicron zones:
    -----------------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source              disposition   underlay IP           
    -----------------------------------------------------------------------------------------------------------------------
    clickhouse        353b3b65-20f7-48c3-88f7-495bd5d31545   artifact: version 2.0.0   in service    fd00:1122:3344:102::23
    crucible          bd354eef-d8a6-4165-9124-283fb5e46d77   artifact: version 2.0.0   in service    fd00:1122:3344:102::26
    crucible_pantry   ad6a3a03-8d0f-4504-99a4-cbf73d69b973   artifact: version 2.0.0   in service    fd00:1122:3344:102::25
    external_dns      6c3ae381-04f7-41ea-b0ac-74db387dbc3a   artifact: version 2.0.0   in service    fd00:1122:3344:102::24
    internal_dns      99e2f30b-3174-40bf-a78a-90da8abba8ca   artifact: version 2.0.0   in service    fd00:1122:3344:1::1   
    internal_ntp      62620961-fc4a-481e-968b-f5acbac0dc63   artifact: version 2.0.0   in service    fd00:1122:3344:102::21
    nexus             466a9f29-62bf-4e63-924a-b9efdb86afec   artifact: version 2.0.0   in service    fd00:1122:3344:102::22



  sled: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 (active, config generation 7)

    host phase 2 contents:
    ------------------------
    slot   boot image source
    ------------------------
    A      current contents 
    B      current contents 


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-c6d33b64-fb96-4129-bab1-7878a06a5f9b   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crucible                                                              43931274-7fe8-4077-825d-dff2bc8efa58   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/external_dns                                                    a4c3032e-21fa-4d4a-b040-a7e3c572cf3c   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/internal_dns                                                    4f60b534-eaa3-40a1-b60f-bfdf147af478   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone                                                            4617d206-4330-4dfa-b9f3-f63a3db834f9   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_crucible_5199c033-4cf9-4ab6-8ae7-566bd7606363          ad41be71-6c15-4428-b510-20ceacde4fa6   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_crucible_pantry_ba4994a8-23f9-4b1a-a84f-a08d74591389   1bca7f71-5e42-4749-91ec-fa40793a3a9a   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_external_dns_803bfb63-c246-41db-b0da-d3b87ddfc63d      3ac089c9-9dec-465b-863a-188e80d71fb4   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_internal_dns_427ec88f-f467-42fa-9bbb-66a91a36103c      686c19cf-a0d7-45f6-866f-c564612b2664   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_nexus_0c71b3b2-6ceb-4e8f-b020-b08675e83038             793ac181-1b01-403c-850d-7f5c54bda6c9   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_ntp_6444f8a5-6465-4f0b-a549-1993c113569c               cdf3684f-a6cf-4449-b9ec-e696b2c663e2   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/debug                                                           248c6c10-1ac6-45de-bb55-ede36ca56bbd   in service    100 GiB   none          gzip-9     


    omicron zones:
    -----------------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source              disposition   underlay IP           
    -----------------------------------------------------------------------------------------------------------------------
    crucible          5199c033-4cf9-4ab6-8ae7-566bd7606363   artifact: version 1.0.0   in service    fd00:1122:3344:101::25
    crucible_pantry   ba4994a8-23f9-4b1a-a84f-a08d74591389   artifact: version 1.0.0   in service    fd00:1122:3344:101::24
    external_dns      803bfb63-c246-41db-b0da-d3b87ddfc63d   artifact: version 1.0.0   in service    fd00:1122:3344:101::23
    internal_dns      427ec88f-f467-42fa-9bbb-66a91a36103c   artifact: version 1.0.0   in service    fd00:1122:3344:2::1   
    internal_ntp      6444f8a5-6465-4f0b-a549-1993c113569c   artifact: version 1.0.0   in service    fd00:1122:3344:101::21
    nexus             0c71b3b2-6ceb-4e8f-b020-b08675e83038   artifact: version 1.0.0   in service    fd00:1122:3344:101::22



  sled: d81c6a84-79b8-4958-ae41-ea46c9b19763 (active, config generation 6)

    host phase 2 contents:
    ------------------------
    slot   boot image source
    ------------------------
    A      current contents 
    B      current contents 


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-4930954e-9ac7-4453-b63f-5ab97c389a99   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crucible                                                              090bd88d-0a43-4040-a832-b13ae721f74f   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/external_dns                                                    4da74a5b-6911-4cca-b624-b90c65530117   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/internal_dns                                                    252ac39f-b9e2-4697-8c07-3a833115d704   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone                                                            45cd9687-20be-4247-b62a-dfdacf324929   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_f55647d4-5500-4ad3-893a-df45bd50d622          1cb0a47a-59ac-4892-8e92-cf87b4290f96   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_pantry_75b220ba-a0f4-4872-8202-dc7c87f062d0   b1deff4b-51df-4a37-9043-afbd7c70a1cb   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_external_dns_f6ec9c67-946a-4da3-98d5-581f72ce8bf0      c65a9c1c-36dc-4ddb-8aac-ec3be8dbb209   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_internal_dns_ea5b4030-b52f-44b2-8d70-45f15f987d01      21fd4f3a-ec31-469b-87b1-087c343a2422   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_nexus_3eeb8d49-eb1a-43f8-bb64-c2338421c2c6             e009d8b8-4695-4322-b53f-f03f2744aef7   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_ntp_f10a4fb9-759f-4a65-b25e-5794ad2d07d8               41071985-1dfd-4ce5-8bc2-897161a8bce4   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/debug                                                           7a6a2058-ea78-49de-9730-cce5e28b4cfb   in service    100 GiB   none          gzip-9     


    omicron zones:
    -----------------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source              disposition   underlay IP           
    -----------------------------------------------------------------------------------------------------------------------
    crucible          f55647d4-5500-4ad3-893a-df45bd50d622   artifact: version 2.0.0   in service    fd00:1122:3344:103::25
    crucible_pantry   75b220ba-a0f4-4872-8202-dc7c87f062d0   artifact: version 2.0.0   in service    fd00:1122:3344:103::24
    external_dns      f6ec9c67-946a-4da3-98d5-581f72ce8bf0   artifact: version 2.0.0   in service    fd00:1122:3344:103::23
    internal_dns      ea5b4030-b52f-44b2-8d70-45f15f987d01   artifact: version 2.0.0   in service    fd00:1122:3344:3::1   
    internal_ntp      f10a4fb9-759f-4a65-b25e-5794ad2d07d8   artifact: version 2.0.0   in service    fd00:1122:3344:103::21
    nexus             3eeb8d49-eb1a-43f8-bb64-c2338421c2c6   artifact: version 2.0.0   in service    fd00:1122:3344:103::22


 COCKROACHDB SETTINGS:
    state fingerprint:::::::::::::::::   (none)
    cluster.preserve_downgrade_option:   (do not modify)

 OXIMETER SETTINGS:
    generation:   1
    read from::   SingleNode

 METADATA:
    created by:::::::::::::   reconfigurator-sim
    created at:::::::::::::   <REDACTED_TIMESTAMP>
    comment::::::::::::::::   update Sled 0 (serial0) RoT bootloader to 2.0.0, sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c: performed 7 noop zone image source updates
    internal DNS version:::   1
    external DNS version:::   1
    target release min gen:   4
    nexus gen::::::::::::::   1

 PENDING MGS-MANAGED UPDATES: 1
    Pending MGS-managed updates (all baseboards):
    --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    sp_type   slot   part_number   serial_number   artifact_hash                                                      artifact_version   details                                                                                                                                                
    --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    sled      0      model0        serial0         8f89bf8bc5f3271650ad72a26fc0d116c910161ca143731473a2b20fb82653cc   2.0.0              RotBootloader(PendingMgsUpdateRotBootloaderDetails { expected_stage0_version: ArtifactVersion("0.0.1"), expected_stage0_next_version: NoValidVersion })


blueprint source: planner with report:
planning report for blueprint 12d602a6-5ab4-487a-b94e-eb30cdf30300:
* skipping noop zone image source check on sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6: all 6 zones are already from artifacts
* skipping noop zone image source check on sled d81c6a84-79b8-4958-ae41-ea46c9b19763: all 6 zones are already from artifacts
* noop converting 7/7 install-dataset zones to artifact store on sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c
* 1 pending MGS update:
  * model0:serial0: RotBootloader(PendingMgsUpdateRotBootloaderDetails { expected_stage0_version: ArtifactVersion("0.0.1"), expected_stage0_next_version: NoValidVersion })
* zone updates waiting on pending MGS updates (RoT / SP / Host OS / etc.)




> blueprint-diff latest
from: blueprint 8f2d1f39-7c88-4701-aa43-56bf281b28c1
to:   blueprint 12d602a6-5ab4-487a-b94e-eb30cdf30300

 MODIFIED SLEDS:

  sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c (active, config generation 5 -> 6):

    host phase 2 contents:
    ------------------------
    slot   boot image source
    ------------------------
    A      current contents 
    B      current contents 


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-72c59873-31ff-4e36-8d76-ff834009349a   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crucible                                                              8c4fa711-1d5d-4e93-85f0-d17bff47b063   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/clickhouse                                                      3b66453b-7148-4c1b-84a9-499e43290ab4   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/external_dns                                                    841d5648-05f0-47b0-b446-92f6b60fe9a6   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/internal_dns                                                    3560dd69-3b23-4c69-807d-d673104cfc68   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone                                                            4829f422-aa31-41a8-ab73-95684ff1ef48   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_clickhouse_353b3b65-20f7-48c3-88f7-495bd5d31545        318fae85-abcb-4259-b1b6-ac96d193f7b7   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_crucible_bd354eef-d8a6-4165-9124-283fb5e46d77          2ad1875a-92ac-472f-8c26-593309f0e4da   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_crucible_pantry_ad6a3a03-8d0f-4504-99a4-cbf73d69b973   c31623de-c19b-4615-9f1d-5e1daa5d3bda   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_external_dns_6c3ae381-04f7-41ea-b0ac-74db387dbc3a      b46de15d-33e7-4cd0-aa7c-e7be2a61e71b   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_internal_dns_99e2f30b-3174-40bf-a78a-90da8abba8ca      09b9cc9b-3426-470b-a7bc-538f82dede03   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_nexus_466a9f29-62bf-4e63-924a-b9efdb86afec             775f9207-c42d-4af2-9186-27ffef67735e   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_ntp_62620961-fc4a-481e-968b-f5acbac0dc63               2db6b7c1-0f46-4ced-a3ad-48872793360e   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/debug                                                           93957ca0-9ed1-4e7b-8c34-2ce07a69541c   in service    100 GiB   none          gzip-9     


    omicron zones:
    -------------------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source                disposition   underlay IP           
    -------------------------------------------------------------------------------------------------------------------------
*   clickhouse        353b3b65-20f7-48c3-88f7-495bd5d31545   - install dataset           in service    fd00:1122:3344:102::23
     └─                                                      + artifact: version 2.0.0                                       
*   crucible          bd354eef-d8a6-4165-9124-283fb5e46d77   - install dataset           in service    fd00:1122:3344:102::26
     └─                                                      + artifact: version 2.0.0                                       
*   crucible_pantry   ad6a3a03-8d0f-4504-99a4-cbf73d69b973   - install dataset           in service    fd00:1122:3344:102::25
     └─                                                      + artifact: version 2.0.0                                       
*   external_dns      6c3ae381-04f7-41ea-b0ac-74db387dbc3a   - install dataset           in service    fd00:1122:3344:102::24
     └─                                                      + artifact: version 2.0.0                                       
*   internal_dns      99e2f30b-3174-40bf-a78a-90da8abba8ca   - install dataset           in service    fd00:1122:3344:1::1   
     └─                                                      + artifact: version 2.0.0                                       
*   internal_ntp      62620961-fc4a-481e-968b-f5acbac0dc63   - install dataset           in service    fd00:1122:3344:102::21
     └─                                                      + artifact: version 2.0.0                                       
*   nexus             466a9f29-62bf-4e63-924a-b9efdb86afec   - install dataset           in service    fd00:1122:3344:102::22
     └─                                                      + artifact: version 2.0.0                                       


 COCKROACHDB SETTINGS:
    state fingerprint:::::::::::::::::   (none) (unchanged)
    cluster.preserve_downgrade_option:   (do not modify) (unchanged)

 METADATA:
    internal DNS version:::   1 (unchanged)
    external DNS version:::   1 (unchanged)
    target release min gen:   4 (unchanged)
    nexus gen::::::::::::::   1 (unchanged)

 OXIMETER SETTINGS:
    generation:   1 (unchanged)
    read from::   SingleNode (unchanged)

 PENDING MGS UPDATES:

    Pending MGS-managed updates (all baseboards):
    --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    sp_type   slot   part_number   serial_number   artifact_hash                                                      artifact_version   details                                                                                                                                                
    --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+   sled      0      model0        serial0         8f89bf8bc5f3271650ad72a26fc0d116c910161ca143731473a2b20fb82653cc   2.0.0              RotBootloader(PendingMgsUpdateRotBootloaderDetails { expected_stage0_version: ArtifactVersion("0.0.1"), expected_stage0_next_version: NoValidVersion })


internal DNS:
  DNS zone: "control-plane.oxide.internal" (unchanged)
    unchanged names: 39 (records: 53)

external DNS:
  DNS zone: "oxide.example" (unchanged)
    unchanged names: 5 (records: 9)




> # Update the RoT bootloader.
> sled-update-rot-bootloader serial0 --stage0 2.0.0
set sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 RoT bootloader versions: stage0 -> 2.0.0


> # If were to generate inventory and replan now, we'd want to update the RoT on
> # this sled, then its SP, then its host OS, then repeat all four for the other
> # three sleds. That's not the point of this test, so let's short-circuit that a
> # bit: we'll go ahead and change inventory to reflect all of these MGS-based
> # updates are done on all sleds.

> # Finish the MGS-based updates on sled 0.
> sled-update-rot serial0 --slot-a 2.0.0
set sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 RoT settings: slot a -> 2.0.0

> sled-update-sp serial0 --active 2.0.0
set sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 SP versions: active -> 2.0.0

> sled-update-host-phase2 serial0 --boot-disk B --slot-b 9ff631b5b7229604ab7c5aae2ee4a34a64772736b332540d38077b3aea6952df
set sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 host phase 2 details: boot_disk -> B, B -> 9ff631b5b7229604ab7c5aae2ee4a34a64772736b332540d38077b3aea6952df

> sled-update-host-phase1 serial0 --active B --slot-b 1eba0d79ea9d34558fb3f923a06614bd740649eeb0ca6e5086529dc60cd6f729
set sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 host phase 1 details: active -> B, B -> 1eba0d79ea9d34558fb3f923a06614bd740649eeb0ca6e5086529dc60cd6f729


> # All the MGS-based updates on sled 1.
> sled-update-rot-bootloader serial1 --stage0 2.0.0
set sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c RoT bootloader versions: stage0 -> 2.0.0

> sled-update-rot serial1 --slot-a 2.0.0
set sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c RoT settings: slot a -> 2.0.0

> sled-update-sp serial1 --active 2.0.0
set sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c SP versions: active -> 2.0.0

> sled-update-host-phase2 serial1 --boot-disk B --slot-b 9ff631b5b7229604ab7c5aae2ee4a34a64772736b332540d38077b3aea6952df
set sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c host phase 2 details: boot_disk -> B, B -> 9ff631b5b7229604ab7c5aae2ee4a34a64772736b332540d38077b3aea6952df

> sled-update-host-phase1 serial1 --active B --slot-b 1eba0d79ea9d34558fb3f923a06614bd740649eeb0ca6e5086529dc60cd6f729
set sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c host phase 1 details: active -> B, B -> 1eba0d79ea9d34558fb3f923a06614bd740649eeb0ca6e5086529dc60cd6f729


> # All the MGS-based updates on sled 2.
> sled-update-rot-bootloader serial2 --stage0 2.0.0
set sled d81c6a84-79b8-4958-ae41-ea46c9b19763 RoT bootloader versions: stage0 -> 2.0.0

> sled-update-rot serial2 --slot-a 2.0.0
set sled d81c6a84-79b8-4958-ae41-ea46c9b19763 RoT settings: slot a -> 2.0.0

> sled-update-sp serial2 --active 2.0.0
set sled d81c6a84-79b8-4958-ae41-ea46c9b19763 SP versions: active -> 2.0.0

> sled-update-host-phase2 serial2 --boot-disk B --slot-b 9ff631b5b7229604ab7c5aae2ee4a34a64772736b332540d38077b3aea6952df
set sled d81c6a84-79b8-4958-ae41-ea46c9b19763 host phase 2 details: boot_disk -> B, B -> 9ff631b5b7229604ab7c5aae2ee4a34a64772736b332540d38077b3aea6952df

> sled-update-host-phase1 serial2 --active B --slot-b 1eba0d79ea9d34558fb3f923a06614bd740649eeb0ca6e5086529dc60cd6f729
set sled d81c6a84-79b8-4958-ae41-ea46c9b19763 host phase 1 details: active -> B, B -> 1eba0d79ea9d34558fb3f923a06614bd740649eeb0ca6e5086529dc60cd6f729


> # All MGS-based updates complete.
> inventory-generate
generated inventory collection 39363465-89ae-4ac2-9be1-099068da9d45 from configured sleds

> blueprint-plan latest latest
INFO performed noop zone image source checks on sled, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, num_total: 7, num_already_artifact: 7, num_eligible: 0, num_ineligible: 0
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO performed noop zone image source checks on sled, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, num_total: 6, num_already_artifact: 6, num_eligible: 0, num_ineligible: 0
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO performed noop zone image source checks on sled, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, num_total: 6, num_already_artifact: 6, num_eligible: 0, num_ineligible: 0
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO MGS-driven update completed (will remove it and re-evaluate board), artifact_version: 2.0.0, artifact_hash: 8f89bf8bc5f3271650ad72a26fc0d116c910161ca143731473a2b20fb82653cc, expected_stage0_next_version: NoValidVersion, expected_stage0_version: 0.0.1, component: rot_bootloader, sp_slot: 0, sp_type: Sled, serial_number: serial0, part_number: model0
INFO skipping board for MGS-driven update, serial_number: serial0, part_number: model0
INFO skipping board for MGS-driven update, serial_number: serial1, part_number: model1
INFO skipping board for MGS-driven update, serial_number: serial2, part_number: model2
INFO ran out of boards for MGS-driven update
INFO some zones not yet up-to-date, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, zones_currently_updating: [ZoneCurrentlyUpdating { zone_id: 353b3b65-20f7-48c3-88f7-495bd5d31545 (service), zone_kind: Clickhouse, reason: ImageSourceMismatch { bp_image_source: Artifact { version: Available { version: ArtifactVersion("2.0.0") }, hash: ArtifactHash("bb2d1ff02d11f72bc9049ae57f27536207519a1859d29f8d7a90ab3b44d56b08") }, inv_image_source: InstallDataset } }, ZoneCurrentlyUpdating { zone_id: 466a9f29-62bf-4e63-924a-b9efdb86afec (service), zone_kind: Nexus, reason: ImageSourceMismatch { bp_image_source: Artifact { version: Available { version: ArtifactVersion("2.0.0") }, hash: ArtifactHash("e9b7035f41848a987a798c15ac424cc91dd662b1af0920d58d8aa1ebad7467b6") }, inv_image_source: InstallDataset } }, ZoneCurrentlyUpdating { zone_id: 62620961-fc4a-481e-968b-f5acbac0dc63 (service), zone_kind: InternalNtp, reason: ImageSourceMismatch { bp_image_source: Artifact { version: Available { version: ArtifactVersion("2.0.0") }, hash: ArtifactHash("d76e26198daed69cdae04490d7477f8c842e0dbe37d463eac0d0a8d3fb803095") }, inv_image_source: InstallDataset } }, ZoneCurrentlyUpdating { zone_id: 6c3ae381-04f7-41ea-b0ac-74db387dbc3a (service), zone_kind: ExternalDns, reason: ImageSourceMismatch { bp_image_source: Artifact { version: Available { version: ArtifactVersion("2.0.0") }, hash: ArtifactHash("f282c45771429f7bebf71f0cc668521066db57c6bb07fcfccdfb44825d3d930f") }, inv_image_source: InstallDataset } }, ZoneCurrentlyUpdating { zone_id: 99e2f30b-3174-40bf-a78a-90da8abba8ca (service), zone_kind: InternalDns, reason: ImageSourceMismatch { bp_image_source: Artifact { version: Available { version: ArtifactVersion("2.0.0") }, hash: ArtifactHash("de30657a72b066b8ef1f56351a0a5d4d7000da0a62c4be9b2e949a107ca8a389") }, inv_image_source: InstallDataset } }, ZoneCurrentlyUpdating { zone_id: ad6a3a03-8d0f-4504-99a4-cbf73d69b973 (service), zone_kind: CruciblePantry, reason: ImageSourceMismatch { bp_image_source: Artifact { version: Available { version: ArtifactVersion("2.0.0") }, hash: ArtifactHash("3ff26dad96faa8f67251f5de40458b4f809d536bfe8572134da0e42c2fa12674") }, inv_image_source: InstallDataset } }, ZoneCurrentlyUpdating { zone_id: bd354eef-d8a6-4165-9124-283fb5e46d77 (service), zone_kind: Crucible, reason: ImageSourceMismatch { bp_image_source: Artifact { version: Available { version: ArtifactVersion("2.0.0") }, hash: ArtifactHash("866f6a7c2e51c056fb722b5113e80181cc9cd8b712a0d3dbf1edc4ce29e5229e") }, inv_image_source: InstallDataset } }]
generated blueprint 61a93ea3-c872-48e0-aace-e86b0c52b839 based on parent blueprint 12d602a6-5ab4-487a-b94e-eb30cdf30300
blueprint source: planner with report:
planning report for blueprint 61a93ea3-c872-48e0-aace-e86b0c52b839:
* skipping noop zone image source check on sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c: all 7 zones are already from artifacts
* skipping noop zone image source check on sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6: all 6 zones are already from artifacts
* skipping noop zone image source check on sled d81c6a84-79b8-4958-ae41-ea46c9b19763: all 6 zones are already from artifacts
* noop converting host phase 2 slot B to Artifact on sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c
* noop converting host phase 2 slot B to Artifact on sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6
* noop converting host phase 2 slot B to Artifact on sled d81c6a84-79b8-4958-ae41-ea46c9b19763



> blueprint-diff latest
from: blueprint 12d602a6-5ab4-487a-b94e-eb30cdf30300
to:   blueprint 61a93ea3-c872-48e0-aace-e86b0c52b839

 MODIFIED SLEDS:

  sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c (active, config generation 6 -> 7):

    host phase 2 contents:
    --------------------------------
    slot   boot image source        
    --------------------------------
    A      current contents         
*   B      - current contents       
     └─    + artifact: version 2.0.0


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-72c59873-31ff-4e36-8d76-ff834009349a   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crucible                                                              8c4fa711-1d5d-4e93-85f0-d17bff47b063   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/clickhouse                                                      3b66453b-7148-4c1b-84a9-499e43290ab4   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/external_dns                                                    841d5648-05f0-47b0-b446-92f6b60fe9a6   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/internal_dns                                                    3560dd69-3b23-4c69-807d-d673104cfc68   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone                                                            4829f422-aa31-41a8-ab73-95684ff1ef48   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_clickhouse_353b3b65-20f7-48c3-88f7-495bd5d31545        318fae85-abcb-4259-b1b6-ac96d193f7b7   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_crucible_bd354eef-d8a6-4165-9124-283fb5e46d77          2ad1875a-92ac-472f-8c26-593309f0e4da   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_crucible_pantry_ad6a3a03-8d0f-4504-99a4-cbf73d69b973   c31623de-c19b-4615-9f1d-5e1daa5d3bda   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_external_dns_6c3ae381-04f7-41ea-b0ac-74db387dbc3a      b46de15d-33e7-4cd0-aa7c-e7be2a61e71b   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_internal_dns_99e2f30b-3174-40bf-a78a-90da8abba8ca      09b9cc9b-3426-470b-a7bc-538f82dede03   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_nexus_466a9f29-62bf-4e63-924a-b9efdb86afec             775f9207-c42d-4af2-9186-27ffef67735e   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/zone/oxz_ntp_62620961-fc4a-481e-968b-f5acbac0dc63               2db6b7c1-0f46-4ced-a3ad-48872793360e   in service    none      none          off        
    oxp_72c59873-31ff-4e36-8d76-ff834009349a/crypt/debug                                                           93957ca0-9ed1-4e7b-8c34-2ce07a69541c   in service    100 GiB   none          gzip-9     


    omicron zones:
    -----------------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source              disposition   underlay IP           
    -----------------------------------------------------------------------------------------------------------------------
    clickhouse        353b3b65-20f7-48c3-88f7-495bd5d31545   artifact: version 2.0.0   in service    fd00:1122:3344:102::23
    crucible          bd354eef-d8a6-4165-9124-283fb5e46d77   artifact: version 2.0.0   in service    fd00:1122:3344:102::26
    crucible_pantry   ad6a3a03-8d0f-4504-99a4-cbf73d69b973   artifact: version 2.0.0   in service    fd00:1122:3344:102::25
    external_dns      6c3ae381-04f7-41ea-b0ac-74db387dbc3a   artifact: version 2.0.0   in service    fd00:1122:3344:102::24
    internal_dns      99e2f30b-3174-40bf-a78a-90da8abba8ca   artifact: version 2.0.0   in service    fd00:1122:3344:1::1   
    internal_ntp      62620961-fc4a-481e-968b-f5acbac0dc63   artifact: version 2.0.0   in service    fd00:1122:3344:102::21
    nexus             466a9f29-62bf-4e63-924a-b9efdb86afec   artifact: version 2.0.0   in service    fd00:1122:3344:102::22


  sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 (active, config generation 7 -> 8):

    host phase 2 contents:
    --------------------------------
    slot   boot image source        
    --------------------------------
    A      current contents         
*   B      - current contents       
     └─    + artifact: version 2.0.0


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-c6d33b64-fb96-4129-bab1-7878a06a5f9b   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crucible                                                              43931274-7fe8-4077-825d-dff2bc8efa58   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/external_dns                                                    a4c3032e-21fa-4d4a-b040-a7e3c572cf3c   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/internal_dns                                                    4f60b534-eaa3-40a1-b60f-bfdf147af478   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone                                                            4617d206-4330-4dfa-b9f3-f63a3db834f9   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_crucible_5199c033-4cf9-4ab6-8ae7-566bd7606363          ad41be71-6c15-4428-b510-20ceacde4fa6   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_crucible_pantry_ba4994a8-23f9-4b1a-a84f-a08d74591389   1bca7f71-5e42-4749-91ec-fa40793a3a9a   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_external_dns_803bfb63-c246-41db-b0da-d3b87ddfc63d      3ac089c9-9dec-465b-863a-188e80d71fb4   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_internal_dns_427ec88f-f467-42fa-9bbb-66a91a36103c      686c19cf-a0d7-45f6-866f-c564612b2664   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_nexus_0c71b3b2-6ceb-4e8f-b020-b08675e83038             793ac181-1b01-403c-850d-7f5c54bda6c9   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_ntp_6444f8a5-6465-4f0b-a549-1993c113569c               cdf3684f-a6cf-4449-b9ec-e696b2c663e2   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/debug                                                           248c6c10-1ac6-45de-bb55-ede36ca56bbd   in service    100 GiB   none          gzip-9     


    omicron zones:
    -----------------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source              disposition   underlay IP           
    -----------------------------------------------------------------------------------------------------------------------
    crucible          5199c033-4cf9-4ab6-8ae7-566bd7606363   artifact: version 1.0.0   in service    fd00:1122:3344:101::25
    crucible_pantry   ba4994a8-23f9-4b1a-a84f-a08d74591389   artifact: version 1.0.0   in service    fd00:1122:3344:101::24
    external_dns      803bfb63-c246-41db-b0da-d3b87ddfc63d   artifact: version 1.0.0   in service    fd00:1122:3344:101::23
    internal_dns      427ec88f-f467-42fa-9bbb-66a91a36103c   artifact: version 1.0.0   in service    fd00:1122:3344:2::1   
    internal_ntp      6444f8a5-6465-4f0b-a549-1993c113569c   artifact: version 1.0.0   in service    fd00:1122:3344:101::21
    nexus             0c71b3b2-6ceb-4e8f-b020-b08675e83038   artifact: version 1.0.0   in service    fd00:1122:3344:101::22


  sled d81c6a84-79b8-4958-ae41-ea46c9b19763 (active, config generation 6 -> 7):

    host phase 2 contents:
    --------------------------------
    slot   boot image source        
    --------------------------------
    A      current contents         
*   B      - current contents       
     └─    + artifact: version 2.0.0


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-4930954e-9ac7-4453-b63f-5ab97c389a99   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crucible                                                              090bd88d-0a43-4040-a832-b13ae721f74f   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/external_dns                                                    4da74a5b-6911-4cca-b624-b90c65530117   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/internal_dns                                                    252ac39f-b9e2-4697-8c07-3a833115d704   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone                                                            45cd9687-20be-4247-b62a-dfdacf324929   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_f55647d4-5500-4ad3-893a-df45bd50d622          1cb0a47a-59ac-4892-8e92-cf87b4290f96   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_crucible_pantry_75b220ba-a0f4-4872-8202-dc7c87f062d0   b1deff4b-51df-4a37-9043-afbd7c70a1cb   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_external_dns_f6ec9c67-946a-4da3-98d5-581f72ce8bf0      c65a9c1c-36dc-4ddb-8aac-ec3be8dbb209   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_internal_dns_ea5b4030-b52f-44b2-8d70-45f15f987d01      21fd4f3a-ec31-469b-87b1-087c343a2422   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_nexus_3eeb8d49-eb1a-43f8-bb64-c2338421c2c6             e009d8b8-4695-4322-b53f-f03f2744aef7   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/zone/oxz_ntp_f10a4fb9-759f-4a65-b25e-5794ad2d07d8               41071985-1dfd-4ce5-8bc2-897161a8bce4   in service    none      none          off        
    oxp_4930954e-9ac7-4453-b63f-5ab97c389a99/crypt/debug                                                           7a6a2058-ea78-49de-9730-cce5e28b4cfb   in service    100 GiB   none          gzip-9     


    omicron zones:
    -----------------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source              disposition   underlay IP           
    -----------------------------------------------------------------------------------------------------------------------
    crucible          f55647d4-5500-4ad3-893a-df45bd50d622   artifact: version 2.0.0   in service    fd00:1122:3344:103::25
    crucible_pantry   75b220ba-a0f4-4872-8202-dc7c87f062d0   artifact: version 2.0.0   in service    fd00:1122:3344:103::24
    external_dns      f6ec9c67-946a-4da3-98d5-581f72ce8bf0   artifact: version 2.0.0   in service    fd00:1122:3344:103::23
    internal_dns      ea5b4030-b52f-44b2-8d70-45f15f987d01   artifact: version 2.0.0   in service    fd00:1122:3344:3::1   
    internal_ntp      f10a4fb9-759f-4a65-b25e-5794ad2d07d8   artifact: version 2.0.0   in service    fd00:1122:3344:103::21
    nexus             3eeb8d49-eb1a-43f8-bb64-c2338421c2c6   artifact: version 2.0.0   in service    fd00:1122:3344:103::22


 COCKROACHDB SETTINGS:
    state fingerprint:::::::::::::::::   (none) (unchanged)
    cluster.preserve_downgrade_option:   (do not modify) (unchanged)

 METADATA:
    internal DNS version:::   1 (unchanged)
    external DNS version:::   1 (unchanged)
    target release min gen:   4 (unchanged)
    nexus gen::::::::::::::   1 (unchanged)

 OXIMETER SETTINGS:
    generation:   1 (unchanged)
    read from::   SingleNode (unchanged)

 PENDING MGS UPDATES:

    Pending MGS-managed updates (all baseboards):
    --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    sp_type   slot   part_number   serial_number   artifact_hash                                                      artifact_version   details                                                                                                                                                
    --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-   sled      0      model0        serial0         8f89bf8bc5f3271650ad72a26fc0d116c910161ca143731473a2b20fb82653cc   2.0.0              RotBootloader(PendingMgsUpdateRotBootloaderDetails { expected_stage0_version: ArtifactVersion("0.0.1"), expected_stage0_next_version: NoValidVersion })


internal DNS:
  DNS zone: "control-plane.oxide.internal" (unchanged)
    unchanged names: 39 (records: 53)

external DNS:
  DNS zone: "oxide.example" (unchanged)
    unchanged names: 5 (records: 9)




> # Test that the add-zones-with-mupdate-override planner config works as
> # expected. We do this by:
> # * setting the mupdate override on a sled
> # * adding a new sled
> #
> # With the option disabled (the current state), the planner will
> # not proceed with adding new zones. But with the option enabled,
> # new zones will be added.
> sled-set serial0 mupdate-override c8fba912-63ae-473a-9115-0495d10fb3bc
set sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 mupdate override: unset -> c8fba912-63ae-473a-9115-0495d10fb3bc

> sled-add c3bc4c6d-fdde-4fc4-8493-89d2a1e5ee6b
added sled c3bc4c6d-fdde-4fc4-8493-89d2a1e5ee6b (serial: serial3)

> inventory-generate
generated inventory collection 04bc9001-0836-4fec-b9cb-9d4760caf8b4 from configured sleds


> # This will *not* generate the datasets and internal NTP zone on the new
> # sled.
> blueprint-plan latest latest
INFO blueprint mupdate override updated to match inventory, phase: do_plan_mupdate_override, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, new_bp_override: c8fba912-63ae-473a-9115-0495d10fb3bc, prev_bp_override: None, zones: 
  - zone 0c71b3b2-6ceb-4e8f-b020-b08675e83038 (Nexus) updated from artifact: version 1.0.0 to install dataset
  - zone 427ec88f-f467-42fa-9bbb-66a91a36103c (InternalDns) updated from artifact: version 1.0.0 to install dataset
  - zone 5199c033-4cf9-4ab6-8ae7-566bd7606363 (Crucible) updated from artifact: version 1.0.0 to install dataset
  - zone 6444f8a5-6465-4f0b-a549-1993c113569c (InternalNtp) updated from artifact: version 1.0.0 to install dataset
  - zone 803bfb63-c246-41db-b0da-d3b87ddfc63d (ExternalDns) updated from artifact: version 1.0.0 to install dataset
  - zone ba4994a8-23f9-4b1a-a84f-a08d74591389 (CruciblePantry) updated from artifact: version 1.0.0 to install dataset
, host_phase_2: 
  - host phase 2 slot A: current contents (unchanged)
  - host phase 2 slot B: updated from artifact (version version 2.0.0, hash 9ff631b5b7229604ab7c5aae2ee4a34a64772736b332540d38077b3aea6952df) to preserving current contents

INFO no previous MGS update found as part of updating blueprint mupdate override to match inventory, phase: do_plan_mupdate_override, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6
INFO updating target release minimum generation based on new set-override actions, phase: do_plan_mupdate_override, current_generation: 4, new_generation: 5
INFO performed noop zone image source checks on sled, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, num_total: 7, num_already_artifact: 7, num_eligible: 0, num_ineligible: 0
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO skipped noop image source check on sled, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, reason: remove_mupdate_override is set in the blueprint (c8fba912-63ae-473a-9115-0495d10fb3bc)
INFO performed noop zone image source checks on sled, sled_id: c3bc4c6d-fdde-4fc4-8493-89d2a1e5ee6b, num_total: 0, num_already_artifact: 0, num_eligible: 0, num_ineligible: 0
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: c3bc4c6d-fdde-4fc4-8493-89d2a1e5ee6b, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: c3bc4c6d-fdde-4fc4-8493-89d2a1e5ee6b, slot: b, expected_hash: 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
INFO performed noop zone image source checks on sled, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, num_total: 6, num_already_artifact: 6, num_eligible: 0, num_ineligible: 0
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
generated blueprint 27e755bc-dc10-4647-853c-f89bb3a15a2c based on parent blueprint 61a93ea3-c872-48e0-aace-e86b0c52b839
blueprint source: planner with report:
planning report for blueprint 27e755bc-dc10-4647-853c-f89bb3a15a2c:
* skipping noop zone image source check on sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c: all 7 zones are already from artifacts
* skipping noop zone image source check on sled c3bc4c6d-fdde-4fc4-8493-89d2a1e5ee6b: all 0 zones are already from artifacts
* skipping noop zone image source check on sled d81c6a84-79b8-4958-ae41-ea46c9b19763: all 6 zones are already from artifacts
* zone adds waiting on blockers
* zone adds and updates are blocked:
  - current target release generation (4) is lower than minimum required by blueprint (5)
  - sleds have remove mupdate override set in blueprint: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6
  - sleds have deployment units with image sources not set to Artifact:
    - sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6: 6 zones

* zone updates waiting on zone add blockers



> blueprint-diff latest
from: blueprint 61a93ea3-c872-48e0-aace-e86b0c52b839
to:   blueprint 27e755bc-dc10-4647-853c-f89bb3a15a2c

 MODIFIED SLEDS:

  sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6 (active, config generation 8 -> 9):
+   will remove mupdate override:   (none) -> c8fba912-63ae-473a-9115-0495d10fb3bc

    host phase 2 contents:
    --------------------------------
    slot   boot image source        
    --------------------------------
    A      current contents         
*   B      - artifact: version 2.0.0
     └─    + current contents       


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
    fake-vendor   fake-model   serial-c6d33b64-fb96-4129-bab1-7878a06a5f9b   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                                   dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crucible                                                              43931274-7fe8-4077-825d-dff2bc8efa58   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/external_dns                                                    a4c3032e-21fa-4d4a-b040-a7e3c572cf3c   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/internal_dns                                                    4f60b534-eaa3-40a1-b60f-bfdf147af478   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone                                                            4617d206-4330-4dfa-b9f3-f63a3db834f9   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_crucible_5199c033-4cf9-4ab6-8ae7-566bd7606363          ad41be71-6c15-4428-b510-20ceacde4fa6   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_crucible_pantry_ba4994a8-23f9-4b1a-a84f-a08d74591389   1bca7f71-5e42-4749-91ec-fa40793a3a9a   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_external_dns_803bfb63-c246-41db-b0da-d3b87ddfc63d      3ac089c9-9dec-465b-863a-188e80d71fb4   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_internal_dns_427ec88f-f467-42fa-9bbb-66a91a36103c      686c19cf-a0d7-45f6-866f-c564612b2664   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_nexus_0c71b3b2-6ceb-4e8f-b020-b08675e83038             793ac181-1b01-403c-850d-7f5c54bda6c9   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/zone/oxz_ntp_6444f8a5-6465-4f0b-a549-1993c113569c               cdf3684f-a6cf-4449-b9ec-e696b2c663e2   in service    none      none          off        
    oxp_c6d33b64-fb96-4129-bab1-7878a06a5f9b/crypt/debug                                                           248c6c10-1ac6-45de-bb55-ede36ca56bbd   in service    100 GiB   none          gzip-9     


    omicron zones:
    -------------------------------------------------------------------------------------------------------------------------
    zone type         zone id                                image source                disposition   underlay IP           
    -------------------------------------------------------------------------------------------------------------------------
*   crucible          5199c033-4cf9-4ab6-8ae7-566bd7606363   - artifact: version 1.0.0   in service    fd00:1122:3344:101::25
     └─                                                      + install dataset                                               
*   crucible_pantry   ba4994a8-23f9-4b1a-a84f-a08d74591389   - artifact: version 1.0.0   in service    fd00:1122:3344:101::24
     └─                                                      + install dataset                                               
*   external_dns      803bfb63-c246-41db-b0da-d3b87ddfc63d   - artifact: version 1.0.0   in service    fd00:1122:3344:101::23
     └─                                                      + install dataset                                               
*   internal_dns      427ec88f-f467-42fa-9bbb-66a91a36103c   - artifact: version 1.0.0   in service    fd00:1122:3344:2::1   
     └─                                                      + install dataset                                               
*   internal_ntp      6444f8a5-6465-4f0b-a549-1993c113569c   - artifact: version 1.0.0   in service    fd00:1122:3344:101::21
     └─                                                      + install dataset                                               
*   nexus             0c71b3b2-6ceb-4e8f-b020-b08675e83038   - artifact: version 1.0.0   in service    fd00:1122:3344:101::22
     └─                                                      + install dataset                                               


 ADDED SLEDS:

  sled c3bc4c6d-fdde-4fc4-8493-89d2a1e5ee6b (active, config generation 1):

    host phase 2 contents:
    ------------------------
    slot   boot image source
    ------------------------
+   A      current contents 
+   B      current contents 


 COCKROACHDB SETTINGS:
    state fingerprint:::::::::::::::::   (none) (unchanged)
    cluster.preserve_downgrade_option:   (do not modify) (unchanged)

 METADATA:
    internal DNS version:::   1 (unchanged)
    external DNS version:::   1 (unchanged)
*   target release min gen:   4 -> 5
    nexus gen::::::::::::::   1 (unchanged)

 OXIMETER SETTINGS:
    generation:   1 (unchanged)
    read from::   SingleNode (unchanged)


internal DNS:
  DNS zone: "control-plane.oxide.internal" (unchanged)
    unchanged names: 40 (records: 55)

external DNS:
  DNS zone: "oxide.example" (unchanged)
    unchanged names: 5 (records: 9)




> # This *will* generate the datasets and internal NTP zone on the new sled.
> set planner-config --add-zones-with-mupdate-override true
planner config updated:
*   add zones with mupdate override:   false -> true


> blueprint-plan latest latest
INFO performed noop zone image source checks on sled, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, num_total: 7, num_already_artifact: 7, num_eligible: 0, num_ineligible: 0
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO skipped noop image source check on sled, sled_id: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6, reason: remove_mupdate_override is set in the blueprint (c8fba912-63ae-473a-9115-0495d10fb3bc)
INFO performed noop zone image source checks on sled, sled_id: c3bc4c6d-fdde-4fc4-8493-89d2a1e5ee6b, num_total: 0, num_already_artifact: 0, num_eligible: 0, num_ineligible: 0
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: c3bc4c6d-fdde-4fc4-8493-89d2a1e5ee6b, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: c3bc4c6d-fdde-4fc4-8493-89d2a1e5ee6b, slot: b, expected_hash: 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b
INFO performed noop zone image source checks on sled, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, num_total: 6, num_already_artifact: 6, num_eligible: 0, num_ineligible: 0
INFO BootPartitionDetails inventory hash not found in TUF repo, ignoring for noop checks, sled_id: d81c6a84-79b8-4958-ae41-ea46c9b19763, slot: a, expected_hash: 0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a
INFO altered physical disks, sled_id: c3bc4c6d-fdde-4fc4-8493-89d2a1e5ee6b, sled_edits: SledEditCounts { disks: EditCounts { added: 10, updated: 0, expunged: 0, removed: 0 }, datasets: EditCounts { added: 20, updated: 0, expunged: 0, removed: 0 }, zones: EditCounts { added: 0, updated: 0, expunged: 0, removed: 0 } }
generated blueprint 9f89efdf-a23e-4137-b7cc-79f4a91cbe1f based on parent blueprint 27e755bc-dc10-4647-853c-f89bb3a15a2c
blueprint source: planner with report:
planning report for blueprint 9f89efdf-a23e-4137-b7cc-79f4a91cbe1f:
planner config:
    add zones with mupdate override:   true

* skipping noop zone image source check on sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c: all 7 zones are already from artifacts
* skipping noop zone image source check on sled c3bc4c6d-fdde-4fc4-8493-89d2a1e5ee6b: all 0 zones are already from artifacts
* skipping noop zone image source check on sled d81c6a84-79b8-4958-ae41-ea46c9b19763: all 6 zones are already from artifacts
* zone adds and updates are blocked:
  - current target release generation (4) is lower than minimum required by blueprint (5)
  - sleds have remove mupdate override set in blueprint: 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6
  - sleds have deployment units with image sources not set to Artifact:
    - sled 98e6b7c2-2efa-41ca-b20a-0a4d61102fe6: 6 zones

* adding zones despite being blocked, as specified by the `add_zones_with_mupdate_override` planner config option
* discretionary zone placement waiting for NTP zones on sleds: c3bc4c6d-fdde-4fc4-8493-89d2a1e5ee6b
* missing NTP zone on sled c3bc4c6d-fdde-4fc4-8493-89d2a1e5ee6b
* zone updates waiting on zone add blockers



> blueprint-diff latest
from: blueprint 27e755bc-dc10-4647-853c-f89bb3a15a2c
to:   blueprint 9f89efdf-a23e-4137-b7cc-79f4a91cbe1f

 MODIFIED SLEDS:

  sled c3bc4c6d-fdde-4fc4-8493-89d2a1e5ee6b (active, config generation 1 -> 2):

    host phase 2 contents:
    ------------------------
    slot   boot image source
    ------------------------
    A      current contents 
    B      current contents 


    physical disks:
    ------------------------------------------------------------------------------------
    vendor        model        serial                                        disposition
    ------------------------------------------------------------------------------------
+   fake-vendor   fake-model   serial-1a2d5932-ca5b-44b8-a0a4-31215d934293   in service 
+   fake-vendor   fake-model   serial-2454c824-3b2b-4350-a5c7-ce9b1ff5a903   in service 
+   fake-vendor   fake-model   serial-5369d002-dd19-48f2-8c08-ba063cb1e010   in service 
+   fake-vendor   fake-model   serial-5e25e3a5-d115-4df0-a54b-81f29fbb9d61   in service 
+   fake-vendor   fake-model   serial-6082ad32-e210-4786-9656-4b6bfcec5d05   in service 
+   fake-vendor   fake-model   serial-88659529-1c87-4107-8227-c9276a330bf5   in service 
+   fake-vendor   fake-model   serial-9cde7847-ff58-41af-95bf-aecebc3f1344   in service 
+   fake-vendor   fake-model   serial-9e9ca75a-6a79-4706-bcce-35714d79913c   in service 
+   fake-vendor   fake-model   serial-d8c90412-fbdb-480d-8a07-c3de73b441bc   in service 
+   fake-vendor   fake-model   serial-f3052185-bebb-4e75-842b-d8125b70bb8a   in service 


    datasets:
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    dataset name                                                                                       dataset id                             disposition   quota     reservation   compression
    -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+   oxp_1a2d5932-ca5b-44b8-a0a4-31215d934293/crypt/zone                                                902e330d-4d6e-4b2c-8e75-83abd725278e   in service    none      none          off        
+   oxp_2454c824-3b2b-4350-a5c7-ce9b1ff5a903/crypt/zone                                                b1852e8a-77a5-4069-950f-f414eb89b489   in service    none      none          off        
+   oxp_5369d002-dd19-48f2-8c08-ba063cb1e010/crypt/zone                                                76435db9-395e-4207-a1eb-80fd31462763   in service    none      none          off        
+   oxp_5e25e3a5-d115-4df0-a54b-81f29fbb9d61/crypt/zone                                                fd3b32f6-840a-4831-b27f-b65052d8c00b   in service    none      none          off        
+   oxp_6082ad32-e210-4786-9656-4b6bfcec5d05/crypt/zone                                                5cc4f3dc-459c-42fe-b7b5-493b6d72d90c   in service    none      none          off        
+   oxp_88659529-1c87-4107-8227-c9276a330bf5/crypt/zone                                                be939f45-3895-4ac2-8140-8345ba808ef0   in service    none      none          off        
+   oxp_9cde7847-ff58-41af-95bf-aecebc3f1344/crypt/zone                                                36c2157d-00f9-4934-b465-17c6dff5aa5b   in service    none      none          off        
+   oxp_9e9ca75a-6a79-4706-bcce-35714d79913c/crypt/zone                                                a777b70b-2d04-4cc1-8afc-85e46460ec1f   in service    none      none          off        
+   oxp_d8c90412-fbdb-480d-8a07-c3de73b441bc/crypt/zone                                                3f037273-07b9-4852-b364-bd885d16aee5   in service    none      none          off        
+   oxp_f3052185-bebb-4e75-842b-d8125b70bb8a/crypt/zone                                                7647e033-19a3-400c-9bcc-d19d569715c5   in service    none      none          off        
+   oxp_1a2d5932-ca5b-44b8-a0a4-31215d934293/crypt/zone/oxz_ntp_3c3c2ba0-1c7d-4005-b02c-98366435a2c1   58255ab2-30ff-448b-a049-a9ef6b0fd0c5   in service    none      none          off        
+   oxp_1a2d5932-ca5b-44b8-a0a4-31215d934293/crypt/debug                                               8d52d9dc-7e33-4a6f-9548-8a43048fb34e   in service    100 GiB   none          gzip-9     
+   oxp_2454c824-3b2b-4350-a5c7-ce9b1ff5a903/crypt/debug                                               e1a49e92-5d7a-46a4-a1ff-b53fcb7190af   in service    100 GiB   none          gzip-9     
+   oxp_5369d002-dd19-48f2-8c08-ba063cb1e010/crypt/debug                                               97723fdc-18bb-43c5-b81a-6cda8b6b5a1f   in service    100 GiB   none          gzip-9     
+   oxp_5e25e3a5-d115-4df0-a54b-81f29fbb9d61/crypt/debug                                               b6dc1ce7-759e-4c13-a05b-116007ac3be0   in service    100 GiB   none          gzip-9     
+   oxp_6082ad32-e210-4786-9656-4b6bfcec5d05/crypt/debug                                               cf9455fe-cfe0-4ae9-ac8a-31a7caf58c03   in service    100 GiB   none          gzip-9     
+   oxp_88659529-1c87-4107-8227-c9276a330bf5/crypt/debug                                               776bda33-4677-47c9-b2d7-ac4eeb0d81d3   in service    100 GiB   none          gzip-9     
+   oxp_9cde7847-ff58-41af-95bf-aecebc3f1344/crypt/debug                                               7bde4b36-0f64-4e03-9767-f0316ab60409   in service    100 GiB   none          gzip-9     
+   oxp_9e9ca75a-6a79-4706-bcce-35714d79913c/crypt/debug                                               e716eab0-d1ba-43b4-8111-94d4565e1aa9   in service    100 GiB   none          gzip-9     
+   oxp_d8c90412-fbdb-480d-8a07-c3de73b441bc/crypt/debug                                               3b33c570-ecdb-4fb4-b856-3b108bf90920   in service    100 GiB   none          gzip-9     
+   oxp_f3052185-bebb-4e75-842b-d8125b70bb8a/crypt/debug                                               e38d5c18-c24a-4b05-84e8-1726f2015746   in service    100 GiB   none          gzip-9     


    omicron zones:
    --------------------------------------------------------------------------------------------------------------------
    zone type      zone id                                image source              disposition   underlay IP           
    --------------------------------------------------------------------------------------------------------------------
+   internal_ntp   3c3c2ba0-1c7d-4005-b02c-98366435a2c1   artifact: version 2.0.0   in service    fd00:1122:3344:104::21


 COCKROACHDB SETTINGS:
    state fingerprint:::::::::::::::::   (none) (unchanged)
    cluster.preserve_downgrade_option:   (do not modify) (unchanged)

 METADATA:
    internal DNS version:::   1 (unchanged)
    external DNS version:::   1 (unchanged)
    target release min gen:   5 (unchanged)
    nexus gen::::::::::::::   1 (unchanged)

 OXIMETER SETTINGS:
    generation:   1 (unchanged)
    read from::   SingleNode (unchanged)


internal DNS:
* DNS zone: "control-plane.oxide.internal": 
+   name: 3c3c2ba0-1c7d-4005-b02c-98366435a2c1.host          (records: 1)
+       AAAA fd00:1122:3344:104::21
*   name: _internal-ntp._tcp                                 (records: 3 -> 4)
-       SRV  port   123 62620961-fc4a-481e-968b-f5acbac0dc63.host.control-plane.oxide.internal
-       SRV  port   123 6444f8a5-6465-4f0b-a549-1993c113569c.host.control-plane.oxide.internal
-       SRV  port   123 f10a4fb9-759f-4a65-b25e-5794ad2d07d8.host.control-plane.oxide.internal
+       SRV  port   123 3c3c2ba0-1c7d-4005-b02c-98366435a2c1.host.control-plane.oxide.internal
+       SRV  port   123 62620961-fc4a-481e-968b-f5acbac0dc63.host.control-plane.oxide.internal
+       SRV  port   123 6444f8a5-6465-4f0b-a549-1993c113569c.host.control-plane.oxide.internal
+       SRV  port   123 f10a4fb9-759f-4a65-b25e-5794ad2d07d8.host.control-plane.oxide.internal
    unchanged names: 39 (records: 52)

external DNS:
  DNS zone: "oxide.example" (unchanged)
    unchanged names: 5 (records: 9)




> # Set the target release minimum generation to a large value -- we're going to
> # test that the planner bails if it attempts a rollback of the target release
> # minimum generation.
> blueprint-edit latest set-target-release-min-gen 1000
blueprint 9a9e6c32-5a84-4020-a159-33dceff18d35 created from latest blueprint (9f89efdf-a23e-4137-b7cc-79f4a91cbe1f): set target release minimum generation to 1000

> sled-set serial1 mupdate-override cc724abe-80c1-47e6-9771-19e6540531a9
set sled 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c mupdate override: unset -> cc724abe-80c1-47e6-9771-19e6540531a9

> inventory-generate
generated inventory collection 08abe624-4b5f-491c-90cb-d74a84e4ba3e from configured sleds

> blueprint-plan latest latest
INFO blueprint mupdate override updated to match inventory, phase: do_plan_mupdate_override, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c, new_bp_override: cc724abe-80c1-47e6-9771-19e6540531a9, prev_bp_override: None, zones: 
  - zone 353b3b65-20f7-48c3-88f7-495bd5d31545 (Clickhouse) updated from artifact: version 2.0.0 to install dataset
  - zone 466a9f29-62bf-4e63-924a-b9efdb86afec (Nexus) updated from artifact: version 2.0.0 to install dataset
  - zone 62620961-fc4a-481e-968b-f5acbac0dc63 (InternalNtp) updated from artifact: version 2.0.0 to install dataset
  - zone 6c3ae381-04f7-41ea-b0ac-74db387dbc3a (ExternalDns) updated from artifact: version 2.0.0 to install dataset
  - zone 99e2f30b-3174-40bf-a78a-90da8abba8ca (InternalDns) updated from artifact: version 2.0.0 to install dataset
  - zone ad6a3a03-8d0f-4504-99a4-cbf73d69b973 (CruciblePantry) updated from artifact: version 2.0.0 to install dataset
  - zone bd354eef-d8a6-4165-9124-283fb5e46d77 (Crucible) updated from artifact: version 2.0.0 to install dataset
, host_phase_2: 
  - host phase 2 slot A: current contents (unchanged)
  - host phase 2 slot B: updated from artifact (version version 2.0.0, hash 9ff631b5b7229604ab7c5aae2ee4a34a64772736b332540d38077b3aea6952df) to preserving current contents

INFO no previous MGS update found as part of updating blueprint mupdate override to match inventory, phase: do_plan_mupdate_override, sled_id: 2b8f0cb3-0295-4b3c-bc58-4fe88b57112c
error: generating blueprint: target release minimum generation was set to 1000, but we tried to set it to the older generation 5, indicating a possible table rollback which should not happen

