EXECUTING COMMAND: omdb ["db", "disks", "list"]
termination: Exited(0)
---------------------------------------------
stdout:
NAME ID SIZE STATE ATTACHED_TO 
---------------------------------------------
stderr:
note: using database URL postgresql://root@[::1]:REDACTED_PORT/omicron?sslmode=disable
note: database schema version matches expected (<redacted database version>)
=============================================
EXECUTING COMMAND: omdb ["db", "dns", "show"]
termination: Exited(0)
---------------------------------------------
stdout:
GROUP    ZONE                         ver UPDATED              REASON                         
internal control-plane.oxide.internal 1   <REDACTED_TIMESTAMP> rack setup                     
external oxide-dev.test               2   <REDACTED_TIMESTAMP> create silo: "test-suite-silo" 
---------------------------------------------
stderr:
note: using database URL postgresql://root@[::1]:REDACTED_PORT/omicron?sslmode=disable
note: database schema version matches expected (<redacted database version>)
=============================================
EXECUTING COMMAND: omdb ["db", "dns", "diff", "external", "2"]
termination: Exited(0)
---------------------------------------------
stdout:
DNS zone:                   oxide-dev.test (External)
requested version:          2 (created at <REDACTED_TIMESTAMP>)
version created by Nexus:   ..........<REDACTED_UUID>...........
version created because:    create silo: "test-suite-silo"
changes:                    names added: 1, names removed: 0

+  test-suite-silo.sys                                A    127.0.0.1
---------------------------------------------
stderr:
note: using database URL postgresql://root@[::1]:REDACTED_PORT/omicron?sslmode=disable
note: database schema version matches expected (<redacted database version>)
=============================================
EXECUTING COMMAND: omdb ["db", "dns", "names", "external", "2"]
termination: Exited(0)
---------------------------------------------
stdout:
External zone: oxide-dev.test
  NAME                                               RECORDS
  test-suite-silo.sys                                A    127.0.0.1
---------------------------------------------
stderr:
note: using database URL postgresql://root@[::1]:REDACTED_PORT/omicron?sslmode=disable
note: database schema version matches expected (<redacted database version>)
=============================================
EXECUTING COMMAND: omdb ["db", "instances"]
termination: Exited(0)
---------------------------------------------
stdout:
ID NAME STATE PROPOLIS_ID SLED_ID HOST_SERIAL 
---------------------------------------------
stderr:
note: using database URL postgresql://root@[::1]:REDACTED_PORT/omicron?sslmode=disable
note: database schema version matches expected (<redacted database version>)
=============================================
EXECUTING COMMAND: omdb ["db", "reconfigurator-save", "<TMP_PATH_REDACTED>"]
termination: Exited(0)
---------------------------------------------
stdout:
---------------------------------------------
stderr:
note: using database URL postgresql://root@[::1]:REDACTED_PORT/omicron?sslmode=disable
note: database schema version matches expected (<redacted database version>)
assembling reconfigurator state ... done
wrote <TMP_PATH_REDACTED>
=============================================
EXECUTING COMMAND: omdb ["db", "sleds"]
termination: Exited(0)
---------------------------------------------
stdout:
SERIAL       IP          ROLE     ID                                   
sim-039be560 [::1]:REDACTED_PORT scrimlet ..........<REDACTED_UUID>........... 
sim-b6d65341 [::1]:REDACTED_PORT scrimlet ..........<REDACTED_UUID>........... 
---------------------------------------------
stderr:
note: using database URL postgresql://root@[::1]:REDACTED_PORT/omicron?sslmode=disable
note: database schema version matches expected (<redacted database version>)
=============================================
EXECUTING COMMAND: omdb ["mgs", "inventory"]
termination: Exited(0)
---------------------------------------------
stdout:
ALL CONFIGURED SPs

    TYPE   SLOT 
    Sled   0    
    Sled   1    
    Switch 0    
    Switch 1    

SPs FOUND THROUGH IGNITION

    TYPE   SLOT SYSTEM_TYPE 
    Sled   0    Gimlet      
    Sled   1    Gimlet      
    Switch 0    Sidecar     
    Switch 1    Sidecar     

SERVICE PROCESSOR STATES

    TYPE   SLOT MODEL            SERIAL      REV HUBRIS           PWR ROT_ACTIVE 
    Sled   0    i86pc            SimGimlet00 0   0000000000000000 A2  slot A     
    Sled   1    i86pc            SimGimlet01 0   0000000000000000 A2  slot A     
    Switch 0    FAKE_SIM_SIDECAR SimSidecar0 0   0000000000000000 A2  slot A     
    Switch 1    FAKE_SIM_SIDECAR SimSidecar1 0   0000000000000000 A2  slot A     

SP DETAILS: type "Sled" slot 0

    ROOT OF TRUST

        NAME                               VALUE  
        active slot                        slot A 
        persistent boot preference         slot A 
        pending persistent boot preference -      
        transient boot preference          -      
        slot A SHA3 256 digest             -      
        slot B SHA3 256 digest             -      

    COMPONENTS

        NAME         DESCRIPTION             DEVICE          PRESENCE SERIAL 
        sp3-host-cpu FAKE host cpu           sp3-host-cpu    Present  None   
        dev-0        FAKE temperature sensor fake-tmp-sensor Failed   None   

    CABOOSES: none found

SP DETAILS: type "Sled" slot 1

    ROOT OF TRUST

        NAME                               VALUE  
        active slot                        slot A 
        persistent boot preference         slot A 
        pending persistent boot preference -      
        transient boot preference          -      
        slot A SHA3 256 digest             -      
        slot B SHA3 256 digest             -      

    COMPONENTS

        NAME         DESCRIPTION   DEVICE       PRESENCE SERIAL 
        sp3-host-cpu FAKE host cpu sp3-host-cpu Present  None   

    CABOOSES: none found

SP DETAILS: type "Switch" slot 0

    ROOT OF TRUST

        NAME                               VALUE  
        active slot                        slot A 
        persistent boot preference         slot A 
        pending persistent boot preference -      
        transient boot preference          -      
        slot A SHA3 256 digest             -      
        slot B SHA3 256 digest             -      

    COMPONENTS

        NAME  DESCRIPTION               DEVICE          PRESENCE SERIAL 
        dev-0 FAKE temperature sensor 1 fake-tmp-sensor Present  None   
        dev-1 FAKE temperature sensor 2 fake-tmp-sensor Failed   None   

    CABOOSES: none found

SP DETAILS: type "Switch" slot 1

    ROOT OF TRUST

        NAME                               VALUE  
        active slot                        slot A 
        persistent boot preference         slot A 
        pending persistent boot preference -      
        transient boot preference          -      
        slot A SHA3 256 digest             -      
        slot B SHA3 256 digest             -      

    COMPONENTS: none found

---------------------------------------------
stderr:
note: using MGS URL http://[::1]:REDACTED_PORT/
=============================================
EXECUTING COMMAND: omdb ["nexus", "background-tasks", "doc"]
termination: Exited(0)
---------------------------------------------
stdout:
task: "bfd_manager"
    Manages bidirectional fowarding detection (BFD) configuration on rack
    switches


task: "blueprint_executor"
    Executes the target blueprint


task: "blueprint_loader"
    Loads the current target blueprint from the DB


task: "dns_config_external"
    watches external DNS data stored in CockroachDB


task: "dns_config_internal"
    watches internal DNS data stored in CockroachDB


task: "dns_propagation_external"
    propagates latest external DNS configuration (from "dns_config_external"
    background task) to the latest list of DNS servers (from
    "dns_servers_external" background task)


task: "dns_propagation_internal"
    propagates latest internal DNS configuration (from "dns_config_internal"
    background task) to the latest list of DNS servers (from
    "dns_servers_internal" background task)


task: "dns_servers_external"
    watches list of external DNS servers stored in internal DNS


task: "dns_servers_internal"
    watches list of internal DNS servers stored in internal DNS


task: "external_endpoints"
    reads config for silos and TLS certificates to determine the right set of
    HTTP endpoints, their HTTP server names, and which TLS certificates to use
    on each one


task: "inventory_collection"
    collects hardware and software inventory data from the whole system


task: "metrics_producer_gc"
    unregisters Oximeter metrics producers that have not renewed their lease


task: "nat_v4_garbage_collector"
    prunes soft-deleted IPV4 NAT entries from ipv4_nat_entry table based on a
    predetermined retention policy


task: "phantom_disks"
    detects and un-deletes phantom disks


task: "physical_disk_adoption"
    ensure new physical disks are automatically marked in-service


task: "region_replacement"
    detects if a region requires replacing and begins the process


task: "service_zone_nat_tracker"
    ensures service zone nat records are recorded in NAT RPW table


task: "switch_port_config_manager"
    manages switch port settings for rack switches


---------------------------------------------
stderr:
note: using Nexus URL http://127.0.0.1:REDACTED_PORT/
=============================================
EXECUTING COMMAND: omdb ["nexus", "background-tasks", "show"]
termination: Exited(0)
---------------------------------------------
stdout:
task: "dns_config_internal"
  configured period: every 1m
  currently executing: no
  last completed activation: <REDACTED ITERATIONS>, triggered by an explicit signal
    started at <REDACTED     TIMESTAMP> (<REDACTED DURATION>s ago) and ran for <REDACTED DURATION>ms
    last generation found: 1

task: "dns_servers_internal"
  configured period: every 1m
  currently executing: no
  last completed activation: <REDACTED ITERATIONS>, triggered by an explicit signal
    started at <REDACTED     TIMESTAMP> (<REDACTED DURATION>s ago) and ran for <REDACTED DURATION>ms
    servers found: 1

      DNS_SERVER_ADDR 
      [::1]:REDACTED_PORT     

task: "dns_propagation_internal"
  configured period: every 1m
  currently executing: no
  last completed activation: <REDACTED ITERATIONS>, triggered by a dependent task completing
    started at <REDACTED     TIMESTAMP> (<REDACTED DURATION>s ago) and ran for <REDACTED DURATION>ms
    attempt to propagate generation: 1

      DNS_SERVER_ADDR LAST_RESULT 
      [::1]:REDACTED_PORT     success     


task: "dns_config_external"
  configured period: every 1m
  currently executing: no
  last completed activation: <REDACTED ITERATIONS>, triggered by an explicit signal
    started at <REDACTED     TIMESTAMP> (<REDACTED DURATION>s ago) and ran for <REDACTED DURATION>ms
    last generation found: 2

task: "dns_servers_external"
  configured period: every 1m
  currently executing: no
  last completed activation: <REDACTED ITERATIONS>, triggered by an explicit signal
    started at <REDACTED     TIMESTAMP> (<REDACTED DURATION>s ago) and ran for <REDACTED DURATION>ms
    servers found: 1

      DNS_SERVER_ADDR 
      [::1]:REDACTED_PORT     

task: "dns_propagation_external"
  configured period: every 1m
  currently executing: no
  last completed activation: <REDACTED ITERATIONS>, triggered by a dependent task completing
    started at <REDACTED     TIMESTAMP> (<REDACTED DURATION>s ago) and ran for <REDACTED DURATION>ms
    attempt to propagate generation: 2

      DNS_SERVER_ADDR LAST_RESULT 
      [::1]:REDACTED_PORT     success     


task: "nat_v4_garbage_collector"
  configured period: every 30s
  currently executing: no
  last completed activation: <REDACTED ITERATIONS>, triggered by an explicit signal
    started at <REDACTED     TIMESTAMP> (<REDACTED DURATION>s ago) and ran for <REDACTED DURATION>ms
    last completion reported error: failed to resolve addresses for Dendrite services: no record found for Query { name: Name("_dendrite._tcp.control-plane.oxide.internal."), query_type: SRV, query_class: IN }

task: "blueprint_loader"
  configured period: every 1m 40s
  currently executing: no
  last completed activation: <REDACTED ITERATIONS>, triggered by an explicit signal
    started at <REDACTED     TIMESTAMP> (<REDACTED DURATION>s ago) and ran for <REDACTED DURATION>ms
    last completion reported error: failed to read target blueprint: Internal Error: no target blueprint set

task: "blueprint_executor"
  configured period: every 10m
  currently executing: no
  last completed activation: <REDACTED ITERATIONS>, triggered by an explicit signal
    started at <REDACTED     TIMESTAMP> (<REDACTED DURATION>s ago) and ran for <REDACTED DURATION>ms
    last completion reported error: no blueprint

task: "bfd_manager"
  configured period: every 30s
  currently executing: no
  last completed activation: <REDACTED ITERATIONS>, triggered by an explicit signal
    started at <REDACTED     TIMESTAMP> (<REDACTED DURATION>s ago) and ran for <REDACTED DURATION>ms
    last completion reported error: failed to resolve addresses for Dendrite services: no record found for Query { name: Name("_dendrite._tcp.control-plane.oxide.internal."), query_type: SRV, query_class: IN }

task: "external_endpoints"
  configured period: every 1m
  currently executing: no
  last completed activation: <REDACTED ITERATIONS>, triggered by an explicit signal
    started at <REDACTED     TIMESTAMP> (<REDACTED DURATION>s ago) and ran for <REDACTED DURATION>ms
    external API endpoints: 2 ('*' below marks default)

          SILO_ID                              DNS_NAME                           
          ..........<REDACTED_UUID>........... default-silo.sys.oxide-dev.test    
        * ..........<REDACTED_UUID>........... test-suite-silo.sys.oxide-dev.test 

    warnings: 2
        warning: silo ..........<REDACTED_UUID>........... with DNS name "default-silo.sys.oxide-dev.test" has no usable certificates
        warning: silo ..........<REDACTED_UUID>........... with DNS name "test-suite-silo.sys.oxide-dev.test" has no usable certificates

    TLS certificates: 0

task: "inventory_collection"
  configured period: every 10m
  currently executing: no
  last completed activation: <REDACTED ITERATIONS>, triggered by an explicit signal
    started at <REDACTED     TIMESTAMP> (<REDACTED DURATION>s ago) and ran for <REDACTED DURATION>ms
    last collection id:      ..........<REDACTED_UUID>...........
    last collection started: <REDACTED_TIMESTAMP>
    last collection done:    <REDACTED_TIMESTAMP>

task: "metrics_producer_gc"
  configured period: every 1m
  currently executing: no
  last completed activation: <REDACTED ITERATIONS>, triggered by an explicit signal
    started at <REDACTED     TIMESTAMP> (<REDACTED DURATION>s ago) and ran for <REDACTED DURATION>ms
    last completion reported error: metric producer gc disabled (omicron#5284)

task: "phantom_disks"
  configured period: every 30s
  currently executing: no
  last completed activation: <REDACTED ITERATIONS>, triggered by an explicit signal
    started at <REDACTED     TIMESTAMP> (<REDACTED DURATION>s ago) and ran for <REDACTED DURATION>ms
    number of phantom disks deleted: 0
    number of phantom disk delete errors: 0

task: "physical_disk_adoption"
  configured period: every 30s
  currently executing: no
  last completed activation: <REDACTED ITERATIONS>, triggered by a dependent task completing
    started at <REDACTED     TIMESTAMP> (<REDACTED DURATION>s ago) and ran for <REDACTED DURATION>ms
    last completion reported error: task disabled

task: "region_replacement"
  configured period: every 30s
  currently executing: no
  last completed activation: <REDACTED ITERATIONS>, triggered by an explicit signal
    started at <REDACTED     TIMESTAMP> (<REDACTED DURATION>s ago) and ran for <REDACTED DURATION>ms
    number of region replacements started ok: 0
    number of region replacement start errors: 0

task: "service_zone_nat_tracker"
  configured period: every 30s
  currently executing: no
  last completed activation: <REDACTED ITERATIONS>, triggered by an explicit signal
    started at <REDACTED     TIMESTAMP> (<REDACTED DURATION>s ago) and ran for <REDACTED DURATION>ms
    last completion reported error: inventory collection is None

task: "switch_port_config_manager"
  configured period: every 30s
  currently executing: no
  last completed activation: <REDACTED ITERATIONS>, triggered by an explicit signal
    started at <REDACTED     TIMESTAMP> (<REDACTED DURATION>s ago) and ran for <REDACTED DURATION>ms
warning: unknown background task: "switch_port_config_manager" (don't know how to interpret details: Object {})

---------------------------------------------
stderr:
note: using Nexus URL http://127.0.0.1:REDACTED_PORT/
=============================================
EXECUTING COMMAND: omdb ["nexus", "background-tasks", "activate", "inventory_collection"]
termination: Exited(0)
---------------------------------------------
stdout:
---------------------------------------------
stderr:
note: using Nexus URL http://127.0.0.1:REDACTED_PORT/
activated background tasks: inventory_collection
=============================================
EXECUTING COMMAND: omdb ["nexus", "blueprints", "list"]
termination: Exited(0)
---------------------------------------------
stdout:
T ENA ID                                   PARENT TIME_CREATED             
* no  ......<REDACTED_BLUEPRINT_ID>....... <none> <REDACTED     TIMESTAMP> 
---------------------------------------------
stderr:
note: using Nexus URL http://127.0.0.1:REDACTED_PORT/
=============================================
EXECUTING COMMAND: omdb ["nexus", "blueprints", "show", "......<REDACTED_BLUEPRINT_ID>......."]
termination: Exited(0)
---------------------------------------------
stdout:
blueprint  ......<REDACTED_BLUEPRINT_ID>.......
parent:    <none>

  -----------------------------------------------------------------------------------------
    zone type         zone ID                                disposition  underlay IP      
  -----------------------------------------------------------------------------------------
                                                                                           
  sled ..........<REDACTED_UUID>...........: blueprint zones at generation 2               
   (no zones)                                                                              
                                                                                           
  sled ..........<REDACTED_UUID>...........: blueprint zones at generation 2               
    clickhouse        ..........<REDACTED_UUID>...........   in service   ::1              
    cockroach_db      ..........<REDACTED_UUID>...........   in service   ::1              
    crucible_pantry   ..........<REDACTED_UUID>...........   in service   ::1              
    external_dns      ..........<REDACTED_UUID>...........   in service   ::1              
    internal_dns      ..........<REDACTED_UUID>...........   in service   ::1              
    nexus             ..........<REDACTED_UUID>...........   in service   ::ffff:127.0.0.1 

METADATA:
  created by:            nexus-test-utils        
  created at:            <REDACTED     TIMESTAMP>
  comment:               initial test blueprint  
  internal DNS version:  1                       
  external DNS version:  2                       

---------------------------------------------
stderr:
note: using Nexus URL http://127.0.0.1:REDACTED_PORT/
=============================================
EXECUTING COMMAND: omdb ["nexus", "blueprints", "show", "current-target"]
termination: Exited(0)
---------------------------------------------
stdout:
blueprint  ......<REDACTED_BLUEPRINT_ID>.......
parent:    <none>

  -----------------------------------------------------------------------------------------
    zone type         zone ID                                disposition  underlay IP      
  -----------------------------------------------------------------------------------------
                                                                                           
  sled ..........<REDACTED_UUID>...........: blueprint zones at generation 2               
   (no zones)                                                                              
                                                                                           
  sled ..........<REDACTED_UUID>...........: blueprint zones at generation 2               
    clickhouse        ..........<REDACTED_UUID>...........   in service   ::1              
    cockroach_db      ..........<REDACTED_UUID>...........   in service   ::1              
    crucible_pantry   ..........<REDACTED_UUID>...........   in service   ::1              
    external_dns      ..........<REDACTED_UUID>...........   in service   ::1              
    internal_dns      ..........<REDACTED_UUID>...........   in service   ::1              
    nexus             ..........<REDACTED_UUID>...........   in service   ::ffff:127.0.0.1 

METADATA:
  created by:            nexus-test-utils        
  created at:            <REDACTED     TIMESTAMP>
  comment:               initial test blueprint  
  internal DNS version:  1                       
  external DNS version:  2                       

---------------------------------------------
stderr:
note: using Nexus URL http://127.0.0.1:REDACTED_PORT/
=============================================
EXECUTING COMMAND: omdb ["nexus", "blueprints", "diff", "......<REDACTED_BLUEPRINT_ID>.......", "current-target"]
termination: Exited(0)
---------------------------------------------
stdout:
from: blueprint ......<REDACTED_BLUEPRINT_ID>.......
to:   blueprint ......<REDACTED_BLUEPRINT_ID>.......

  ---------------------------------------------------------------------------------------------------
     zone type         zone ID                                disposition   underlay IP       status 
  ---------------------------------------------------------------------------------------------------
                                                                                                     
  UNCHANGED SLEDS:                                                                                   
                                                                                                     
   sled ..........<REDACTED_UUID>...........: blueprint zones at generation 2                        
     clickhouse        ..........<REDACTED_UUID>...........   in service    ::1                      
     cockroach_db      ..........<REDACTED_UUID>...........   in service    ::1                      
     crucible_pantry   ..........<REDACTED_UUID>...........   in service    ::1                      
     external_dns      ..........<REDACTED_UUID>...........   in service    ::1                      
     internal_dns      ..........<REDACTED_UUID>...........   in service    ::1                      
     nexus             ..........<REDACTED_UUID>...........   in service    ::ffff:127.0.0.1         

  METADATA:
    internal DNS version:  1 (unchanged)
    external DNS version:  2 (unchanged)

---------------------------------------------
stderr:
note: using Nexus URL http://127.0.0.1:REDACTED_PORT/
=============================================
