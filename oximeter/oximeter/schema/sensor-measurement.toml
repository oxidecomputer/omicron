format_version = 1

[target]
name = "component"
description = "A component which reports sensor measurements"
authz_scope = "fleet"
versions = [
    { version = 1, fields = [
        "rack_id",
        "chassis_type",
        "serial",
        "model",
        "revision",
        "firmware_id",
        "component",
        "device",
    ]}
]

[fields.rack_id]
type = "uuid"
description = "ID of the rack on which this measurement was recorded."

[fields.model]
type = "string"
description = "Model number of the sled, switch, or power shelf"

[fields.revision]
type = "u32"
description = "Revision number of the sled, switch, or power shelf"

[fields.serial]
type = "string"
description = "Serial number of the sled, switch, or power shelf"

[fields.firmware_id]
type = "string"
description = "Hubris archive ID of the service processor when the measurement was recorded."

[fields.chassis_type]
type = "string"
description = """
What kind of thing the component resides on. This will be one of 'sled'\
for components on compute sled; 'switch', for components on rack switches; \
or 'power', for components on power shelves."""

[fields.component]
type = "string"
description = """
The service processor component ID uniquely identifying the component on
the sled, switch, or power shelf."""

[fields.device]
type = "string"
description = "The name of the device which recorded a sensor reading"

[fields.name]
type = "string"
description = "A name identifying the quantity measured by a sensor measurement"

[fields.error]
type = "string"
description = "A string identifying the type of sensor error that occurred"

[[metrics]]
name = "temperature"
description = "Temperature reading in degrees Celcius"
units = "degrees_celcius"
datum_type = "f32"
versions = [
    { added_in = 1, fields = ["name"]}
]

[[metrics]]
name = "current"
description = "Output current reading in amperes"
units = "amps"
datum_type = "f32"
versions = [
    { added_in = 1, fields = ["name"]}
]
    { added_in = 1, fields = ["measurement"]}
]

[[metrics]]
name = "voltage"
description = "Output voltage reading, in volts"
units = "volts"
datum_type = "f32"
versions = [
    { added_in = 1, fields = ["name"]}
]

[[metrics]]
name = "input_current"
description = "Input electric current reading in amperes"
units = "amps"
datum_type = "f32"
versions = [
    { added_in = 1, fields = ["name"]}
]

[[metrics]]
name = "input_voltage"
description = "Input electric voltage reading, in volts"
units = "volts"
datum_type = "f32"
versions = [
    { added_in = 1, fields = ["name"]}
]


[[metrics]]
name = "fan_speed"
description = "A fan speed measurement, in rotations per minute"
units = "rpm"
datum_type = "f32"
versions = [
    { added_in = 1, fields = ["name"]}
]

[[metrics]]
name = "sensor_error_count"
description = "Cumulative count of errors reported by a sensor"
units = "count"
datum_type = "cumulative_u64"
versions = [
    { added_in = 1, fields = ["name", "error"]}
]
