{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Plan",
  "type": "object",
  "required": [
    "dns_config",
    "services"
  ],
  "properties": {
    "dns_config": {
      "$ref": "#/definitions/DnsConfigParams"
    },
    "services": {
      "type": "object",
      "additionalProperties": {
        "$ref": "#/definitions/SledConfig"
      }
    }
  },
  "definitions": {
    "BlueprintZoneConfig": {
      "description": "Describes one Omicron-managed zone in a blueprint.\n\nPart of [`BlueprintZonesConfig`].",
      "type": "object",
      "required": [
        "disposition",
        "id",
        "zone_type"
      ],
      "properties": {
        "disposition": {
          "description": "The disposition (desired state) of this zone recorded in the blueprint.",
          "allOf": [
            {
              "$ref": "#/definitions/BlueprintZoneDisposition"
            }
          ]
        },
        "filesystem_pool": {
          "description": "zpool used for the zone's (transient) root filesystem",
          "anyOf": [
            {
              "$ref": "#/definitions/ZpoolName"
            },
            {
              "type": "null"
            }
          ]
        },
        "id": {
          "$ref": "#/definitions/TypedUuidForOmicronZoneKind"
        },
        "zone_type": {
          "$ref": "#/definitions/BlueprintZoneType"
        }
      }
    },
    "BlueprintZoneDisposition": {
      "description": "The desired state of an Omicron-managed zone in a blueprint.\n\nPart of [`BlueprintZoneConfig`].",
      "oneOf": [
        {
          "description": "The zone is in-service.",
          "type": "string",
          "enum": [
            "in_service"
          ]
        },
        {
          "description": "The zone is not in service.",
          "type": "string",
          "enum": [
            "quiesced"
          ]
        },
        {
          "description": "The zone is permanently gone.",
          "type": "string",
          "enum": [
            "expunged"
          ]
        }
      ]
    },
    "BlueprintZoneType": {
      "oneOf": [
        {
          "type": "object",
          "required": [
            "address",
            "dns_servers",
            "external_ip",
            "nic",
            "ntp_servers",
            "type"
          ],
          "properties": {
            "address": {
              "type": "string"
            },
            "dns_servers": {
              "type": "array",
              "items": {
                "type": "string",
                "format": "ip"
              }
            },
            "domain": {
              "type": [
                "string",
                "null"
              ]
            },
            "external_ip": {
              "$ref": "#/definitions/OmicronZoneExternalSnatIp"
            },
            "nic": {
              "description": "The service vNIC providing outbound connectivity using OPTE.",
              "allOf": [
                {
                  "$ref": "#/definitions/NetworkInterface"
                }
              ]
            },
            "ntp_servers": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "type": {
              "type": "string",
              "enum": [
                "boundary_ntp"
              ]
            }
          }
        },
        {
          "description": "Used in single-node clickhouse setups",
          "type": "object",
          "required": [
            "address",
            "dataset",
            "type"
          ],
          "properties": {
            "address": {
              "type": "string"
            },
            "dataset": {
              "$ref": "#/definitions/OmicronZoneDataset"
            },
            "type": {
              "type": "string",
              "enum": [
                "clickhouse"
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "address",
            "dataset",
            "type"
          ],
          "properties": {
            "address": {
              "type": "string"
            },
            "dataset": {
              "$ref": "#/definitions/OmicronZoneDataset"
            },
            "type": {
              "type": "string",
              "enum": [
                "clickhouse_keeper"
              ]
            }
          }
        },
        {
          "description": "Used in replicated clickhouse setups",
          "type": "object",
          "required": [
            "address",
            "dataset",
            "type"
          ],
          "properties": {
            "address": {
              "type": "string"
            },
            "dataset": {
              "$ref": "#/definitions/OmicronZoneDataset"
            },
            "type": {
              "type": "string",
              "enum": [
                "clickhouse_server"
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "address",
            "dataset",
            "type"
          ],
          "properties": {
            "address": {
              "type": "string"
            },
            "dataset": {
              "$ref": "#/definitions/OmicronZoneDataset"
            },
            "type": {
              "type": "string",
              "enum": [
                "cockroach_db"
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "address",
            "dataset",
            "type"
          ],
          "properties": {
            "address": {
              "type": "string"
            },
            "dataset": {
              "$ref": "#/definitions/OmicronZoneDataset"
            },
            "type": {
              "type": "string",
              "enum": [
                "crucible"
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "address",
            "type"
          ],
          "properties": {
            "address": {
              "type": "string"
            },
            "type": {
              "type": "string",
              "enum": [
                "crucible_pantry"
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "dataset",
            "dns_address",
            "http_address",
            "nic",
            "type"
          ],
          "properties": {
            "dataset": {
              "$ref": "#/definitions/OmicronZoneDataset"
            },
            "dns_address": {
              "description": "The address at which the external DNS server is reachable.",
              "allOf": [
                {
                  "$ref": "#/definitions/OmicronZoneExternalFloatingAddr"
                }
              ]
            },
            "http_address": {
              "description": "The address at which the external DNS server API is reachable.",
              "type": "string"
            },
            "nic": {
              "description": "The service vNIC providing external connectivity using OPTE.",
              "allOf": [
                {
                  "$ref": "#/definitions/NetworkInterface"
                }
              ]
            },
            "type": {
              "type": "string",
              "enum": [
                "external_dns"
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "dataset",
            "dns_address",
            "gz_address",
            "gz_address_index",
            "http_address",
            "type"
          ],
          "properties": {
            "dataset": {
              "$ref": "#/definitions/OmicronZoneDataset"
            },
            "dns_address": {
              "type": "string"
            },
            "gz_address": {
              "description": "The addresses in the global zone which should be created\n\nFor the DNS service, which exists outside the sleds's typical subnet - adding an address in the GZ is necessary to allow inter-zone traffic routing.",
              "type": "string",
              "format": "ipv6"
            },
            "gz_address_index": {
              "description": "The address is also identified with an auxiliary bit of information to ensure that the created global zone address can have a unique name.",
              "type": "integer",
              "format": "uint32",
              "minimum": 0.0
            },
            "http_address": {
              "type": "string"
            },
            "type": {
              "type": "string",
              "enum": [
                "internal_dns"
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "address",
            "type"
          ],
          "properties": {
            "address": {
              "type": "string"
            },
            "type": {
              "type": "string",
              "enum": [
                "internal_ntp"
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "external_dns_servers",
            "external_ip",
            "external_tls",
            "internal_address",
            "nic",
            "type"
          ],
          "properties": {
            "external_dns_servers": {
              "description": "External DNS servers Nexus can use to resolve external hosts.",
              "type": "array",
              "items": {
                "type": "string",
                "format": "ip"
              }
            },
            "external_ip": {
              "description": "The address at which the external nexus server is reachable.",
              "allOf": [
                {
                  "$ref": "#/definitions/OmicronZoneExternalFloatingIp"
                }
              ]
            },
            "external_tls": {
              "description": "Whether Nexus's external endpoint should use TLS",
              "type": "boolean"
            },
            "internal_address": {
              "description": "The address at which the internal nexus server is reachable.",
              "type": "string"
            },
            "nic": {
              "description": "The service vNIC providing external connectivity using OPTE.",
              "allOf": [
                {
                  "$ref": "#/definitions/NetworkInterface"
                }
              ]
            },
            "type": {
              "type": "string",
              "enum": [
                "nexus"
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "address",
            "type"
          ],
          "properties": {
            "address": {
              "type": "string"
            },
            "type": {
              "type": "string",
              "enum": [
                "oximeter"
              ]
            }
          }
        }
      ]
    },
    "ByteCount": {
      "description": "Byte count to express memory or storage capacity.",
      "type": "integer",
      "format": "uint64",
      "minimum": 0.0
    },
    "CompressionAlgorithm": {
      "oneOf": [
        {
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "on"
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "off"
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "gzip"
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "level",
            "type"
          ],
          "properties": {
            "level": {
              "$ref": "#/definitions/GzipLevel"
            },
            "type": {
              "type": "string",
              "enum": [
                "gzip_n"
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "lz4"
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "lzjb"
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "type"
          ],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "zle"
              ]
            }
          }
        }
      ]
    },
    "DatasetConfig": {
      "description": "Configuration information necessary to request a single dataset",
      "type": "object",
      "required": [
        "compression",
        "id",
        "name"
      ],
      "properties": {
        "compression": {
          "description": "The compression mode to be used by the dataset",
          "allOf": [
            {
              "$ref": "#/definitions/CompressionAlgorithm"
            }
          ]
        },
        "id": {
          "description": "The UUID of the dataset being requested",
          "allOf": [
            {
              "$ref": "#/definitions/TypedUuidForDatasetKind"
            }
          ]
        },
        "name": {
          "description": "The dataset's name",
          "allOf": [
            {
              "$ref": "#/definitions/DatasetName"
            }
          ]
        },
        "quota": {
          "description": "The upper bound on the amount of storage used by this dataset",
          "anyOf": [
            {
              "$ref": "#/definitions/ByteCount"
            },
            {
              "type": "null"
            }
          ]
        },
        "reservation": {
          "description": "The lower bound on the amount of storage usable by this dataset",
          "anyOf": [
            {
              "$ref": "#/definitions/ByteCount"
            },
            {
              "type": "null"
            }
          ]
        }
      }
    },
    "DatasetKind": {
      "description": "The kind of dataset. See the `DatasetKind` enum in omicron-common for possible values.",
      "type": "string"
    },
    "DatasetName": {
      "type": "object",
      "required": [
        "kind",
        "pool_name"
      ],
      "properties": {
        "kind": {
          "$ref": "#/definitions/DatasetKind"
        },
        "pool_name": {
          "$ref": "#/definitions/ZpoolName"
        }
      }
    },
    "DatasetsConfig": {
      "type": "object",
      "required": [
        "datasets",
        "generation"
      ],
      "properties": {
        "datasets": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/DatasetConfig"
          }
        },
        "generation": {
          "description": "generation number of this configuration\n\nThis generation number is owned by the control plane (i.e., RSS or Nexus, depending on whether RSS-to-Nexus handoff has happened).  It should not be bumped within Sled Agent.\n\nSled Agent rejects attempts to set the configuration to a generation older than the one it's currently running.\n\nNote that \"Generation::new()\", AKA, the first generation number, is reserved for \"no datasets\". This is the default configuration for a sled before any requests have been made.",
          "allOf": [
            {
              "$ref": "#/definitions/Generation"
            }
          ]
        }
      }
    },
    "DiskIdentity": {
      "description": "Uniquely identifies a disk.",
      "type": "object",
      "required": [
        "model",
        "serial",
        "vendor"
      ],
      "properties": {
        "model": {
          "type": "string"
        },
        "serial": {
          "type": "string"
        },
        "vendor": {
          "type": "string"
        }
      }
    },
    "DnsConfigParams": {
      "type": "object",
      "required": [
        "generation",
        "time_created",
        "zones"
      ],
      "properties": {
        "generation": {
          "$ref": "#/definitions/Generation"
        },
        "time_created": {
          "type": "string",
          "format": "date-time"
        },
        "zones": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/DnsConfigZone"
          }
        }
      }
    },
    "DnsConfigZone": {
      "type": "object",
      "required": [
        "records",
        "zone_name"
      ],
      "properties": {
        "records": {
          "type": "object",
          "additionalProperties": {
            "type": "array",
            "items": {
              "$ref": "#/definitions/DnsRecord"
            }
          }
        },
        "zone_name": {
          "type": "string"
        }
      }
    },
    "DnsRecord": {
      "oneOf": [
        {
          "type": "object",
          "required": [
            "data",
            "type"
          ],
          "properties": {
            "data": {
              "type": "string",
              "format": "ipv4"
            },
            "type": {
              "type": "string",
              "enum": [
                "A"
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "data",
            "type"
          ],
          "properties": {
            "data": {
              "type": "string",
              "format": "ipv6"
            },
            "type": {
              "type": "string",
              "enum": [
                "AAAA"
              ]
            }
          }
        },
        {
          "type": "object",
          "required": [
            "data",
            "type"
          ],
          "properties": {
            "data": {
              "$ref": "#/definitions/Srv"
            },
            "type": {
              "type": "string",
              "enum": [
                "SRV"
              ]
            }
          }
        }
      ]
    },
    "Generation": {
      "description": "Generation numbers stored in the database, used for optimistic concurrency control",
      "type": "integer",
      "format": "uint64",
      "minimum": 0.0
    },
    "GzipLevel": {
      "type": "integer",
      "format": "uint8",
      "minimum": 0.0
    },
    "IpNet": {
      "oneOf": [
        {
          "title": "v4",
          "allOf": [
            {
              "$ref": "#/definitions/Ipv4Net"
            }
          ]
        },
        {
          "title": "v6",
          "allOf": [
            {
              "$ref": "#/definitions/Ipv6Net"
            }
          ]
        }
      ],
      "x-rust-type": {
        "crate": "oxnet",
        "path": "oxnet::IpNet",
        "version": "0.1.0"
      }
    },
    "Ipv4Net": {
      "title": "An IPv4 subnet",
      "description": "An IPv4 subnet, including prefix and prefix length",
      "examples": [
        "192.168.1.0/24"
      ],
      "type": "string",
      "pattern": "^(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])/([0-9]|1[0-9]|2[0-9]|3[0-2])$",
      "x-rust-type": {
        "crate": "oxnet",
        "path": "oxnet::Ipv4Net",
        "version": "0.1.0"
      }
    },
    "Ipv6Net": {
      "title": "An IPv6 subnet",
      "description": "An IPv6 subnet, including prefix and subnet mask",
      "examples": [
        "fd12:3456::/64"
      ],
      "type": "string",
      "pattern": "^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\\/([0-9]|[1-9][0-9]|1[0-1][0-9]|12[0-8])$",
      "x-rust-type": {
        "crate": "oxnet",
        "path": "oxnet::Ipv6Net",
        "version": "0.1.0"
      }
    },
    "MacAddr": {
      "title": "A MAC address",
      "description": "A Media Access Control address, in EUI-48 format",
      "examples": [
        "ff:ff:ff:ff:ff:ff"
      ],
      "type": "string",
      "maxLength": 17,
      "minLength": 5,
      "pattern": "^([0-9a-fA-F]{0,2}:){5}[0-9a-fA-F]{0,2}$"
    },
    "Name": {
      "title": "A name unique within the parent collection",
      "description": "Names must begin with a lower case ASCII letter, be composed exclusively of lowercase ASCII, uppercase ASCII, numbers, and '-', and may not end with a '-'. Names cannot be a UUID, but they may contain a UUID. They can be at most 63 characters long.",
      "type": "string",
      "maxLength": 63,
      "minLength": 1,
      "pattern": "^(?![0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$)^[a-z]([a-zA-Z0-9-]*[a-zA-Z0-9]+)?$"
    },
    "NetworkInterface": {
      "description": "Information required to construct a virtual network interface",
      "type": "object",
      "required": [
        "id",
        "ip",
        "kind",
        "mac",
        "name",
        "primary",
        "slot",
        "subnet",
        "vni"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "ip": {
          "type": "string",
          "format": "ip"
        },
        "kind": {
          "$ref": "#/definitions/NetworkInterfaceKind"
        },
        "mac": {
          "$ref": "#/definitions/MacAddr"
        },
        "name": {
          "$ref": "#/definitions/Name"
        },
        "primary": {
          "type": "boolean"
        },
        "slot": {
          "type": "integer",
          "format": "uint8",
          "minimum": 0.0
        },
        "subnet": {
          "$ref": "#/definitions/IpNet"
        },
        "transit_ips": {
          "default": [],
          "type": "array",
          "items": {
            "$ref": "#/definitions/IpNet"
          }
        },
        "vni": {
          "$ref": "#/definitions/Vni"
        }
      }
    },
    "NetworkInterfaceKind": {
      "description": "The type of network interface",
      "oneOf": [
        {
          "description": "A vNIC attached to a guest instance",
          "type": "object",
          "required": [
            "id",
            "type"
          ],
          "properties": {
            "id": {
              "type": "string",
              "format": "uuid"
            },
            "type": {
              "type": "string",
              "enum": [
                "instance"
              ]
            }
          }
        },
        {
          "description": "A vNIC associated with an internal service",
          "type": "object",
          "required": [
            "id",
            "type"
          ],
          "properties": {
            "id": {
              "type": "string",
              "format": "uuid"
            },
            "type": {
              "type": "string",
              "enum": [
                "service"
              ]
            }
          }
        },
        {
          "description": "A vNIC associated with a probe",
          "type": "object",
          "required": [
            "id",
            "type"
          ],
          "properties": {
            "id": {
              "type": "string",
              "format": "uuid"
            },
            "type": {
              "type": "string",
              "enum": [
                "probe"
              ]
            }
          }
        }
      ]
    },
    "OmicronPhysicalDiskConfig": {
      "type": "object",
      "required": [
        "id",
        "identity",
        "pool_id"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "identity": {
          "$ref": "#/definitions/DiskIdentity"
        },
        "pool_id": {
          "$ref": "#/definitions/TypedUuidForZpoolKind"
        }
      }
    },
    "OmicronPhysicalDisksConfig": {
      "type": "object",
      "required": [
        "disks",
        "generation"
      ],
      "properties": {
        "disks": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/OmicronPhysicalDiskConfig"
          }
        },
        "generation": {
          "description": "generation number of this configuration\n\nThis generation number is owned by the control plane (i.e., RSS or Nexus, depending on whether RSS-to-Nexus handoff has happened).  It should not be bumped within Sled Agent.\n\nSled Agent rejects attempts to set the configuration to a generation older than the one it's currently running.",
          "allOf": [
            {
              "$ref": "#/definitions/Generation"
            }
          ]
        }
      }
    },
    "OmicronZoneDataset": {
      "description": "Describes a persistent ZFS dataset associated with an Omicron zone",
      "type": "object",
      "required": [
        "pool_name"
      ],
      "properties": {
        "pool_name": {
          "$ref": "#/definitions/ZpoolName"
        }
      }
    },
    "OmicronZoneExternalFloatingAddr": {
      "description": "Floating external address with port allocated to an Omicron-managed zone.",
      "type": "object",
      "required": [
        "addr",
        "id"
      ],
      "properties": {
        "addr": {
          "type": "string"
        },
        "id": {
          "$ref": "#/definitions/TypedUuidForExternalIpKind"
        }
      }
    },
    "OmicronZoneExternalFloatingIp": {
      "description": "Floating external IP allocated to an Omicron-managed zone.\n\nThis is a slimmer `nexus_db_model::ExternalIp` that only stores the fields necessary for blueprint planning, and requires that the zone have a single IP.",
      "type": "object",
      "required": [
        "id",
        "ip"
      ],
      "properties": {
        "id": {
          "$ref": "#/definitions/TypedUuidForExternalIpKind"
        },
        "ip": {
          "type": "string",
          "format": "ip"
        }
      }
    },
    "OmicronZoneExternalSnatIp": {
      "description": "SNAT (outbound) external IP allocated to an Omicron-managed zone.\n\nThis is a slimmer `nexus_db_model::ExternalIp` that only stores the fields necessary for blueprint planning, and requires that the zone have a single IP.",
      "type": "object",
      "required": [
        "id",
        "snat_cfg"
      ],
      "properties": {
        "id": {
          "$ref": "#/definitions/TypedUuidForExternalIpKind"
        },
        "snat_cfg": {
          "$ref": "#/definitions/SourceNatConfig"
        }
      }
    },
    "SledConfig": {
      "type": "object",
      "required": [
        "datasets",
        "disks",
        "zones"
      ],
      "properties": {
        "datasets": {
          "description": "Datasets configured for this sled",
          "allOf": [
            {
              "$ref": "#/definitions/DatasetsConfig"
            }
          ]
        },
        "disks": {
          "description": "Control plane disks configured for this sled",
          "allOf": [
            {
              "$ref": "#/definitions/OmicronPhysicalDisksConfig"
            }
          ]
        },
        "zones": {
          "description": "zones configured for this sled",
          "type": "array",
          "items": {
            "$ref": "#/definitions/BlueprintZoneConfig"
          }
        }
      }
    },
    "SourceNatConfig": {
      "description": "An IP address and port range used for source NAT, i.e., making outbound network connections from guests or services.",
      "type": "object",
      "required": [
        "first_port",
        "ip",
        "last_port"
      ],
      "properties": {
        "first_port": {
          "description": "The first port used for source NAT, inclusive.",
          "type": "integer",
          "format": "uint16",
          "minimum": 0.0
        },
        "ip": {
          "description": "The external address provided to the instance or service.",
          "type": "string",
          "format": "ip"
        },
        "last_port": {
          "description": "The last port used for source NAT, also inclusive.",
          "type": "integer",
          "format": "uint16",
          "minimum": 0.0
        }
      }
    },
    "Srv": {
      "type": "object",
      "required": [
        "port",
        "prio",
        "target",
        "weight"
      ],
      "properties": {
        "port": {
          "type": "integer",
          "format": "uint16",
          "minimum": 0.0
        },
        "prio": {
          "type": "integer",
          "format": "uint16",
          "minimum": 0.0
        },
        "target": {
          "type": "string"
        },
        "weight": {
          "type": "integer",
          "format": "uint16",
          "minimum": 0.0
        }
      }
    },
    "TypedUuidForDatasetKind": {
      "type": "string",
      "format": "uuid"
    },
    "TypedUuidForExternalIpKind": {
      "type": "string",
      "format": "uuid"
    },
    "TypedUuidForOmicronZoneKind": {
      "type": "string",
      "format": "uuid"
    },
    "TypedUuidForZpoolKind": {
      "type": "string",
      "format": "uuid"
    },
    "Vni": {
      "description": "A Geneve Virtual Network Identifier",
      "type": "integer",
      "format": "uint32",
      "minimum": 0.0
    },
    "ZpoolName": {
      "title": "The name of a Zpool",
      "description": "Zpool names are of the format ox{i,p}_<UUID>. They are either Internal or External, and should be unique",
      "type": "string",
      "pattern": "^ox[ip]_[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$"
    }
  }
}